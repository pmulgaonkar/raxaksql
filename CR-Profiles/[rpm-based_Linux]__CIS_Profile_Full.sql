select add_profile_data ('[rpm-based Linux] CIS Profile (Full)' ,'Profile Customized by CloudRaxak' ,'Linux-based OS','' ,'2019-02-11' ,'Profile by Cloud Raxak') from dual;

--1.1.1.1
select add_rule_data ('default','C-30101','SV-3001r1_rule','default','high', 'Ensure mounting of cramfs filesystems is disabled', 'The cramfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems. A cramfs image can be used without having to first decompress the image. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.1 - Red Hat Enterprise. 1.1.1.1 - CentOS', 'F-30101', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: install cramfs /bin/true. Run the following command to unload the cramfs module: # rmmod cramfs', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30101', 'Run the following commands and verify the output is as indicated: cmd# modprobe -n -v cramfs output# install /bin/true', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.2
select add_rule_data ('default','C-30102','SV-3002r1_rule','default','high', 'Ensure mounting of freevxfs filesystems is disabled', 'The freevxfs filesystem type is a free version of the Veritas type filesystem. This is the primary filesystem type for HP-UX operating systems. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.2 - Red Hat Enterprise. 1.1.1.2 - CentOS', 'F-30102', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: install freevxfs /bin/true. Run the following command to unload the freevxfs module: cmd# rmmod freevxfs', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30102', 'Run the following commands and verify the output is as indicated: cmd# modprobe -n -v freevxfs cmd# install /bin/true output# lsmod | grep', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.3
select add_rule_data ('default','C-30103','SV-3003r1_rule','default','high', 'Ensure mounting of jffs2 filesystems is disabled', 'The jffs2 (journaling flash filesystem 2) filesystem type is a log-structured filesystem used in flash memory devices. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.3 - Red Hat Enterprise. 1.1.1.3 - CentOS', 'F-30103', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: cmd# install jffs2 /bin/true. Run the following command to unload the jffs2 module: cmd# rmmod jffs2', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30103', 'Run the following commands and verify the output is as indicated: # modprobe -n -v jffs2 output# install /bin/true cmd# lsmod | grep jffs2 <No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.4
select add_rule_data ('default','C-30104','SV-3004r1_rule','default','high', 'Ensure mounting of hfs filesystems is disabled', 'The hfs filesystem type is a hierarchical filesystem that allows you to mount Mac OS filesystems. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.4 - Red Hat Enterprise. 1.1.1.4 - CentOS', 'F-30104', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: cmd# install hfs /bin/true. Run the following command to unload the hfs module: cmd# rmmod hfs', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30104', 'Run the following commands and verify the output is as indicated: cmd# modprobe -n -v hfs output# install /bin/true cmd# lsmod | grep hfs output# <No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.5
select add_rule_data ('default','C-30105','SV-3005r1_rule','default','high', 'Ensure mounting of hfsplus filesystems is disabled', 'The hfsplus filesystem type is a hierarchical filesystem designed to replace hfs that allows you to mount Mac OS filesystems. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.5 - Red Hat Enterprise. 1.1.1.5 - CentOS', 'F-30105', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: install hfsplus /bin/true Run the following command to unload the hfsplus module: # rmmod hfsplus', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30105', 'Run the following commands and verify the output is as indicated: # modprobe -n -v hfsplus output# install /bin/true cmd# lsmod | grep hfsplus output#<No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.6
select add_rule_data ('default','C-30106','SV-3006r1_rule','default','high', 'Ensure mounting of squashfs filesystems is disabled', 'The squashfs filesystem type is a compressed read-only Linux filesystem embedded in small footprint systems (similar to cramfs ). A squashfs image can be used without having to first decompress the image. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.6 - Red Hat Enterprise. 1.1.1.6 - CentOS', 'F-30106', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: install squashfs /bin/true. Run the following command to unload the squashfs module: output# rmmod squashfs', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30106', 'Run the following commands and verify the output is as indicated: cmd# modprobe -n -v squashfs output#install /bin/true cmd# lsmod | grep squashfs output#<No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.7
select add_rule_data ('default','C-30107','SV-3007r1_rule','default','high', 'Ensure mounting of udf filesystems is disabled', 'The udf filesystem type is the universal disk format used to implement ISO/IEC 13346 and ECMA-167 specifications. This is an open vendor filesystem type for data storage on a broad range of media. This filesystem type is necessary to support writing DVDs and newer optical disc formats. Removing support for unneeded filesystem types reduces the local attack surface of the system. If this filesystem type is not needed, disable it Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.7 - Red Hat Enterprise. 1.1.1.7 - CentOS', 'F-30107', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line: install udf /bin/true Run the following command to unload the udf module: cmd# rmmod udf', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30107', 'Run the following commands and verify the output is as indicated: cmd# modprobe -n -v udf output# install /bin/true. cmd# lsmod | grep udf output# <No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.1.8
select add_rule_data ('default','C-30108','SV-3007r1_rule','default','high', 'Ensure mounting of FAT filesystems is disabled', 
'The FAT filesystem format is primarily used on older windows systems and portable USB drives or flash modules. 
It comes in three types FAT12 , FAT16 , and FAT32 all of which are supported by the vfat kernel module. 
Removing support for unneeded filesystem types reduces the local attack surface of the system. 
If this filesystem type is not needed, disable it.
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.1.8 - Red Hat Enterprise. 1.1.1.8 - CentOS',
'F-30108', 'Edit or create the file /etc/modprobe.d/CIS.conf and add the following line:
install vfat /bin/true
Run the following command to unload the vfat module:
# rmmod vfat', 
'[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent',
'CHK-30108', 'Run the following commands and verify the output is as indicated:
# modprobe -n -v vfat
install /bin/true
# lsmod | grep vfat
<No output>', 'Customized rule by Cloud Raxak') from dual;

--1.1.2
select add_rule_data ('default','V-38455','SV-50255r1_rule','default','low','The system must use a separate file system for /tmp.','The "/tmp" partition is used as temporary storage by many programs. Placing "/tmp" in its own partition enables the setting of more restrictive mount options, which can help protect programs which use it. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.2 - Red Hat Enterprise. 1.1.2 - CentOS', 'F-43387r1_fix','The tmp partition is used as temporary storage by many programs. Placing /tmp in its own partition enables the setting of more restrictive mount options, which can help to protect the programs that use it. Please create a separate file system for /tmp.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000001','C-45997r1_chk','Run the following command to determine if "/tmp" is on its own partition or logical volume: $ mount | grep "on /tmp "If "/tmp" has its own partition or volume group, a line will be returned. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.3
select add_rule_data ('default','V-56011','SV-50462r1_rule','default','high','For the /tmp partition, "nodev" option must be set.','This rule verifies that for /tmp partition, "nodev" option is set. "nodev" verify that the file system do not interpret character or block special devices. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.3 - Red Hat Enterprise. 1.1.3 - CentOS','F-55014','Add the "nodev" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /tmp.If there is no /tmp entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "nodev" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check /tmp partitions mounted on system do not interpret character or block special devices on the file system: grep tmp /etc/mtab /etc/fstab | grep "nodev"If "nodev" option not set this is finding.','Customized rule by Cloud Raxak') from dual;

--1.1.4
select add_rule_data ('default','V-56009','SV-50462r1_rule','default','high','For the /tmp partition, "nosuid" option must be set.','This rule verifies that for /tmp partition, "nosuid" option is set. "nosuid" verify that set-user-identifier or set-group-identifier bits do not take effect. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.4 - Red Hat Enterprise. 1.1.4 - CentOS', 'F-55014','Add the "nosuid" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /tmp.If there is no /tmp entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "nosuid" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check whether /tmp partitions mounted on system do not allow set-user-identifier or set-group-identifier bits to take effect: grep -w tmp /etc/mtab /etc/fstab | grep "nosuid"If "nosuid" option not set this is finding.','Customized rule by Cloud Raxak') from dual;

--1.1.5
select add_rule_data ('default','V-57569','SV-71919r1_rule','default','medium','The noexec option must be added to the /tmp partition.','Allowing users to execute binaries from world-writable directories such as "/tmp" should never be necessary in normal operation and can expose the system to potential compromise. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.5 - Red Hat Enterprise. 1.1.5 - CentOS', 'F-62639r1_fix','Add the "noexec" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /tmp.If there is no /tmp entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "noexec" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000528','C-58279r1_chk','To verify that binaries cannot be directly executed from /tmp partition, run the following command:grep -w "/tmp" /etc/mtab /etc/fstab | grep -v "^"The output should show "noexec" in use.If it does not, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--1.1.6
select add_rule_data ('default','V-38456','SV-50256r1_rule','default','low','The system must use a separate file system for /var.','Ensuring that "/var" is mounted on its own partition enables the setting of more restrictive mount options. This helps protect system services such as daemons or other programs which use it. It is not uncommon for the "/var" directory to contain world-writable directories, installed by other software packages. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.6 - Red Hat Enterprise. 1.1.6 - CentOS', 'F-43401r2_fix','Ensuring that /var is mounted on its own partition enables the setting of more restrictive mount options. This helps protect system services such as daemons or other programs which use it. It is not uncommon for the /var directory to contain world-writable directories, installed by other software packages. Please create a separate file system for /var.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000002','C-46011r2_chk','Run the following command to determine if "/var" is on its own partition or logical volume: $ mount | grep "on /var "If "/var" has its own partition or volume group, a line will be returned. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.7
select add_rule_data ('default','C-is117','sv-1.1.7_cis_rule','default','high','Ensure separate partition exists for /var/tmp','The /var/tmp directory is a world-writable directory used for temporary storage by all users and some applications.Since the /var/tmp directory is intended to be world-writable, there is a risk of resource exhaustion if it is not bound to a separate partition. In addition, making /var/tmp its own file system allows an administrator to set the noexec option on the mount, making /var/tmp useless for an attacker to install executable code. It would also prevent an attacker from establishing a hardlink to a system setuid program and wait for it to be updated. Once the program was updated, the hardlink would be broken and the attacker would have his own copy of the program. If the program happened to have a security vulnerability, the attacker could continue to exploit the known flaw. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.7 - Red Hat Enterprise. 1.1.7 - CentOS', 'F-cis-1.1.7_fix','For new installations, during installation create a custom partition setup and specify a separate partition for /var/tmp. For systems that were previously installed, create a new partition and configure /etc/fstab as appropriate.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.1.7','CIS-1.1.7_chk','Run the following command and verify output shows /var/tmp is mounted:# mount | grep /var/tmp tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)','Customized rule by Cloud Raxak') from dual;

--1.1.8
select add_rule_data ('default','C-30002','SV-3008r1_rule','default','high', 'Ensure nodev option set on /var/tmp partition', 'The nodev mount option specifies that the filesystem cannot contain special devices. Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/tmp. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.8 - Red Hat Enterprise. 1.1.8 - CentOS', 'F-30002', 'Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,nodev /var/tmp', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30002', 'If a /var/tmp partition exists run the following command and verify that the nodev option is set on /var/tmp. cmd# mount | grep /var/tmp output# tmpfs on /var/tmp type tmpfs - rw,nosuid,nodev,noexec,relatime', 'Customized rule by Cloud Raxak') from dual;

--1.1.9
select add_rule_data ('default','C-30003','SV-3009r1_rule','default','high', 'Ensure nosuid option set on /var/tmp partition', 'The nosuid mount option specifies that the filesystem cannot contain setuid files. Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot create setuid files in /var/tmp. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.9 - Red Hat Enterprise. 1.1.9 - CentOS', 'F-30003', 'Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : # mount -o remount,nosuid /var/tmp', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30003', 'If a /var/tmp partition exists run the following command and verify that the nosuid option is set on /var/tmp. cmd# mount | grep /var/tmp output# tmpfs on /var/tmp type tmpfs - rw,nosuid,nodev,noexec,relatime', 'Customized rule by Cloud Raxak') from dual;

--1.1.10
select add_rule_data ('default','C-30004','SV-3010r1_rule','default','high', 'Ensure noexec option set on /var/tmp partition', 'The noexec mount option specifies that the filesystem cannot contain executable binaries. Since the /var/tmp filesystem is only intended for temporary file storage, set this option to ensure that users cannot run executable binaries from /var/tmp. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.10 - Red Hat Enterprise. 1.1.10 - CentOS', 'F-30004', 'Edit the /etc/fstab file and add noexec to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp : cmd# mount -o remount,noexec /var/tmp', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30004', 'If a /var/tmp partition exists run the following command and verify that the noexec option is set on /var/tmp . cmd# mount | grep /var/tmp output# tmpfs on /var/tmp type tmpfs - rw,nosuid,nodev,noexec,relatime', 'Customized rule by Cloud Raxak') from dual;

--1.1.11
select add_rule_data ('default','V-38463','SV-50263r1_rule','default','low','The system must use a separate file system for /var/log.','Placing "/var/log" in its own partition enables better separation between log files and other files in "/var/". Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.11 - Red Hat Enterprise. 1.1.11 - CentOS', 'F-43408r1_fix','Placing /var/log in its own partition enables better separation between log files and other files in /var/log. Please create a separate file system for /var/log.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000003','C-46018r1_chk','Run the following command to determine if "/var/log" is on its own partition or logical volume: $ mount | grep "on /var/log "If "/var/log" has its own partition or volume group, a line will be returned. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.12
select add_rule_data ('default','V-38467','SV-50267r1_rule','default','low','The system must use a separate file system for the system audit data path.','Placing "/var/log/audit" in its own partition enables better separation between audit files and other files, and helps ensure that auditing cannot be halted due to the partition running out of space. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.12 - Red Hat Enterprise. 1.1.12 - CentOS', 'F-43412r1_fix','Placing "/var/log/audit" in its own partition enables better separation between audit files and other files, it helps to ensure that auditing cannot be halted due to the partition running out of space. Please create a separate file system for /var/log/audit.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000004','C-46022r1_chk','Run the following command to determine if "/var/log/audit" is on its own partition or logical volume: $ mount | grep "on /var/log/audit "If "/var/log/audit" has its own partition or volume group, a line will be returned. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.13
select add_rule_data ('default','V-38473','SV-50273r1_rule','default','low','The system must use a separate file system for user home directories.','Ensuring that "/home" is mounted on its own partition enables the setting of more restrictive mount options, and also helps ensure that users cannot trivially fill partitions used for log or audit data storage. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.13 - Red Hat Enterprise. 1.1.13 - CentOS', 'F-43418r1_fix','Ensuring that "/home" mounted on its own partition enables the setting of more restrictive mount options and also helps to ensure that users cannot trivially fill partitions used for log or audit data storage. Please create a separate file system for "/home" directories.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000007','C-46028r1_chk','Run the following command to determine if "/home" is on its own partition or logical volume: $ mount | grep "on /home "If "/home" has its own partition or volume group, a line will be returned. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.14
select add_rule_data ('default','V-56023','SV-50462r1_rule','default','high','For the /home partition, "nodev" option must be set.','The nodev mount option specifies that the filesystem cannot contain special devices: This is a security precaution. You don"t want a user world-accessible filesystem like this to have the potential for the creation of character devices or access to random device hardware. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.14 - Red Hat Enterprise. 1.1.14 - CentOS', 'F-55014','Add the "nodev" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /home.If there is no /home entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "nodev" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To verify that the file system do not interpret character or block special devices , run the following command:grep -w "/home" /etc/fstab | grep -v "^"The output should show "nodev" in use.If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.15
select add_rule_data ('default','V-56024','SV-50462r1_rule','default','high','For the /dev/shm partition, "nodev" option must be set.','shm / shmfs is also known as tmpfs, which is a common name for a temporary file storage facility on many Unix-like operating systems. It is intended to appear as a mounted file system, but one which uses virtual memory instead of a persistent storage device. The nodev mount option specifies that the filesystem cannot contain special devices: This is a security precaution. You don"t want a user world-accessible filesystem like this to have the potential for the creation of character devices or access to random device hardware. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.15 - Red Hat Enterprise. 1.1.15 - CentOS', 'F-55014','Add the "nodev" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /dev/shm.If there is no /dev/shm entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "nodev" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To verify that the file system do not interpret character or block special devices , run the following command:grep -w "/dev/shm" /etc/fstab | grep -v "^"The output should show "nodev" in use.If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.16
select add_rule_data ('default','V-56021','SV-50462r1_rule','default','high','For the /dev/shm partition, "nosuid" option must be set.','shm / shmfs is also known as tmpfs, which is a common name for a temporary file storage facility on many Unix-like operating systems. It is intended to appear as a mounted file system, but one which uses virtual memory instead of a persistent storage device. The nosuid mount option specifies that the filesystem cannot contain set userid files. Preventing setuid binaries on a world-writable filesystem makes sense because there"s a risk of root escalation or other awfulness there. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.16 - Red Hat Enterprise. 1.1.16 - CentOS', 'F-55014','Add the "nosuid" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /dev/shm.If there is no /dev/shm entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "nosuid" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To verify that set-user-identifier or set-group-identifier bits do not take effect , run the following command:grep -w "/dev/shm" /etc/fstab | grep -v "^"The output should show "nosuid" in use.If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.17
select add_rule_data ('default','V-56022','SV-50462r1_rule','default','high','For the /dev/shm partition, "noexec" option must be set.','shm / shmfs is also known as tmpfs, which is a common name for a temporary file storage facility on many Unix-like operating systems. It is intended to appear as a mounted file system, but one which uses virtual memory instead of a persistent storage device. Hackers can use temporary storage directories to store and execute unwanted programs and hack into a server, having "noexec" option set can avoid this from happening. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.17 - Red Hat Enterprise. 1.1.17 - CentOS', 'F-55014','Add the "noexec" option to the mount option column of "/etc/fstab" for the line which controls mounting of partitions on /dev/shm.If there is no /dev/shm entry in /etc/fstab, then copy the entry from /etc/mtab paste in /etc/fstab and then add "noexec" option in the mount option column of the entry.[]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To verify that binaries cannot be directly executed from /dev/shm partition, run the following command:grep -w "/dev/shm" /etc/fstab | grep -v "^"The output should show "noexec" in use.If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.18
select add_rule_data ('default','C-is1118','sv-1.1.1.8_cis_rule','default','medium', 'Ensure nodev option set on removable media partitions.', 'The nodev mount option specifies that the filesystem cannot contain special devices. Since the /var/tmp filesystem is not intended to support devices, set this option to ensure that users cannot attempt to create block or character special devices in /var/tmp. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.18 - Red Hat Enterprise. 1.1.18 - CentOS', 'F-cis-1.1.1.8_fix','Edit the /etc/fstab file and add nodev to the fourth field (mounting options) for the /var/tmp partition. See the fstab(5) manual page for more information. Run the following command to remount /var/tmp: # mount -o remount,nodev /var/tmp','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.1.1.8','CIS-1.1.1.8_chk','If a /var/tmp partition exists run the following command and verify that the nodev option is set on /var/tmp. # mount | grep /var/tmp tmpfs on /var/tmp type tmpfs (rw,nosuid,nodev,noexec,relatime)', 'Customized rule by Cloud Raxak') from dual;

--1.1.19
select add_rule_data ('default','C-is1119','sv-1.1.19_cis_rule','default','medium','Ensure nosuid option set on removable media partitions','The nosuid mount option specifies that the filesystem cannot contain setuid files.Setting this option on a file system prevents users from introducing privileged programs onto the system and allowing non-root users to execute them. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.19 - Red Hat Enterprise. 1.1.19 - CentOS', 'F-cis-1.1.19_fix','Edit the /etc/fstab file and add nosuid to the fourth field (mounting options) of all removable media partitions. Look for entries that have mount points that contain words such as floppy or cdrom. See the fstab(5) manual page for more information.','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.1.19','CIS-1.1.19_chk','Run the following command and verify that the nosuid option is set on all removable media partitions. # mount' ,'Customized rule by Cloud Raxak') from dual;

--1.1.20
select add_rule_data ('default','V-38655','SV-50456r1_rule','default','low','The noexec option must be added to removable media partitions.','Allowing users to execute binaries from removable media such as USB keys exposes the system to potential compromise. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.20 - Red Hat Enterprise. 1.1.20 - CentOS', 'F-43605r1_fix','The "noexec" mount option prevents the direct execution of binaries on the mounted filesystem. Users should not be allowed to execute binaries that exist on partitions mounted from removable media (such as a USB key). The "noexec" option prevents code from being executed directly from the media itself, and may therefore provide a line of defense against certain types of worms or malicious code. Add the "noexec" option to the fourth column of "/etc/fstab" for the line which controls mounting of any removable media partitions.[]" and then run mount [devicename] to effect the changes.]   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000271','C-46216r1_chk','To verify that binaries cannot be directly executed from removable media, run the following command: []Check whether device with ID_BUS as usb is mounted in /etc/mtab:$ grep -w device_name /etc/mtab | grep -v "^"The output should show "noexec" in use. If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.21
select add_rule_data ('default','V-38697','SV-50498r2_rule','default','low','The sticky bit must be set on all public directories.','Failing to set the sticky bit on public directories allows unauthorized users to delete files in the directory structure. The only authorized public directories are those temporary directories supplied with the system, or those designed to be temporary file repositories. The setting is normally reserved for directories used by the system, and by users for temporary file storage - such as /tmp - and for directories requiring global read/write access. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.21 - Red Hat Enterprise. 1.1.21 - CentOS', 'F-43646r1_fix','When the so-called "sticky bit" is set on a directory, only the owner of a given file may remove that file from the directory. Without the sticky bit, any user with write access to a directory may remove any file in the directory. Setting the sticky bit prevents users from removing each other"s files. In cases where there is no reason for a directory to be world-writable, a better solution is to remove that permission rather than to set the sticky bit. However, if a directory is used by a particular application, consult that application"s documentation instead of blindly changing modes. To set the sticky bit on a world-writable directory [], run the following command:  chmod +t [DIR]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000336','C-46259r4_chk','To find world-writable directories that lack the sticky bit, run the following command for each local partition []:  find / -xdev -type d \( -perm -0002 -a ! -perm -1000 \)If any world-writable directories are missing the sticky bit, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.1.22
select add_rule_data ('default','V-38437','SV-50237r1_rule','default','low','Automated file system mounting tools must not be enabled unless needed.','All filesystems that are required for the successful operation of the system should be explicitly listed in "/etc/fstab" by an administrator. New filesystems should not be arbitrarily introduced via the automounter.The "autofs" daemon mounts and unmounts filesystems, such as user home directories shared via NFS, on demand. In addition, autofs can be used to handle removable media, and the default configuration provides the cdrom device as "/misc/cd". However, this method of providing access to removable media is not common, so autofs can almost always be disabled if NFS is not in use. Even if NFS is required, it is almost always possible to configure filesystem mounts statically by editing "/etc/fstab" rather than relying on the automounter.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.1.22 - Red Hat Enterprise. 1.1.22 - CentOS', 'F-43381r1_fix','If the "autofs" service is not needed to dynamically mount NFS filesystems or removable media, disable the service for all runlevels:  chkconfig --level 0123456 autofs offStop the service if it is already running:  service autofs stop' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000526','C-45991r1_chk','To verify the "autofs" service is not running: service autofs statusTo verify the "autofs" service is disabled at system boot configuration, run the following command:  chkconfig --list autofsIf properly configured, the output should be the following: autofs 0:off 1:off 2:off 3:off 4:off 5:off 6:offIf the autofs service is enabled or running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.2 Configure Software Updates
--1.2.1
select add_rule_data ('default','C-30005','SV-3011r1_rule','default','high', 'Ensure package manager repositories are configured', 'Systems need to have package manager repositories configured to ensure they receive the latest patches and updates. If a systems package repositories are misconfigured important patches may not be identified or a rogue repository could introduce compromised software. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.2.1 - Red Hat Enterprise. 1.2.1 - CentOS', 'F-30005', 'Configure your package manager repositories according to site policy.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30005', 'Run the following command and verify repositories are configured correctly: cmd# yum repolist', 'Customized rule by Cloud Raxak') from dual;

--1.2.2
select add_rule_data ('default','V-38476','SV-50276r3_rule','default','high','Vendor-provided cryptographic certificates must be installed to verify the integrity of system software.','The Red Hat GPG keys are necessary to cryptographically verify packages are from Red Hat.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.2.2 - Red Hat Enterprise. 1.2.2 - CentOS', 'F-43421r3_fix','To ensure the system can cryptographically verify base software packages come from Red Hat (and to connect to the Red Hat Network to receive them), the Red Hat GPG keys must be installed properly. To install the Red Hat GPG keys, run: rpm --import /etc/pki/rpm-gpg/*' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000008','C-46031r3_chk','To ensure that the GPG keys are installed, run:$ rpm -q gpg-pubkeyThe command should return the strings below:gpg-pubkey-fd431d51-4ae0493bgpg-pubkey-2fa658e0-45700c69If the Red Hat GPG Keys are not installed, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.2.3
select add_rule_data ('default','V-38483','SV-50283r1_rule','default','medium','The system package management tool must cryptographically verify the authenticity of system software packages during installation.','Ensuring the validity of packages" cryptographic signatures prior to installation ensures the provenance of the software and protects against malicious tampering. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.2.3 - Red Hat Enterprise. 1.2.3 - CentOS', 'F-43429r1_fix','Pass the --allow-unauthenticated option to apt-get as in: $ sudo apt-get --allow-unauthenticated upgradeFrom the manual page of apt-get:--allow-unauthenticatedIgnore if packages can"t be authenticated and don"t prompt about it. This is useful for tools like pbuilder. Configuration Item: APT::Get::AllowUnauthenticated.You can make this setting permanent by using your own config file at /etc/apt/apt.conf.d/ directory. The filename can be 99myown and it may contain this line:APT::Get::AllowUnauthenticated "true";' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000013','C-46039r1_chk','Ensuring all packages" cryptographic signatures are valid prior to installation ensures the provenance of the software and protects against malicious tampering: $ grep -rwi AllowUnauthenticated /etc/apt/* | grep -v ":\s*" ','Customized rule by Cloud Raxak') from dual;

--1.2.4
--select add_rule_data ('default','C-30012','SV-3012r1_rule','default','high', 'Ensure Red Hat Subscription Manager connection is configured', 'Systems need to be registered with the Red Hat Subscription Manager (RHSM) to receive patch updates. This is usually configured during initial installation. It is important to register with the Red Hat Subscription Manager to make sure that patches are updated on a regular basis. This helps to reduce the exposure time as new vulnerabilities are discovered. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.2.4 - Red Hat Enterprise. 1.2.4 - CentOS', 'F-30012', 'Run the following command to connect to the Red Hat Subscription Manager: # subscription-manager register', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30012', 'Verify your system is connected to the Red Hat Subscription Manager. If connected to RHSM your systemID can be retrieved with the following command: # subscription-manager identity', 'Customized rule by Cloud Raxak') from dual;

--1.2.5
select add_rule_data ('default','V-38478','SV-50278r2_rule','default','low','The Red Hat Network Service (rhnsd) service must not be running, unless using RHN or an RHN Satellite.','Although systems management and patching is extremely important to system security, management by a system outside the enterprise enclave is not desirable for some environments. However, if the system is being managed by RHN or RHN Satellite Server the "rhnsd" daemon can remain on. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.2.5 - Red Hat Enterprise.', 'F-43423r2_fix','The Red Hat Network service automatically queries Red Hat Network servers to determine whether there are any actions that should be executed, such as package updates. This only occurs if the system was registered to an RHN server or satellite and managed as such. The "rhnsd" service can be disabled with the following commands:  chkconfig --level 0123456 rhnsd off service rhnsd stop' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000009','C-46033r2_chk','Run the following command to verify "rhnsd" is disabled through current runtime configuration:  service rhnsd statusIf the service is disabled the command will return the following output: rhnsd is stoppedTo check that the "rhnsd" service is disabled in system boot configuration, run the following command:  chkconfig  --list rhnsdOutput should indicate the "rhnsd" service has either not been installed, or has been disabled at all runlevels, as shown in the example below:  chkconfig --list rhnsd"rhnsd" 0:off 1:off 2:off 3:off 4:off 5:off 6:offIf the system uses RHN or an RHN Satellite, this is not applicable.If the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.3.1
select add_rule_data ('default','V-38489','SV-50290r1_rule','default','medium','A file integrity tool aide must be installed.','The AIDE package must be installed if it is to be available for integrity checking. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.3.1 - Red Hat Enterprise. 1.3.1 - CentOS', 'F-43436r1_fix','Install the AIDE package with the command:  yum install aide' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000016','C-46046r1_chk','Run the following command to determine if the "aide" package is installed:  rpm -q aideIf the package is not installed, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.3.2
select add_rule_data ('default','V-38696','SV-50497r2_rule','default','medium','The operating system must employ automated mechanisms, per organization defined frequency, to detect the addition of unauthorized components/devices into the operating system.','By default, AIDE does not install itself for periodic execution. Periodically running AIDE may reveal unexpected changes in installed files. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.3.2 - Red Hat Enterprise. 1.3.2 - CentOS', 'F-43645r1_fix','AIDE should be executed on a periodic basis to check for changes. To implement a daily execution of AIDE at 4:05am using cron, add the following line to /etc/crontab: 05 4 * * * root /usr/sbin/aide --checkAIDE can be executed periodically through other means; this is merely one example.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000303','C-46258r2_chk','To determine that periodic AIDE execution has been scheduled, run the following command:  grep aide /etc/crontab /etc/cron.*/*If there is no output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.4 Secure Boot Settings
--1.4.1
select add_rule_data ('default','V-38583','SV-50384r2_rule','default','medium','The system boot loader configuration file(s) must have mode 0600 or less permissive.','Proper permissions ensure that only the root user can modify important boot parameters. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.4.1 - Red Hat Enterprise. 1.4.1 - CentOS', 'F-43531r2_fix','File permissions for "/boot/grub/grub.cfg" should be set to 600, which is the default. To properly set the permissions of "/boot/grub/grub.cfg", run the command: chmod 600 /boot/grub/grub.cfgBoot partitions based on VFAT, NTFS, or other non-standard configurations may require alternative measures.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000067','C-46141r2_chk','To check the permissions of /boot/grub/grub.cfg, run the command:$ ls -lL /boot/grub/grub.cfgIf properly configured, the output should indicate the following permissions: "-rw-------"If it does not, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--1.4.2
select add_rule_data ('default','V-38585','SV-50386r2_rule','default','medium','The system boot loader must require authentication.','Password protection on the boot loader configuration ensures users with physical access cannot trivially alter important bootloader settings. These include which kernel to use, and whether to enter single-user mode. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.4.2 - Red Hat Enterprise. 1.4.2 - CentOS', 'F-43533r1_fix','Create an encrypted password with grub-md5-crypt:Create an encrypted password with grub-md5-crypt:Add this script to header file or any custom file under "/etc/grub.d" directory.cat <EOFset superusers="< username >" password_pbkdf2 < username > < encrypted-password >EOFUpdate the grub file. update-grubAdd the ???unrestricted option to CLASS in /etc/grub.d/10_linux file.  This will unrestrict the users from boot the system.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000068','C-46143r2_chk','To verify the boot loader password has been set and encrypted, run the following commands: grep "set\s*superusers="  /boot/grub/grub/cfg  | grep -v "^"The output should show the following :set superusers= < username > grep "password_pbkdf2\s*+ superuser_name +\s*grub.pbkdf2.sha512"  /boot/grub/grub.cfg | grep -v "^"The output should show the following :password_pbkdf2 < username > grub.pbkdf2.sha512 < hash password >Checking the unrestricted authentication of boot loader. grep -w menuentry /etc/grub.d/10_linux | grep "$os" The output should show the following :echo "menuentry "$(echo "$os" | grub_quote)" ${CLASS} --unrestricted \$menuentry_id_option.If above configuration is missing, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.4.3
select add_rule_data ('default','V-38586','SV-50387r1_rule','default','medium','The system must require authentication upon booting into single-user and maintenance modes.','This prevents attackers with physical access from trivially bypassing security on the machine and gaining root access. Such accesses are further prevented by configuring the bootloader password. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.4.3 - Red Hat Enterprise. 1.4.3 - CentOS', 'F-43534r1_fix','Single-user mode is intended as a system recovery method, providing a single user root access to the system by providing a boot option at startup. By default, no authentication is performed if single-user mode is selected. To require entry of the root password even if the system is started in single-user mode, add or correct the following line in the file "/etc/init/rcS.conf": console ownerexec /sbin/suloginRemove the disable single-user mode authentication parameters "init=/bin/bash", "init=/bin/sh" from grub files if it exists.And update the grub update-grub' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000069','C-46145r1_chk','To verify the single-user mode authentication is disabled, check "init=/bin/bash", "init=/bin/sh" parameters existancy inkernel parameter line in grub file.If any one of parameter is existed in grub file this is finding.Run the following to determine if a password is set for the root user.  grep "^root:\s*[]\s*:\|^root:\s*:" /etc/shadowIf it retruns any output this is finding and need to set the password for root account manually.To check if authentication is required for single-user mode, run the following command: $ grep -w console /etc/init/rcS.conf | grep -v ""$ grep -w /sbin/sulogin  /etc/init/rcS.conf | grep -v ""The output should be the following: console ownerexec /sbin/suloginIf the output is different, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.5 Additional Process Hardening
--1.5.1
select add_rule_data ('default','V-38675','SV-50476r2_rule','default','low','Process core dumps must be disabled unless needed.','A core dump includes a memory image taken at the time the operating system terminates an application. The memory image could contain sensitive data and is generally useful only for developers trying to debug problems. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.5.1 - Red Hat Enterprise. 1.5.1 - CentOS', 'F-43624r1_fix','To disable core dumps for all users, add the following line to "/etc/security/limits.conf": * hard core 0' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000308','C-46235r2_chk','To verify that core dumps are disabled for all users, run the following command: grep -w core /etc/security/limits.conf /etc/security/limits.d/*.conf --no-messages | grep -v ":\s*"The output should be:* hard core 0If it is not, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--1.5.2
select add_rule_data ('default','C-30006','SV-3013r1_rule','default','high', 'Ensure XD/NX support is enabled', 'Recent processors in the x86 family support the ability to prevent code execution on a per memory page basis. Generically and on AMD processors, this ability is called No Execute (NX), while on Intel processors it is called Execute Disable (XD). This ability can help prevent exploitation of buffer overflow vulnerabilities and should be activated whenever possible. Extra steps must be taken to ensure that this protection is enabled, particularly on 32-bit x86 systems. Other processors, such as Itanium and POWER, have included such support since inception and the standard kernel for those platforms supports the feature. Enabling any feature that can protect against buffer overflow attacks enhances the security of the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.5.2 - Red Hat Enterprise. 1.5.2 - CentOS', 'F-30006', 'On 32 bit systems install a kernel with PAE support, no installation is required on 64 bit systems: If necessary configure your bootloader to load the new kernel and reboot the system. You may need to enable NX or XD support in your bios.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30006', 'Run the following command and verify your kernel has identified and activated NX/XD protection. cmd# dmesg | grep NX output# NX (Execute Disable) protection: active', 'Customized rule by Cloud Raxak') from dual;

--1.5.3
select add_rule_data ('default','V-38596','SV-50397r2_rule','default','medium','The system must implement virtual address space randomization.','Address space layout randomization (ASLR) makes it more difficult for an attacker to predict the location of attack code he or she has introduced into a process"s address space during an attempt at exploitation. Additionally, ASLR also makes it more difficult for an attacker to know the location of existing code in order to repurpose it using return oriented programming (ROP) techniques. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.5.3 - Red Hat Enterprise. 1.5.3 - CentOS', 'F-43543r1_fix','To set the runtime status of the "kernel.randomize_va_space" kernel parameter, run the following command:  sysctl -w kernel.randomize_va_space=2To make this configuration persistent, add the following line to "/etc/sysctl.conf": kernel.randomize_va_space = 2and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000078','C-46153r2_chk','Check if the system is configured to implement virtual address space randomization, by querying the following command: sysctl kernel.randomize_va_spaceIf the output of the command is not "2", this is a finding.verify the value of kernel.randomize_va_space  in "/etc/sysctl.conf".If kernel.randomize_va_space is not set to "2" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.5.4
select add_rule_data ('default','C-30007','SV-3014r1_rule','default','high', 'Ensure prelink is disabled', 'prelinkis a program that modifies ELF shared libraries and ELF dynamically linked binaries in such a way that the time needed for the dynamic linker to perform relocations at startup significantly decreases. The prelinking feature can interfere with the operation of AIDE, because it changes binaries. Prelinking can also increase the vulnerability of the system if a malicious user is able to compromise a common library such as libc. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.5.4 - Red Hat Enterprise. 1.5.4 - CentOS', 'F-30007', 'Run the following commands to restore binaries to normal and uninstall prelink : cmd# prelink -ua cmd# yum remove prelink', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30007', 'Run the following command and verify prelink is not installed: cmd# rpm -q prelink output# package prelink is not installed', 'Customized rule by Cloud Raxak') from dual;

--1.6 Mandatory Access Control
--1.6.1 Configure SELinux
--1.6.1.1
select add_rule_data ('default','V-51337','SV-65547r1_rule','default','medium','The system must use a Linux Security Module at boot time.','Disabling a major host protection feature, such as SELinux, at boot time prevents it from confining system services at boot time. Further, it increases the chances that it will remain off during system operation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.1 - Red Hat Enterprise. 1.6.1.1 - CentOS', 'F-56147r1_fix','Set SELINUX=enforcing in /etc/selinux/config file. And SELinux can be disabled at boot time by an argument in grub file. Remove any instances of "selinux=0" from the kernel arguments in that file to prevent SELinux from being disabled at boot.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000017','C-54007r1_chk','Check the "/etc/selinux/config"  file  is selinux is disabled. grep -w SELINUX /etc/selinux/config | grep -v "^"If the line exists like SELINUX=disabled this is finding.Inspect grub file  for any instances of "selinux=0" in the kernel boot arguments. Presence of "selinux=0" indicates that SELinux is disabled at boot time. If SELinux isdisabled at boot time, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.6.1.2
select add_rule_data ('default','V-51363','SV-65573r1_rule','default','medium','The system must use a Linux Security Module configured to enforce limits on system services.','Setting the SELinux state to enforcing ensures SELinux is able to confine potentially compromised processes to the security policy, which is designed to prevent them from causing damage to the system or further elevating their privileges.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.2 - Red Hat Enterprise. 1.6.1.2 - CentOS', 'F-56165r1_fix','The SELinux state should be set to "enforcing" at system boot time. In the file "/etc/selinux/config", add or correct the following line to configure the system to boot into enforcing mode:SELINUX=enforcing' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000020','C-53703r1_chk','Check the file "/etc/selinux/config" and ensure the following line appears:SELINUX=enforcing grep -w SELINUX=enforcing /etc/selinux/config | grep -v "^"If SELINUX is not set to enforcing, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--1.6.1.3
select add_rule_data ('default','V-51369','SV-65579r1_rule','default','low','The system must use a Linux Security Module configured to limit the privileges of system services.','"Setting the SELinux policy to ""targeted"" or a more specialized policy ensures the system will confine processes that are likely to be targeted for exploitation; such as network or system services. " Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.3 - Red Hat Enterprise. 1.6.1.3 - CentOS', 'F-56171r1_fix','"The SELinux ""targeted"" policy is appropriate for general-purpose desktops and servers; as well as systems in many other roles. To configure the system to use this policy; add or correct the following line in ""/etc/selinux/config"":SELINUXTYPE=targetedOther policies; such as ""mls""; provide additional security labeling and greater confinement but are not compatible with many general-purpose use cases."','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000023','None','None','Customized rule by Cloud Raxak') from dual;

--1.6.1.4
select add_rule_data ('default','V-56017','SV-50462r1_rule','default','high','The SETroubleshoot package must not be installed on the system.','Setroubleshoot explains in plain English why a script or an application was blocked from executing. The tool also gives you suggestions on how to resolve the issue, which may involve running a simple command. This can be a problem if an attacker tries to execute something and it failed due to some security. This package might just help the attacker, how to bypass the security wall. This rule verifies that setroubleshoot is not installed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.4 - Red Hat Enterprise. 1.6.1.4 - CentOS', 'F-56017','If installed on the system, remove this package by running: yum remove setroubleshoot-server setroubleshoot' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether setroubleshoot package is installed: rpm -q setroubleshoot rpm -q setroubleshoot-serverIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.6.1.5
select add_rule_data ('default','V-56033','SV-50462r1_rule','default','high','The MCS Translation Service (mcstrans) must not be installed on system.','MCS Translation Service translates output of Linux errors or configuration warnings or messages into a readable format. This rule verifies that mcstrans is not installed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.5 - Red Hat Enterprise. 1.6.1.5 - CentOS', 'F-56033','If installed on system, remove the mcstrans package by running: yum remove mctrans' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether mcstrans is installed on system: rpm -q mcstransIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--1.6.1.6
select add_rule_data ('default','C-is1616','sv-1.6.1.6_cis_rule','default','high','Ensure no unconfined daemons exist ','Daemons that are not defined in SELinux policy will inherit the security context of their parent process.Since daemons are launched and descend from the init process, they will inherit the security context label initrc_t. This could cause the unintended consequence of giving the process more permission than it requires. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.1.6 - Red Hat Enterprise. 1.6.1.6 - CentOS', 'F-cis-1.6.1.6_fix','Investigate any unconfined daemons found during the audit action. They may need to have an existing security context assigned to them or a policy built for them.','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.6.1.6','CIS-1.6.1.6_chk', 'Run the following command and verify not output is produced: # ps -eZ | egrep "initrc" | egrep -vw "tr|ps|egrep|bash|awk" | tr ":" " " | awk "{ print $NF }"' ,'Customized rule by Cloud Raxak') from dual;

--1.6.2
select add_rule_data ('default','C-is162','sv-1.6.2_cis_rule','default','medium','Ensure SELinux is installed','SELinux provides Mandatory Access Controls.Without a Mandatory Access Control system installed only the default Discretionary Access Control system will be available. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.6.2 - Red Hat Enterprise. 1.6.2 - CentOS', 'F-cis-1.6.2_fix','Run the following command to install libselinux: # yum install libselinux','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.6.2','CIS-1.6.2_chk', 'Run the following command and verify libselinux is installed: # rpm -q libselinux libselinux-<version>' ,'Customized rule by Cloud Raxak') from dual;

--1.7 Warning Banners
--1.7.1 Command Line Warning Banners
--1.7.1.1
select add_rule_data ('default','C-30008','SV-3015r1_rule','default','high', 'Ensure message of the day is configured properly', 'The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users. Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version. Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.1 - Red Hat Enterprise. 1.7.1.1 - CentOS', 'F-30008', 'Edit the /etc/motd file with the appropriate contents according to your site policy, remove any instances of \m , \r , \s , or \v.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30008', 'Run the following command and verify that the contents match site policy: cmd# cat /etc/motd. Run the following command and verify no results are returned: # egrep (\\v|\\r|\\m|\\s) /etc/motd', 'Customized rule by Cloud Raxak') from dual;

--1.7.1.2
select add_rule_data ('default','V-38593','SV-50394r1_rule','default','medium','The Department of Defense (DoD) login banner must be displayed immediately prior to, or as part of, console login prompts.','An appropriate warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.2 Need to cross check - Red Hat Enterprise. 1.7.1.2 Need to cross check - CentOS', 'F-43540r1_fix','To configure the system login banner: Edit "/etc/issue". Replace the default text with a message compliant with the local site policy or a legal disclaimer. The DoD required text is either: "You are accessing a U.S. Government (USG) Information System (IS) that is provided for USG-authorized use only. By using this IS (which includes any device attached to this IS), you consent to the following conditions: -The USG routinely intercepts and monitors communications on this IS for purposes including, but not limited to, penetration testing, COMSEC monitoring, network operations and defense, personnel misconduct (PM), law enforcement (LE), and counterintelligence (CI) investigations. -At any time, the USG may inspect and seize data stored on this IS. -Communications using, or data stored on, this IS are not private, are subject to routine monitoring, interception, and search, and may be disclosed or used for any USG-authorized purpose. -This IS includes security measures (e.g., authentication and access controls) to protect USG interests -- not for your personal benefit or privacy. -Notwithstanding the above, using this IS does not constitute consent to PM, LE or CI investigative searching or monitoring of the content of privileged communications, or work product, related to personal representation or services by attorneys, psychotherapists, or clergy, and their assistants. Such communications and work product are private and confidential. See User Agreement for details." OR: "I"ve read AND consent to terms in IS user agreem"t."Add the line "Banner /etc/issue" in /etc/ssh/sshd_config.Restart ssh service to get changes in effect:$ service ssh restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000073','C-46150r1_chk','To check if the system login banner is compliant, run the following command: $ cat /etc/issueIf it does not display the required banner, this is a findingTo check the parameter "Banner /etc/issue" in /etc/ssh/sshd_config.$ grep -wi Banner /etc/ssh/sshd_config | grep -v "^"If the parameter "Banner /etc/issue" not found in /etc/ssh/sshd_config this is finding.','Customized rule by Cloud Raxak') from dual;

--1.7.1.3
select add_rule_data ('default','C-30009','SV-3016r1_rule','default','high', 'Ensure remote login warning banner is configured properly', 'The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services. Unix-based systems have typically displayed information about the OS release and patch level upon logging in to the system. This information can be useful to developers who are developing software for a particular OS platform. If mingetty(8) supports the following options, they display operating system information: \m - machine architecture \r - operating system release \s - operating system name \v - operating system version. Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Displaying OS and patch level information in login banners also has the side effect of providing detailed system information to attackers attempting to target specific exploits of a system. Authorized users can easily get this information by running the " uname -a " command once they have logged in. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.3 - Red Hat Enterprise. 1.7.1.3 - CentOS', 'F-30009', 'Edit the /etc/issue.net file with the appropriate contents according to your site policy, remove any instances of \m , \r , \s , or \v : # echo "Authorized uses only. All activity may be monitored and reported." > /etc/issue.net', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30009', 'Run the following command and verify that the contents match site policy: # cat /etc/issue.net. Run the following command and verify no results are returned: # egrep (\\v|\\r|\\m|\\s) /etc/issue.net', 'Customized rule by Cloud Raxak') from dual;

--1.7.1.4
select add_rule_data ('default','C-is1714','sv-1.7.1.4_cis_rule','default','medium','Ensure permissions on /etc/motd are configured','The contents of the /etc/motd file are displayed to users after login and function as a message of the day for authenticated users.If the /etc/motd file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.4 - Red Hat Enterprise. 1.7.1.4 - CentOS', 'F-cis-1.7.1.4_fix','Run the following commands to set permissions on /etc/motd: # chown root:root /etc/motd # chmod 644 /etc/motd','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.7.1.4','CIS-1.7.1.4_chk', 'Run the following command and verify Uid and Gid are both 0/root and Access is 644: # stat /etc/motd Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)' ,'Customized rule by Cloud Raxak') from dual;

--1.7.1.5
select add_rule_data ('default','C-is1715','sv-1.7.1.5_cis_rule','default','high','Ensure permissions on /etc/issue are configured','The contents of the /etc/issue file are displayed to users prior to login for local terminals.If the /etc/issue file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.5 - Red Hat Enterprise. 1.7.1.5 - CentOS', 'F-cis-1.7.1.5_fix','Run the following commands to set permissions on /etc/issue: # chown root:root /etc/issue # chmod 644 /etc/issue','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.7.1.5','CIS-1.7.1.5_chk', 'Run the following command and verify Uid and Gid are both 0/root and Access is 644: # stat /etc/issue Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)' ,'Customized rule by Cloud Raxak') from dual;

--1.7.1.6
select add_rule_data ('default','C-is1716','sv-1.7.1.6_cis_rule','default','medium','Ensure permissions on /etc/issue.net are configured','The contents of the /etc/issue.net file are displayed to users prior to login for remote connections from configured services.If the /etc/issue.net file does not have the correct ownership it could be modified by unauthorized users with incorrect or misleading information. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.1.6 - Red Hat Enterprise. 1.7.1.6 - CentOS', 'F-cis-1.7.1.6_fix','Run the following commands to set permissions on /etc/issue.net: # chown root:root /etc/issue.net # chmod 644 /etc/issue.net','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-1.7.1.6','CIS-1.7.1.6_chk','Run the following command and verify Uid and Gid are both 0/root and Access is 644: # stat /etc/issue.net Access: (0644/-rw-r--r--) Uid: ( 0/ root) Gid: ( 0/ root)' ,'Customized rule by Cloud Raxak') from dual;

--1.7.2
--select add_rule_data ('default','C-30017','SV-3017r1_rule','default','high', 'Ensure GDM login banner is configured', 'GDM is the GNOME Display Manager which handles graphical login for GNOME based systems. Warning messages inform users who are attempting to login to the system of their legal status regarding the system and must include the name of the organization that owns the system and any monitoring policies that are in place. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.7.2 Need to cross check - Red Hat Enterprise. 1.7.2 Need to cross check - CentOS', 'F-30017', 'Create the /etc/dconf/profile/gdm file with the following contents: user-db:user system-db:gdm file-db:/usr/share/gdm/greeter-dconf-defaults. Create or edit the banner-message-enable and banner-message-text options in /etc/dconf/db/gdm.d/01-banner-message: [org/gnome/login-screen] banner-message-enable=true banner-message-text="Authorized uses only. All activity may be monitored and reported." Run the following command to update the system databases: cmd# dconf update', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30017', 'If GDM is installed on the system verify that /etc/dconf/profile/gdm exists and contains the following: user-db:user system-db:gdm file-db:/usr/share/gdm/greeter-dconf-defaults Then verify the banner-message-enable and banner-message-text options are configured in one of the files in the /etc/dconf/db/gdm.d/ directory: [org/gnome/login-screen] banner-message-enable=true banner-message-text="<banner message>" This is typically configured in /etc/dconf/db/gdm.d/01-banner-message.', 'Customized rule by Cloud Raxak') from dual;

--1.8
select add_rule_data ('default','V-38481','SV-50281r1_rule','default','medium','System security patches and updates must be installed and up-to-date.','Installing software updates is a fundamental mitigation against the exploitation of publicly-known vulnerabilities. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 1.8 - Red Hat Enterprise. 1.8 - CentOS', 'F-43426r1_fix','If the system is joined to the Red Hat Network, a Red Hat Satellite Server, or a yum server, run the following command to install updates:  yum updateIf the system is not configured to use one of these sources, updates (in the form of RPM packages) can be manually downloaded from the Red Hat Network and installed using "rpm".' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000011','C-46036r1_chk','If the system is joined to the Red Hat Network, a Red Hat Satellite Server, or a yum server which provides updates, invoking the following command will indicate if updates are available:  yum check-updateIf the system is not configured to update from one of these sources, run the following command to list when each package was last updated: $ rpm -qa -lastCompare this to Red Hat Security Advisories (RHSA) listed at https://access.redhat.com/security/updates/active/ to determine whether the system is missing applicable security and bugfix  updates. If updates are not installed, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2 Services
--2.1 inetd Services
--2.1.1
select add_rule_data ('default','V-56043','SV-50462r1_rule','default','high',' The chargen-stream daemon must be disabled.','e Character Generator Protocol (CHARGEN) is a service of the Internet Protocol Suite defined in RFC 864 in 1983. It is intended for testing, debugging, and measurement purposes. The protocol is rarely used, as its design flaws allow ready misuse.Disabling CHARGEN will stop a server from being misused by an attacker in their efforts to disrupt another server.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.1 - Red Hat Enterprise. 2.1.1 - CentOS', 'F-56043','The "chargen" service can be disabled through xinetd,Update "disable = yes" in the xinetd.d service file.Restart the xinetd service service xinetd restartIf the service is configured using inetd then comment out the chargen service configuration line for TCP port in /etc/inetd.conf file.Restart the inetd service service openbsd-inetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd start/runningFinding the chargen service port value at tcp protocol. sudo grep -w ^chargen /etc/services | cut -f3 | grep -w tcp | grep -v "^\s*"example output ;- 19/tcpChecking if chargen-stream service port is enabled at tcp protocol using below command:- netstat -aunp | grep xinetd | grep :19 | grep tcpif service is running at tcp port, this is finding. If chargen service is configured using inetd, run following command: grep chargen /etc/inetd.conf | grep tcp |grep -v "^\s*"If there is output, this is finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56044','SV-50462r1_rule','default','high','The chargen-dgram daemon must be disabled.','chargen-dram is a network service that responds with 0 to 512 ASCII characters for each datagram it receives. This service is intended for debugging and testing puposes. It is recommended that this service be disabled.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.1 - Red Hat Enterprise. 2.1.1 - CentOS', 'F-56044','   The "chargen-dgram" service can be disabled with the following commands:  chkconfig chargen-dgram offRestart the xinetd service service xinetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd is running...To check that the "chargen-dgram" service is disabled in system boot configuration, run the following command:  chkconfig chargen-dgram --listOutput should indicate the "chargen-dgram" service has either not been installed, or has been disabled at all runlevels, as shown in the example below:  chkconfig "chargen-dgram" --list"chargen-dgram" 0:off 1:off 2:off 3:off 4:off 5:off 6:off S:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.1.2
select add_rule_data ('default','V-56041','SV-50462r1_rule','default','high','The daytime-stream daemon must be disabled.','daytime-stream is a network service that respondes with the server"s current date and time. This service is intended for debugging and testing puposes and should be disabled.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.2 - Red Hat Enterprise. 2.1.2 - CentOS', 'F-56041','The "daytime-stream" service can be disabled through xinetd,Update "disable = yes" in the xinetd.d service file.Restart the xinetd service service xinetd restartIf the service is configured using inetd then comment out the daytime service configuration line for TCP port in /etc/inetd.conf file.Restart the inetd service service openbsd-inetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd start/runningFinding the daytime service port value at tcp protocol. sudo grep -w ^daytime /etc/services | cut -f3 | grep -w tcp | grep -v "^\s*"example output - 13/tcpChecking if daytime-stream service port is enabled at tcp protocol using below command: netstat -aunp | grep xinetd | grep :13 | grep tcpif service is running at tcp port, this is finding.If daytime service is configured using inetd, run following command: grep daytime /etc/inetd.conf | grep tcp |grep -v "^\s*"If there is output, this is finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56042','SV-50462r1_rule','default','high',' The daytime-dgram daemon must be disabled.','The Daytime Protocol is a service in the Internet Protocol Suite. It is intended for testing and measurement purposes in computer networks.A host may connect to a server that supports the Daytime Protocol on either Transmission Control Protocol (TCP) or User Datagram Protocol (UDP) port 13. The server returns an ASCII character string of the current date and time in an unspecified format.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.2 - Red Hat Enterprise. 2.1.2 - CentOS', 'F-56042','The "daytime-dgram" service can be disabled through xinetd,Update "disable = yes" in the xinetd.d service file.Restart the xinetd service service xinetd restartIf the service is configured using inetd then comment out the daytime service configuration line for UDP port in /etc/inetd.conf file.Restart the inetd service service openbsd-inetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd start/runningFinding the daytime service port value at udp protocol. sudo grep -w ^daytime /etc/services | cut -f3 | grep -w udp | grep -v "^\s*"example output :- 13/udpChecking if daytime-dgram service port is enabled at udp protocol using below command:- netstat -aunp | grep xinetd | grep :13 | grep udpif service is running at udp port, this is finding. If daytime service is configured using inetd, run following command: grep daytime /etc/inetd.conf | grep udp |grep -v "^\s*"If there is output, this is finding.','Customized rule by Cloud Raxak') from dual;

--2.1.3
select add_rule_data ('default','C-is213','sv-2.1.3_cis_rule','default','high','Ensure discard services are not enabled ','discard is a network service that simply discards all data it receives. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.Disabling this service will reduce the remote attack surface of the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.3 - Red Hat Enterprise. 2.1.3 - CentOS', 'F-cis-2.1.3_fix','Run the following commands to disable discard-dgram and discard-stream: # chkconfig discard-dgram off # chkconfig discard-stream off','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-2.1.3','CIS-2.1.3_chk', 'Run the following command and verify discard-dgram and discard-stream are off or missing: # chkconfig --list xinetd based services: discard-dgram: off discard-stream: off' ,'Customized rule by Cloud Raxak') from dual;

--2.1.4
select add_rule_data ('default','V-56045','SV-50462r1_rule','default','high',' The echo-stream and echo-dgram daemon must be disabled.','The Echo Protocol is a service in the Internet Protocol Suite defined in RFC 862.A host may connect to a server that supports the Echo Protocol using the Transmission Control Protocol (TCP) or the User Datagram Protocol (UDP) on the well-known port number 7. The server sends back an identical copy of the data it received.It is recommended that this service be disabled.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.4 - Red Hat Enterprise. 2.1.4 - CentOS', 'F-56045','   The "echo-stream" and "echo-dgram" service can be disabled with the following commands:  chkconfig echo-stream offRestart the xinetd service service xinetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd is running...To check that the "echo-stream" service are disabled in system boot configuration, run the following command:  chkconfig echo-stream --listOutput should indicate the "echo-stream" service has either not been installed, or have been disabled at all runlevels, as shown in the example below:  chkconfig "echo-stream" --list"echo-stream" 0:off 1:off 2:off 3:off 4:off 5:off 6:off S:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56079','SV-50462r1_rule','default','high',' The echo-stream and echo-dgram daemon must be disabled.','The Echo Protocol is a service in the Internet Protocol Suite defined in RFC 862.A host may connect to a server that supports the Echo Protocol using the Transmission Control Protocol (TCP) or the User Datagram Protocol (UDP) on the well-known port number 7. The server sends back an identical copy of the data it received.It is recommended that this service be disabled.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.4 - Red Hat Enterprise. 2.1.4 - CentOS', 'F-56079','   The "echo-dgram" service can be disabled with the following commands:  chkconfig echo-dgram offRestart the xinetd service service xinetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "xinetd" service is enabled, run the following command:  service xinetd statusxinetd is running...To check that the "echo-dgram" service are disabled in system boot configuration, run the following command:  chkconfig echo-dgram --listOutput should indicate the "echo-dgram" service has either not been installed, or have been disabled at all runlevels, as shown in the example below:  chkconfig "echo-dgram" --list"echo-dgram" 0:off 1:off 2:off 3:off 4:off 5:off 6:off S:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.1.5
select add_rule_data ('default','C-is215','sv-2.1.5_cis_rule','default','high','Ensure time services are not enabled','time is a network service that responds with the servers current date and time as a 32 bit integer. This service is intended for debugging and testing purposes. It is recommended that this service be disabled.Disabling this service will reduce the remote attack surface of the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.5 - Red Hat Enterprise. 2.1.5 - CentOS', 'F-cis-2.1.5_fix','Run the following commands to disable time-dgram and time-stream: # chkconfig time-dgram off # chkconfig time-stream off','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-2.1.5','CIS-2.1.5_chk', 'Run the following command and verify time-dgram and time-stream are off or missing: # chkconfig --list xinetd based services: time-dgram: off time-stream: off' ,'Customized rule by Cloud Raxak') from dual;

--2.1.6
select add_rule_data ('default','V-38609','SV-50410r2_rule','default','medium','The TFTP service must not be running.','Disabling the "tftp" service ensures the system is not acting as a tftp server, which does not provide encryption or authentication. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.6 - Red Hat Enterprise. 2.1.6 - CentOS', 'F-43557r4_fix','The "tftp" service should be disabled. The "tftp" service can be disabled with the following command:  chkconfig tftp off' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000223','C-46166r2_chk','To check that the "tftp" service is disabled in system boot configuration, run the following command: chkconfig "tftp" --listOutput should indicate the "tftp" service has either not been installed, or has been disabled, as shown in the example below: chkconfig "tftp" --listtftp offORerror reading information on service tftp: No such file or directoryIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.1.7
select add_rule_data ('default','V-38582','SV-50383r2_rule','default','medium','The xinetd service must be disabled if no network services utilizing it are enabled.','The xinetd service provides a dedicated listener service for some programs, which is no longer necessary for commonly-used network services. Disabling it ensures that these uncommon services are not running, and also prevents attacks against xinetd itself. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.1.7 - Red Hat Enterprise. 2.1.7 - CentOS', 'F-43530r2_fix','The "xinetd" service can be disabled with the following commands:  chkconfig xinetd off service xinetd stop' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000203','C-46140r2_chk','If network services are using the xinetd service, this is not applicable.Run the following command to verify "xinetd" is disabled through current runtime configuration: service xinetd statusIf the service is disabled the command will return the following output:xinetd is stoppedTo check that the "xinetd" service is disabled in system boot configuration, run the following command:  chkconfig "xinetd" --listOutput should indicate the "xinetd" service has either not been installed, or has been disabled at all runlevels, as shown in the example below:  chkconfig "xinetd" --list"xinetd" 0:off 1:off 2:off 3:off 4:off 5:off 6:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2 Special Purpose Services
--2.2.1 Time Synchronization
--2.2.1.1
select add_rule_data ('default','V-38620','SV-50421r1_rule','default','medium','The system clock must be synchronized continuously, or at least daily.','Enabling the "ntpd" service ensures that the "ntpd" service will be running and that the system will synchronize its time to any servers specified. This is important whether the system is configured to be a client (and synchronize only its own clock) or it is also acting as an NTP server to other systems. Synchronizing time is essential for authentication services such as Kerberos, but it is also important for maintaining accurate logs and auditing possible security breaches. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.1.1 - Red Hat Enterprise. 2.2.1.1 - CentOS', 'F-43568r1_fix','Install the service if service is not installed with the following command: $ apt-get -y install ntpThe "ntp" service can be enabled with the following command:$ service ntp start$ sysv-rc-conf --level 0123456S ntp on' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000247','C-46178r1_chk','To verify the "ntpd" package is installed on the system, run the following command: $ dpkg -s ntpdRun the following command to determine the current status of the "ntpd" service:$ service ntp statusIf the service is enabled, it should return the following:  * NTP server is runningIf the service is not running, this is a finding.Run the following command to determine the current status of the "ntpd" server configuration:$ ntpq -p | wc -lIf NTP servers are properly configured for synchronizing the time, you can see get output is "0".If output is "1", this is a finding','Customized rule by Cloud Raxak') from dual;

--2.2.1.2
select add_rule_data ('default','V-38621','SV-50422r1_rule','default','medium','The system clock must be synchronized to an authoritative DoD time source.','Synchronizing with an NTP server makes it possible to collate system logs from multiple sources or correlate computer events with real time events. Using a trusted NTP server provided by your organization is recommended. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.1.2 - Red Hat Enterprise. 2.2.1.2 - CentOS', 'F-43570r1_fix','To specify a remote NTP server for time synchronization, edit the file "/etc/ntp.conf". Add or correct the following lines, substituting the IP or hostname of a remote NTP server for ntpserver. server []This instructs the NTP software to contact that remote server to obtain time data.Restart NTP service to get changes in effect by using the command:$ service ntp restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000248','C-46180r1_chk','To verify the "ntpd" package is installed on the system, run the following command: $ dpkg -s ntpdRun the following command to determine the current status of the "ntpd" service: $ service ntpd statusIf the service is enabled, it should return the following:ntpd is running...If the service is not running, this is a finding.Run the following command to determine the current status of the "ntpd" server configuration:$ ntpq -p | wc -lIf NTP servers are properly configured for synchronizing the time, you can see get output is "0".If output is "1", this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.1.3
select add_rule_data ('default','C-30010','SV-3018r1_rule','default','high', 'Ensure chrony is configured', 'chrony is a daemon which implements the Network Time Protocol (NTP) is designed to synchronize system clocks across a variety of systems and use a source that is highly accurate. More information on chrony can be found at http://chrony.tuxfamily.org/. chrony can be configured to be a client and/or a server. Rationale: If chrony is in use on the system proper configuration is vital to ensuring time synchronization is working properly. This recommendation only applies if chrony is in use on the system Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.1.3 - Red Hat Enterprise. 2.2.1.3 - CentOS', 'F-30010', 'Add or edit server or pool lines to /etc/chrony.conf as appropriate: server <remote-server> Add or edit the OPTIONS in /etc/sysconfig/chronyd to include "-u chrony": OPTIONS="-u chrony"', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30010', 'Run the following command and verify remote server is configured properly: # grep "^(server|pool)" /etc/chrony.conf server <remote-server> Multiple servers may be configured. Run the following command and verify OPTIONS includes "-u chrony": # grep ^OPTIONS /etc/sysconfig/chronyd OPTIONS="-u chrony" Additional options may be present.', 'Customized rule by Cloud Raxak') from dual;

--2.2.2
select add_rule_data ('default','V-38676','SV-50477r2_rule','default','low','The xorg-x11-server-common (X Windows) package must not be installed, unless required.','Unnecessary packages should not be installed to decrease the attack surface of the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.2 - Red Hat Enterprise. 2.2.2 - CentOS', 'F-43625r1_fix','Removing all packages which constitute the X Window System ensures users or malicious software cannot start X. To do so, run the following command:  apt-get -y purge xserver-common' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000291','C-46236r1_chk','To ensure the X Windows package group is removed, run the following command: $ dpkg -s xserver-commonThe output should be:package xserver-common is not installedIf it is not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.3
select add_rule_data ('default','V-38618','SV-50419r2_rule','default','low','The avahi service must be disabled.','Because the Avahi daemon service keeps an open network port, it is subject to network attacks. Its functionality is convenient but is only appropriate if the local network can be trusted. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.3 - Red Hat Enterprise. 2.2.3 - CentOS', 'F-43567r2_fix','The "avahi-daemon" service can be disabled with the following commands:  chkconfig avahi-daemon off service avahi-daemon stop' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000246','C-46177r1_chk','Run the following command to verify "avahi-daemon" is disabled through current runtime configuration: service avahi-daemon statusIf the service is disabled the command will return the following output:avahi-daemon is stoppedTo check that the "avahi-daemon" service is disabled in system boot configuration, run the following command:  chkconfig --list avahi-daemonOutput should indicate the "avahi-daemon" service has either not been installed, or has been disabled at all runlevels, as shown in the example below:  chkconfig --list avahi-daemon"avahi-daemon" 0:off 1:off 2:off 3:off 4:off 5:off 6:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.4
select add_rule_data ('default','V-56039','SV-50462r1_rule','default','high','The CUPS (Print server) daemon must be disabled.','CUPS (an acronym for Common Unix Printing System) is a modular printing system for Unix-like computer operating systems which allows a computer to act as a print server. A computer running CUPS is a host that can accept print jobs from client computers, process them, and send them to the appropriate printer.Anyone on the local network can see the CUPS page for any other local machine which is not secure.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.4 - Red Hat Enterprise. 2.2.4 - CentOS', 'F-56039','   The "cups" service can be disabled with the following commands:  chkconfig --level 0123456 cups off service cups stop' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Run the following command to verify "cups" is disabled through current runtime configuration:  service cups statusIf the service is disabled the command will return the following output: cups is stoppedTo check that the "cups" service is disabled in system boot configuration, run the following command:  chkconfig "cups" --listOutput should indicate the "cups" service has either not been installed, or has been disabled at all runlevels, as shown in the example below:  chkconfig "cups" --list"cups" 0:off 1:off 2:off 3:off 4:off 5:off 6:offIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.5
select add_rule_data ('default','V-56066','SV-50462r1_rule','default','high','The DHCP Server package must not be installed on system.','DHCP automation can be a serious security risk if a rogue DHCP server is introduced to the network. A rogue server isn"t under control of the network staff, and can offer IP addresses to users connecting to the network. If a user connects to the rogue DHCP, information sent over that connection can be intercepted or looked at, violating user privacy and network security. This rule verifies that dhcp package does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.5 - Red Hat Enterprise. 2.2.5 - CentOS', 'F-56066','If installed on system, remove the dhcp package by running: yum remove dhcp dnsmasq' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether dhcp server is installed on system: rpm -q dhcp rpm -q dnsmasqIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.6
select add_rule_data ('default','V-38627','SV-50428r1_rule','default','low','The openldap-servers package must not be installed unless required.','Unnecessary packages should not be installed to decrease the attack surface of the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.6 - Red Hat Enterprise. 2.2.6 - CentOS', 'F-43577r1_fix','The "openldap-servers" package should be removed if not in use. Is this machine the OpenLDAP server? If not, remove the package.  yum erase openldap-serversThe openldap-servers RPM is not installed by default on RHEL6 machines. It is needed only by the OpenLDAP server, not by the clients which use LDAP for authentication. If the system is not intended for use as an LDAP Server it should be removed.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000256','C-46187r1_chk','To verify the "openldap-servers" package is not installed, run the following command: $ rpm -q openldap-serversThe output should show the following. package openldap-servers is not installedIf it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.7
select add_rule_data ('default','V-56040','SV-50462r1_rule','default','high','NFS and RCP daemon must be disabled.','NFS (Network File System) allows you to "share" a directory located on one networked computer with other computers/devices on that network. The rpcbind utility is a server that converts RPC program numbers into universal addresses.  It must be running on the host to be able to make RPC calls on a server on that machine.If one of the NFS services does not start up correctly, rpcbind will be unable to map RPC requests from clients for that service to the correct port. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.7 - Red Hat Enterprise. 2.2.7 - CentOS', 'F-56040','The "nfs" and "rpcbind" service can be disabled with the following commands: chkconfig nfs off chkconfig rpcbind off service nfs stop service rpcbind stopRestart the xinetd service service xinetd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "rpcbind" and "nfs" service is disabled in system boot configuration, run the following command: chkconfig "rpcbind" --list chkconfig "nfs" --listOutput should indicate the "nfs" and "rpcbind" service have either not been installed, or have been disabled at all runlevels, as shown in the example below: chkconfig "rpcbind" --list"rpcbind" 0:off 1:off 2:off 3:off 4:off 5:off 6:off S:off chkconfig "nfs" --list"nfs" 0:off 1:off 2:off 3:off 4:off 5:off 6:off S:offRun the following command to verify "nfs" and "rpcbind" are disabled through current runtime configuration: service rpcbind status service nfs statusIf the service is disabled the command will return the following output:rpcbind is stoppednfs is stoppedIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.8
select add_rule_data ('default','V-56037','SV-50462r1_rule','default','high','The DNS Server package must not be installed on system.','Domain Name System (DNS) is a centralised mechanism for resolving / giving the IP addresses for a given domain name. Breakdown of DNS would crash the world wide web though there are many root servers and backup servers targetting DNS servers at particular key locations would do lot of harm. This rule verifies that DNS server is not installed.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.8 - Red Hat Enterprise. 2.2.8 - CentOS','F-56037','If installed on system, remove the bind9 package by running: apt-get purge bind9' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether bind9 is installed on system: dpkg -s bind9If a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.9
select add_rule_data ('default','V-56075','SV-50462r1_rule','default','high','The FTP Server package must not be installed on system.','FTP (File transfer protocol) is resposible for insecure file transfers over the network. This rule asks to uninstall ftp server if installed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.9 - Red Hat Enterprise. 2.2.9 - CentOS', 'F-56075','If installed on system, remove the vsftpd package by running: apt-get purge vsftpd' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether vsftpd is installed on system: dpkg -s vsftpdIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.10
select add_rule_data ('default','V-56034','SV-50462r1_rule','default','high','The HTTP Server package must not be installed on system.','The HTTP server daemon just replies to the request header it receives. It is not secure like HTTPS which has stronger security checks than HTTP. This rule verifies that httpd package does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.10 - Red Hat Enterprise. 2.2.10 - CentOS', 'F-56034','If installed on system, remove the apache2 package by running: apt-get purge apache2' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether apache2 is installed on system: dpkg -s apache2If a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.11
select add_rule_data ('default','V-56036','SV-50462r1_rule','default','high','The Dovecot (IMAP and POP3 services) package must not be installed on system.','The dovecot service has a lesser memory footprint hence it uses lesser resources. But it has a poor error handling mechanism. This rule verifies that dovecot package does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.11 - Red Hat Enterprise. 2.2.11 - CentOS', 'F-56036','If installed on system, remove the dovecot package by running: yum remove dovecot' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether dovecot is installed on system: rpm -q dovecotIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.12
select add_rule_data ('default','V-56076','SV-50462r1_rule','default','high','The samba package must not be installed on system.','Since Samba server is in it"s development phase, it is not secure because the bugs in the software leave the system vulnerable to mail archive loss. This rule asks to uninstall samba package from the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.12 - Red Hat Enterprise. 2.2.12 - CentOS', 'F-56076','If installed on system, remove the samba package by running: apt-get purge samba' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether samba is installed on system: dpkg -s sambaIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.13
select add_rule_data ('default','V-56035','SV-50462r1_rule','default','high','The HTTP proxy server package must not be installed on system.','Malicious clients try to exploit open proxy servers to access a website without revealing their true location. They could be doing this to manipulate pay-per-click ad systems, to add comment or link-spam to someone else"s site, or just to do something nasty without being detected. This rule verifies that squid package does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.13 - Red Hat Enterprise. 2.2.13 - CentOS', 'F-56035','If installed on system, remove the squid3 package by running: apt-get purge squid3' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether squid3 is installed on system: dpkg -s squid3If a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.14
select add_rule_data ('default','V-56030','SV-50462r1_rule','default','high','The SNMP Server package must not be installed on system.','This rule verifies that net-snmp package does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.14 - Red Hat Enterprise. 2.2.14 - CentOS', 'F-56030','If installed on system, remove the net-snmp package by running: yum remove net-snmp' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether net-snmp is installed on system: rpm -q net-snmpIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.15
select add_rule_data ('default','V-38622','SV-50423r2_rule','default','medium','Mail relaying must be restricted.','This ensures "postfix" accepts mail messages (such as cron job reports) from the local system only, and not from the network, which protects it from network attack. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.15 - Red Hat Enterprise. 2.2.15 - CentOS', 'F-43572r1_fix','Edit the file "/etc/postfix/main.cf" to ensure that only the following "inet_interfaces" line appears: inet_interfaces = localhost' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000249','C-46182r2_chk','If the system is an authorized mail relay host, this is not applicable. Run the following command to ensure postfix accepts mail messages from only the local system: $ grep -w ^inet_interfaces /etc/postfix/main.cf | grep -v "^"If properly configured, the output should show only "localhost". If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.16
select add_rule_data ('default','V-38603','SV-50404r1_rule','default','medium','The ypserv package must not be installed.','Removing the "ypserv" package decreases the risk of the accidental (or intentional) activation of NIS or NIS+ services. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.16 - Red Hat Enterprise. 2.2.16 - CentOS', 'F-43551r1_fix','The "ypserv" package can be uninstalled with the following command:  dpkg -r --force-all nis(Since ypserv is nis in ubuntu so there is no separate package for ypserv. Hence, we are removing nis package.)   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000220','C-46161r1_chk','Run the following command to determine if the "nis" package is installed:  service nis statusIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.17
select add_rule_data ('default','V-38591','SV-50392r1_rule','default','high','The rsh-server package must not be installed.','The "rsh-server" package provides several obsolete and insecure network services. Removing it decreases the risk of those services" accidental (or intentional) activation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.17 - Red Hat Enterprise. 2.2.17 - CentOS', 'F-43539r1_fix','The "rsh-server" package can be uninstalled with the following command:  dpkg -r --force-all rsh-server' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000213','C-46149r1_chk','Run the following command to determine if the "rsh-server" package is installed:  dpkg -s rsh-serverIf the package is installed, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.18
select add_rule_data ('default','V-38589','SV-50390r2_rule','default','high','The telnet daemon must not be running.','The telnet protocol uses unencrypted network communication, which means that data from the login session, including passwords and all other information transmitted during the session, can be stolen by eavesdroppers on the network. The telnet protocol is also subject to man-in-the-middle attacks.Mitigation:  If an enabled telnet daemon is configured to only allow encrypted sessions, such as with Kerberos or the use of encrypted network tunnels, the risk of exposing sensitive information is mitigated. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.19 - Red Hat Enterprise. 2.2.18 - CentOS', 'F-43537r1_fix','The "telnet" service can be disabled with the following command:  chkconfig telnet off' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000211','C-46147r3_chk','To check that the "telnet" service is disabled in system boot configuration, run the following command:  chkconfig "telnet" --listOutput should indicate the "telnet" service has either not been installed, or has been disabled, as shown in the example below: chkconfig "telnet" --listtelnet offORerror reading information on service telnet: No such file or directoryIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.19
--select add_rule_data ('default','V-38609','SV-50410r2_rule','default','medium','The TFTP service must not be running.','Disabling the "tftp" service ensures the system is not acting as a tftp server, which does not provide encryption or authentication. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.20 - Red Hat Enterprise. 2.2.19 - CentOS', 'F-43557r4_fix','The "tftp" service should be disabled. The "tftp" service can be disabled with the following command:  chkconfig tftp off' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000223','C-46166r2_chk','To check that the "tftp" service is disabled in system boot configuration, run the following command: chkconfig "tftp" --listOutput should indicate the "tftp" service has either not been installed, or has been disabled, as shown in the example below: chkconfig "tftp" --listtftp offORerror reading information on service tftp: No such file or directoryIf the service is running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.2.20
select add_rule_data ('default','C-30011','sv-2.2.21_cis_rule','default','high','Ensure rsync service is not enabled','The rsyncd service can be used to synchronize files between systems over network links. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.21 - Red Hat Enterprise. 2.2.20 - CentOS', 'F-cis-2.2.21_fix','Run the following command to disable rsyncd: # systemctl disable rsyncd','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-2.2.21','CIS-2.2.21_chk', 'Run the following command to verify rsyncd is not enabled: # systemctl is-enabled rsync d disabled' ,'Customized rule by Cloud Raxak') from dual;

--2.2.21
select add_rule_data ('default','C-30012','SV-3019r1_rule','default','high', 'Ensure talk server is not enabled ', 
'The talk software makes it possible for users to send and receive messages across systems through a terminal session. 
The talk client (allows initiate of talk sessions) is installed by default. 
The software presents a security risk as it uses unencrypted protocols for communication. 
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.2.18 - Red Hat Enterprise. 2.2.21 - CentOS', 
'F-30012', 'Run the following command to disable talk:
# systemctl disable ntalk', 
'[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent',
'CHK-30012', 'Run the following command and verify result is not "enabled":
# systemctl is-enabled ntalk
disabled', 'Customized rule by Cloud Raxak') from dual;

--2.3 Service Clients
--2.3.1
select add_rule_data ('default','C-30013','SV-3020r1_rule','default','high', 'Ensure NIS Client is not installed', 'The Network Information Service (NIS), formerly known as Yellow Pages, is a client-server directory service protocol used to distribute system configuration files. The NIS client ( ypbind ) was used to bind a machine to an NIS server and receive the distributed configuration files. The NIS service is inherently an insecure system that has been vulnerable to DOS attacks, buffer overflows and has poor authentication for querying NIS maps. NIS generally has been replaced by such protocols as Lightweight Directory Access Protocol (LDAP). It is recommended that the service be removed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.3.1 - Red Hat Enterprise. 2.3.1 - CentOS', 'F-30013', 'Run the following command to uninstall ypbind : # yum remove ypbind', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30013', 'Run the following command and verify ypbind is not installed: cmd# rpm -q ypbind output#package ypbind is not installed', 'Customized rule by Cloud Raxak') from dual;

--2.3.2
select add_rule_data ('default','C-30014','SV-3021r1_rule','default','high', 'Ensure rsh client is not installed', 'The rsh package contains the client commands for the rsh services. These legacy clients contain numerous security exposures and have been replaced with the more secure SSH package. Even if the server is removed, it is best to ensure the clients are also removed to prevent users from inadvertently attempting to use these commands and therefore exposing their credentials. Note that removing the rsh package removes the clients for rsh , rcp and rlogin. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.3.2 - Red Hat Enterprise. 2.3.2 - CentOS', 'F-30014', 'Run the following command to uninstall rsh : # yum remove rsh', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30014', 'Run the following command and verify rsh is not installed: cmd# rpm -q rsh output#package rsh is not installed', 'Customized rule by Cloud Raxak') from dual;

--2.3.3
select add_rule_data ('default','C-30015','SV-3022r1_rule','default','high', 'Ensure talk client is not installed', 'The talk software makes it possible for users to send and receive messages across systems through a terminal session. The talk client, which allows initialization of talk sessions, is installed by default. The software presents a security risk as it uses unencrypted protocols for communication. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.3.3 - Red Hat Enterprise. 2.3.3 - CentOS', 'F-30015', 'Run the following command to uninstall talk : # yum remove talk', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30015', 'Run the following command and verify talk is not installed: cmd# rpm -q talk output# package talk is not installed', 'Customized rule by Cloud Raxak') from dual;

--2.3.4
select add_rule_data ('default','V-56077','SV-50462r1_rule','default','high','The telnet-client package must not be installed on system.','Telenet client or server are not as secure as ssh over a network. This rule asks to uninstall telnet client from the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.3.4 - Red Hat Enterprise. 2.3.4 - CentOS', 'F-56077','If installed on system, remove the telnet package by running: yum remove telnet' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether telnet is installed on system: rpm -q telnetIf a line with package name and version is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--2.3.5
select add_rule_data ('default','C-is235','sv-2.3.5_cis_rule','default','high','Ensure LDAP client is not installed','The Lightweight Directory Access Protocol (LDAP) was introduced as a replacement for NIS/YP. It is a service that provides a method for looking up information from a central database.If the system will not need to act as an LDAP client, it is recommended that the software be removed to reduce the potential attack surface. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 2.3.5 - Red Hat Enterprise. 2.3.5 - CentOS', 'F-cis-2.3.5_fix','Run the following command to uninstall openldap-clients: # yum remove openldap-clients','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-2.3.5','CIS-2.3.5_chk', 'Run the following commands to verify openldap-clients is not installed: # rpm -q openldap-clients package openldap-clients is not installed' ,'Customized rule by Cloud Raxak') from dual;

--3 Network Configuration
--3.1 Network Parameters (Host Only)
--3.1.1
select add_rule_data ('default','V-38511','SV-50312r2_rule','default','medium','IP forwarding for IPv4 must not be enabled, unless the system is a router.','IP forwarding permits the kernel to forward packets from one network interface to another. The ability to forward packets between two networks is only appropriate for systems acting as routers. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.1.1 - Red Hat Enterprise. 3.1.1 - CentOS', 'F-43458r2_fix','To set the runtime status of the "net.ipv4.conf.all.forwarding" kernel parameter, run the following command:  sysctl -w net.ipv4.conf.all.forwarding=0To make this configuration persistent, add the following line in "/etc/sysctl.conf" and make sure that it has only single instance.net.ipv4.conf.all.forwarding = 0and run following command.  sysctl -p or restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000082','C-46068r3_chk','Check if IP forwarding for IPv4 is enabled on the system, by querying the following command:  sysctl net.ipv4.conf.all.forwardingIf the output of the command is not "0", this is a finding. Verify the value of net.ipv4.conf.all.forwarding in "/etc/sysctl.conf". If is not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.1.2
select add_rule_data ('default','V-38601','SV-50402r2_rule','default','medium','The system must not send ICMPv4 redirects from any interface.','Sending ICMP redirects permits the system to instruct other systems to update their routing information. The ability to send ICMP redirects is only appropriate for systems acting as routers. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.1.2 - Red Hat Enterprise. 3.1.2 - CentOS', 'F-43548r1_fix','To set the runtime status of the "net.ipv4.conf.all.send_redirects" kernel parameter, run the following command:  sysctl -w net.ipv4.conf.all.send_redirects=0To make the changes persistent, add the following line to "/etc/sysctl.conf" and make sure that it has only single instance.net.ipv4.conf.all.send_redirects = 0and run following command sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000081','C-46159r2_chk','Check if system sends ICMPv4 redirects from any interface, by querying the following command: sysctl net.ipv4.conf.all.send_redirectsIf the output of the command is not "0" on any interface, this is a finding.Verify the value of net.ipv4.conf.all.send_redirects in "/etc/sysctl.conf".If is not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2 Network Parameters (Host and Router)
--3.2.1
select add_rule_data ('default','V-38523','SV-50324r2_rule','default','medium','The system must not accept IPv4 source-routed packets on any interface.','Accepting source-routed packets in the IPv4 protocol has few legitimate uses. It should be disabled unless it is absolutely required. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.1 - Red Hat Enterprise. 3.2.1 - CentOS', 'F-43471r1_fix','To reject IPv4 source-routed packets on all interface, run the following commands. sysctl -w net.ipv4.conf.all.accept_source_route=0 sysctl -w net.ipv4.conf.default.accept_source_route=0 sysctl -w net.ipv4.conf.eth0.accept_source_route=0 sysctl -w net.ipv4.conf.lo.accept_source_route=0To make this configuration persistent, set the following interfaces in "/etc/sysctl.conf" file.net.ipv4.conf.all.accept_source_route = 0net.ipv4.conf.default.accept_source_route = 0net.ipv4.conf.eth0.accept_source_route = 0net.ipv4.conf.lo.accept_source_route = 0and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000083','C-46081r3_chk','Check if system is configured to reject IPv4 source-routed packets on any interface, by querying the following command: sysctl "net.ipv4.conf" 2>/dev/null | grep "\.accept_source_route = 1"If any value is not set to "0", this is a findingVerify the interface valuesnet.ipv4.conf.all.accept_source_routenet.ipv4.conf.default.accept_source_routenet.ipv4.conf.eth0.accept_source_routenet.ipv4.conf.lo.accept_source_routein "/etc/sysctl.conf".If any one is not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.2
select add_rule_data ('default','V-38524','SV-50325r2_rule','default','medium','The system must not accept ICMPv4 redirect packets on any interface.','Accepting ICMP redirects has few legitimate uses. It should be disabled unless it is absolutely required. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.2 - Red Hat Enterprise. 3.2.2 - CentOS', 'F-43472r1_fix','To configure the system to reject ICMPv4 redirect packets on all interfaces, run the following commands. sysctl -w net.ipv4.conf.all.accept_redirects=0 sysctl -w net.ipv4.conf.default.accept_redirects=0 sysctl -w net.ipv4.conf.eth0.accept_redirects=0 sysctl -w net.ipv4.conf.lo.accept_redirects=0To make this configuration persistent, add the following lines in "/etc/sysctl.conf" file.net.ipv4.conf.all.accept_redirects=0net.ipv4.conf.default.accept_redirects=0net.ipv4.conf.eth0.accept_redirects=0net.ipv4.conf.lo.accept_redirects=0 and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000084','C-46082r2_chk','Check if the system is configured to reject ICMPv4 redirect packets, by querying the following command: sysctl "net.ipv4.conf" 2>/dev/null | grep "\.accept_redirects = 1"If the output of the command is not "0", this is a finding.Verify the interface values net.ipv4.conf.all.accept_redirectsnet.ipv4.conf.default.accept_redirectsnet.ipv4.conf.eth0.accept_redirectsnet.ipv4.conf.lo.accept_redirectsin "/etc/sysctl.conf".If any one is not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.3
select add_rule_data ('default','V-38526','SV-50327r2_rule','default','medium','The system must not accept ICMPv4 secure redirect packets on any interface.','Accepting "secure" ICMP redirects (from those gateways listed as default gateways) has few legitimate uses. It should be disabled unless it is absolutely required. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.3 - Red Hat Enterprise. 3.2.3 - CentOS', 'F-43474r1_fix','To configure the system to reject ICMPv4 secure redirect packets on all interfaces, run the following commands. sysctl -w net.ipv4.conf.all.secure_redirects=0 sysctl -w net.ipv4.conf.default.secure_redirects=0 sysctl -w net.ipv4.conf.eth0.secure_redirects=0 sysctl -w net.ipv4.conf.lo.secure_redirects=0To make this configuration persistent, add the following lines in "/etc/sysctl.conf" file.net.ipv4.conf.all.secure_redirects=0net.ipv4.conf.default.secure_redirects=0net.ipv4.conf.eth0.secure_redirects=0net.ipv4.conf.lo.secure_redirects=0and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000086','C-46084r2_chk','To check if system accepts ICMPv4 secure redirect packets on any interface, run the following command: sysctl "net.ipv4.conf" 2>/dev/null | grep "\.secure_redirects = 1"If the output of the command is not "0", this is a finding.Verify the interface values net.ipv4.conf.all.secure_redirectsnet.ipv4.conf.default.secure_redirectsnet.ipv4.conf.eth0.secure_redirectsnet.ipv4.conf.lo.secure_redirectsin "/etc/sysctl.conf".If any one is not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.4
select add_rule_data ('default','V-38528','SV-50329r2_rule','default','low','The system must log Martian packets.','The presence of "martian" packets (which have impossible addresses) as well as spoofed packets, source-routed packets, and redirects could be a sign of nefarious network activity. Logging these packets enables this activity to be detected. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.4 - Red Hat Enterprise. 3.2.4 - CentOS', 'F-43476r1_fix','To configure the system to log Martian packets, run the following commands: sysctl -w net.ipv4.conf.all.log_martians=1 sysctl -w net.ipv4.conf.default.log_martians=1 sysctl -w net.ipv4.conf.eth0.log_martians=1 sysctl -w net.ipv4.conf.lo.log_martians=1To make this configuration persistent, add the following line to "/etc/sysctl.conf" and make sure that it has only single instance.net.ipv4.conf.all.log_martians = 1net.ipv4.conf.default.log_martians=1net.ipv4.conf.eth0.log_martians=1net.ipv4.conf.lo.log_martians=1and run following command. sysctl -por restart sysctl' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000088','C-46086r3_chk','Check if the system is configured to log Martian packets, by querying the following command: sysctl net.ipv4.conf 2>/dev/null | grep "log_martians = 0"If the output of the command is not "1", this is a finding.Verify the values of net.ipv4.conf.all.log_martiansnet.ipv4.conf.all.log_martiansnet.ipv4.conf.default.log_martiansnet.ipv4.conf.eth0.log_martiansnet.ipv4.conf.lo.log_martiansin "/etc/sysctl.conf".If any one is not set to "1" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.5
select add_rule_data ('default','V-38535','SV-50336r2_rule','default','low','The system must not respond to ICMPv4 sent to a broadcast address.','Ignoring ICMP echo requests (pings) sent to broadcast or multicast addresses makes the system slightly more difficult to enumerate on the network. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.5 - Red Hat Enterprise. 3.2.5 - CentOS', 'F-43483r1_fix','To set the runtime status of the "net.ipv4.icmp_echo_ignore_broadcasts" kernel parameter, run the following command:  sysctl -w net.ipv4.icmp_echo_ignore_broadcasts=1To make this configuration persistent, add the following line to "/etc/sysctl.conf": net.ipv4.icmp_echo_ignore_broadcasts = 1and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000092','C-46093r2_chk','The status of the "net.ipv4.icmp_echo_ignore_broadcasts" kernel parameter can be queried by running the following command: sysctl net.ipv4.icmp_echo_ignore_broadcastsThe output of the command should indicate a value of "1". If this value is not the value, this is a finding.Verify the value of net.ipv4.icmp_echo_ignore_broadcasts in "/etc/sysctl.conf".If is not set to "1" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.6
select add_rule_data ('default','V-38537','SV-50338r2_rule','default','low','The system must ignore ICMPv4 bogus error responses.','Ignoring bogus ICMP error responses reduces log size, although some activity would not be logged. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.6 - Red Hat Enterprise. 3.2.6 - CentOS', 'F-43485r1_fix','To set the runtime status of the "net.ipv4.icmp_ignore_bogus_error_responses" kernel parameter, run the following command:  sysctl -w net.ipv4.icmp_ignore_bogus_error_responses=1If this is not the system"s default value, add the following line to "/etc/sysctl.conf": net.ipv4.icmp_ignore_bogus_error_responses = 1and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000093','C-46095r2_chk','The status of the "net.ipv4.icmp_ignore_bogus_error_responses" kernel parameter can be queried by running the following command: sysctl net.ipv4.icmp_ignore_bogus_error_responsesThe output of the command should indicate a value of "1". If this value is not the default value, investigate how it could have been adjusted at runtime, and verify it is not set improperly in "/etc/sysctl.conf". grep net.ipv4.icmp_ignore_bogus_error_responses /etc/sysctl.confIf the correct value is not returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--3.2.7
select add_rule_data ('default','V-38542','SV-50343r2_rule','default','medium','The system must use a reverse-path filter for IPv4 network traffic when possible on all interfaces.','Enabling reverse path filtering drops packets with source addresses that should not have been able to be received on the interface they were received on. It should not be used on systems which are routers for complicated networks, but is helpful for end hosts and routers serving small networks. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.7 - Red Hat Enterprise. 3.2.7 - CentOS', 'F-43490r1_fix','To set the runtime status of the "net.ipv4.conf.all.rp_filter" kernel parameter, run the following command:  sysctl -w net.ipv4.conf.all.rp_filter=1To make this configuration persistent, add the following line to "/etc/sysctl.conf" and make sure that it has only single instance.net.ipv4.conf.all.rp_filter = 1 To make this configuration persistent, run following command.  sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000096','C-46100r2_chk','Check if system is configured to use the reverse-path filter for IPv4 network traffic on all interfaces enabledon the system, by querying the following command: sysctl net.ipv4.conf.all.rp_filterIf the output of the command is not "1", this is a finding.Verify the value of net.ipv4.conf.all.rp_filter in "/etc/sysctl.conf".If it"s not set to "1" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.2.8
select add_rule_data ('default','V-38539','SV-50340r2_rule','default','medium','The system must be configured to use TCP syncookies when experiencing a TCP SYN flood.','A TCP SYN flood attack can cause a denial of service by filling a system"s TCP connection table with connections in the SYN_RCVD state. Syncookies can be used to track a connection when a subsequent ACK is received, verifying the initiator is attempting a valid connection and is not a flood source. This feature is activated when a flood condition is detected, and enables the system to continue servicing valid connection requests. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.2.8 - Red Hat Enterprise. 3.2.8 - CentOS', 'F-43487r1_fix','To set the runtime status of the "net.ipv4.tcp_syncookies" kernel parameter, run the following command: sysctl -w net.ipv4.tcp_syncookies=1To make this configuration persistent, add the following line to "/etc/sysctl.conf":net.ipv4.tcp_syncookies = 1and run following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000095','C-46097r2_chk','Check if the system is configured to use TCP syncookies when experiencing a TCP SYN flood, by querying the following command: sysctl net.ipv4.tcp_syncookiesIf the output of the command is not "1", this is a finding.verify the value of net.ipv4.tcp_syncookies in "/etc/sysctl.conf".If net.ipv4.tcp_syncookies is not set to "1" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.3 IPv6
--3.3.1
select add_rule_data ('default','V-56068','SV-50462r1_rule','default','high','The IPv6 Router Advertisements must be disabled.','Router discovery was invented, which provides a means by which a host can locate a router and learn important parameters related to the operation of the local network.Router discovery in IPv6 works in a very similar manner, by having routers send Router Advertisement messages both on a regular basis and in response to hosts prompting for them using Router Solicitation messages.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.3.1 - Red Hat Enterprise. 3.3.1 - CentOS', 'F-56068','Disable the IPv6 router advertisements with the following command: sysctl -w net.ipv6.conf.default.accept_ra=0 sysctl -w net.ipv6.conf.all.accept_ra=0To make the changes persistent, update these parameters in /etc/sysctl.conf file and make sure that it has only single instance.Run the following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the "IPv6" Router Advertisements are disabled, run the following command: sysctl net.ipv6.conf.default.accept_ra sysctl net.ipv6.conf.all.accept_raIf the output of the above commands is not "0", this is a finding.Verify the value of net.ipv6.conf.all.accept_redirects and net.ipv6.conf.default.accept_redirects in "/etc/sysctl.conf".If it"s not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.3.2
select add_rule_data ('default','V-56067','SV-50462r1_rule','default','high','The IPv6 Redirect Acceptance must be disabled.','ICMP redirect messages represent one of the lowest level routing protocols for simple redirects. Routers send them to hosts to inform them about more efficient ways to reach a host rather than route them over themselves.A host will allow this message and will store this "hint" in a temporary table. It will send the next package directly to the host given by the ICMP redirect.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.3.2 - Red Hat Enterprise. 3.3.2 - CentOS', 'F-56067','Disable the IPv6 Redirects Acceptance with the following commands: sysctl -w net.ipv6.conf.all.accept_redirects=0 sysctl -w net.ipv6.conf.default.accept_redirects = 0To make the changes persistent, update these parameters in /etc/sysctl.conf file and make sure that it has only single instance.Run the following command. sysctl -por restart sysctl.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check that the IPv6 Redirects Acceptance is disabled, run the following command:  sysctl net.ipv6.conf.all.accept_redirects  sysctl net.ipv6.conf.default.accept_redirects If the output of the above commands is not "0", this is a finding.Verify the value of net.ipv6.conf.all.accept_redirects and net.ipv6.conf.default.accept_redirects in "/etc/sysctl.conf".If it"s not set to "0" in "/etc/sysctl.conf", this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.3.3
select add_rule_data ('default','V-38546','SV-50347r2_rule','default','medium','The IPv6 protocol handler must not be bound to the network stack unless needed.','Any unnecessary network stacks - including IPv6 - should be disabled, to reduce the vulnerability to exploitation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.3.3 - Red Hat Enterprise. 3.3.3 - CentOS', 'F-43494r2_fix','To disable IPv6 module, add net.ipv6.conf.all.disable_ipv6 = 1 to following file /etc/sysctl.confand run the following command to reload settings from config files without rebooting the system. sysctl --systemTo disable IPv6 module from GRUB, add following line in /etc/default/grub. GRUB_CMDLINE_LINUX="ipv6.disable=1"and run the following command to update the grub. grub2-mkconfig -o /boot/grub2/grub.cfg   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000098','C-46104r2_chk','Check if IPv6 module is enabled or not using the following command : sysctl "net.ipv6.conf" | grep "disable_ipv6 = 0"0 is enabled, 1 is disabled.To verify if IPv6 is disabled in GRUB, run the following: grep -iw "ipv6.disable" /boot/grub2/grub.cfg | grep -v "^\s*"0 is enabled, 1 is disabled.If IPv6 is disabled, this is not applicable.Run the following command to determine if there is connection established on IPv6: ss -6taupn | grep ESTABtcp ESTAB 0 0 fe80::5054:ff:fe3e:21e6%eth0:22 fe80::dacb:8aff:fe28:298e:39604  users:(("sshd",pid=2525,fd=3),("sshd",pid=2523,fd=3))If you get output like above, this rule is not applicable.If ipv6 is enabled and not in use, this is the finding. ','Customized rule by Cloud Raxak') from dual;

--3.4 TCP Wrappers
--3.4.1
select add_rule_data ('default','V-56051','SV-50462r1_rule','default','high','Package tcp_wrappers must be installed.','Using TCP_WRAPPERS makes securing your servers against outside intrusion a lot simpler and painless than you would expect. Deny all hosts by putting ALL: ALL@ALL, PARANOID in the /etc/hosts.deny file and explicitly list trusted hosts who are allowed to your machine in the /etc/hosts.allow file. This is the safest and the best configuration. TCP_WRAPPERS is controlled from two files and the search stops at the first match. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.4.1 - Red Hat Enterprise. 3.4.1 - CentOS', 'F-55014','To install package tcp_wrappers run below commands: apt-get install tcpdIf "/etc/hosts.allow" or "/etc/hosts.deny" file(s) does not exist then run, touch /etc/hosts.allow touch /etc/hosts.deny' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To verify the package: dpkg -s tcpdAfter that check whether /etc/hosts.deny and /etc/hosts.allow are available.If package is not installed, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.4.2
select add_rule_data ('default','C-is342','sv-3.4.2_cis_rule','default','high','Ensure /etc/hosts.allow is configured','The /etc/hosts.allow file specifies which IP addresses are permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.deny file. The /etc/hosts.allow file supports access control by IP and helps ensure that only authorized systems can connect to the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.4.2 - Red Hat Enterprise. 3.4.2 - CentOS', 'F-cis-3.4.2_fix','Run the following command to create /etc/hosts.allow: # echo "ALL: <net>/<mask>, <net>/<mask>, ..." >/etc/hosts.allow where each <net>/<mask> combination (for example, ô192.168.1.0/255.255.255.0??) represents one network block in use by your organization that requires access to this system.','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-3.4.2','CIS-3.4.2_chk', 'Run the following command and verify the contents of the /etc/hosts.allow file: # cat /etc/hosts.allow # cat /etc/hosts.allow' ,'Customized rule by Cloud Raxak') from dual;

--3.4.3
select add_rule_data ('default','C-is343','sv-3.4.3_cis_rule','default','high','Ensure /etc/hosts.deny is configured ','The /etc/hosts.deny file specifies which IP addresses are not permitted to connect to the host. It is intended to be used in conjunction with the /etc/hosts.allow file. The /etc/hosts.deny file serves as a failsafe so that any host not specified in /etc/hosts.allow is denied access to the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.4.3 - Red Hat Enterprise. 3.4.3 - CentOS', 'F-cis-3.4.3_fix','Run the following command to create /etc/hosts.deny: # echo "ALL: ALL" >> /etc/hosts.deny','[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','Linux-CIS-3.4.3','CIS-3.4.3_chk', 'Run the following command and verify the contents of the /etc/hosts.deny file: # cat /etc/hosts.deny ALL: ALL' ,'Customized rule by Cloud Raxak') from dual;

--3.4.4
select add_rule_data ('default','V-56050','SV-50462r1_rule','default','high','The /etc/hosts.allow file must have mode 0644 or less.','/etc/hosts.allow file allows particular hostname from accessing particular daemon. Access of this file other than root can provide access control over untrusted network. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.4.4 - Red Hat Enterprise. 3.4.4 - CentOS', 'F-55014','Change the permission of /etc/hosts.allow  to 644. chmod 644 /etc/hosts.allow' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the permission of "/etc/hosts.allow", run the following command: stat --format=%a /etc/hosts.allowIf properly configured, the permission should be 644 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--3.4.5
select add_rule_data ('default','V-56049','SV-50462r1_rule','default','high','The /etc/hosts.deny file must have mode 0644 or less.','/etc/hosts.deny file denies particular hostname from accessing particular daemon. Access of this file other than root can provide access control over untrusted network. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.4.5 - Red Hat Enterprise. 3.4.5 - CentOS', 'F-55014','Change the permission of /etc/hosts.deny to 644. chmod 644 /etc/hosts.deny' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the permission of "/etc/hosts.deny", run the following command: stat --format=%a /etc/hosts.denyIf properly configured, the permission should be 644 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--3.5 Uncommon Network Protocols
--3.5.1
select add_rule_data ('default','V-38514','SV-50315r3_rule','default','medium','The Datagram Congestion Control Protocol (DCCP) must be disabled unless required.','Disabling DCCP protects the system against exploitation of any flaws in its implementation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.5.1 - Red Hat Enterprise. 3.5.1 - CentOS', 'F-43461r3_fix','The Datagram Congestion Control Protocol (DCCP) is a relatively new transport layer protocol, designed to support streaming media and telephony. To configure the system to prevent the "dccp" kernel module from being loaded, add the following line to a file in the directory "/etc/modprobe.d": (Note: File should have .conf extension.) $ install dccp /bin/trueTo disable the dccp module run following command:$ rmmod dccp   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000124','C-46071r3_chk','If the system is configured to prevent the loading of the "dccp" kernel module, it will contain lines inside any file in "/etc/modprobe.d" or the deprecated "/etc/modprobe.conf". These lines instruct the module loading system to run another program (such as "/bin/true") upon a module "install" event. Run the following command to search for such lines in all files in "/etc/modprobe.d" and the deprecated "/etc/modprobe.conf": $ grep -wr dccp /etc/modprobe.conf /etc/modprobe.d/ | grep -w conf | grep -v ":\s*"If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.5.2
select add_rule_data ('default','V-38515','SV-50316r3_rule','default','medium','The Stream Control Transmission Protocol (SCTP) must be disabled unless required.','Disabling SCTP protects the system against exploitation of any flaws in its implementation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.5.2 - Red Hat Enterprise. 3.5.2 - CentOS', 'F-43462r3_fix','The Stream Control Transmission Protocol (SCTP) is a transport layer protocol, designed to support the idea of message-oriented communication, with several streams of messages within one connection. To configure the system to prevent the "sctp" kernel module from being loaded, add the following line to a file in the directory "/etc/modprobe.d": (Note: File should have .conf extension.) $ install sctp /bin/trueTo disable the sctp module run following command:$ modprobe -r sctp   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000125','C-46072r3_chk','If the system is configured to prevent the loading of the "sctp" kernel module, it will contain lines inside any file in "/etc/modprobe.d" or the deprecated "/etc/modprobe.conf". These lines instruct the module loading system to run another program (such as "/bin/true") upon a module "install" event. Run the following command to search for such lines in all files in "/etc/modprobe.d" and the deprecated "/etc/modprobe.conf": $ grep -wr sctp /etc/modprobe.conf /etc/modprobe.d/ | grep -w conf | grep -v ":\s*"If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.5.3
select add_rule_data ('default','V-38516','SV-50317r3_rule','default','low','The Reliable Datagram Sockets (RDS) protocol must be disabled unless required.','Disabling RDS protects the system against exploitation of any flaws in its implementation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.5.3 - Red Hat Enterprise. 3.5.3 - CentOS', 'F-43463r4_fix','The Reliable Datagram Sockets (RDS) protocol is a transport layer protocol designed to provide reliable high-bandwidth, low-latency communications between nodes in a cluster. To configure the system to prevent the "rds" kernel module from being loaded, add the following line to a file in the directory "/etc/modprobe.d":(Note: File should have .conf extension.) $ install rds /bin/trueTo disable the rds module run following command:$ modprobe -r rds   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000126','C-46073r3_chk','If the system is configured to prevent the loading of the "rds" kernel module, it will contain lines inside any file in "/etc/modprobe.d" or the deprecated "/etc/modprobe.conf". These lines instruct the module loading system to run another program (such as "/bin/true") upon a module "install" event. Run the following command to search for such lines in all files in "/etc/modprobe.d" and the deprecated "/etc/modprobe.conf": $ grep -wr rds /etc/modprobe.conf /etc/modprobe.d/ | grep -w conf | grep -v ":\s*"If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.5.4
select add_rule_data ('default','V-38517','SV-50318r3_rule','default','medium','The Transparent Inter-Process Communication (TIPC) protocol must be disabled unless required.','Disabling TIPC protects the system against exploitation of any flaws in its implementation. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.5.4 - Red Hat Enterprise. 3.5.4 - CentOS', 'F-43464r3_fix','The Transparent Inter-Process Communication (TIPC) protocol is designed to provide communications between nodes in a cluster. To configure the system to prevent the "tipc" kernel module from being loaded, add the following line to a file in the directory "/etc/modprobe.d":(Note: File should have .conf extension.) $ install tipc /bin/true' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000127','C-46074r3_chk','If the system is configured to prevent the loading of the "tipc" kernel module, it will contain lines inside any file in "/etc/modprobe.d" or the deprecated "/etc/modprobe.conf". These lines instruct the module loading system to run another program (such as "/bin/true") upon a module "install" event. Run the following command to search for such lines in all files in "/etc/modprobe.d" and the deprecated "/etc/modprobe.conf": $ grep -wr tipc /etc/modprobe.conf /etc/modprobe.d/ | grep -w conf | grep -v ":\s*"If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.6 Firewall Configuration
--3.6.1
select add_rule_data ('default','V-38555','SV-50356r2_rule','default','medium','The system must employ a local IPv4 firewall.','The "iptables" service provides the system"s host-based firewalling capability for IPv4 and ICMP. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.6.1 - Red Hat Enterprise. 3.6.1 - CentOS', 'F-43503r2_fix','You can install one of following. iptables iptables-services firewalldand configure the same to deny-all packets except coming from CloudRaxak.   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000113','C-46113r2_chk','Run the following command to determine the current status of the Firewall: iptables -LIf above command gives error, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.6.2
select add_rule_data ('default','V-38444','SV-50244r2_rule','default','medium','The systems local IPv6 firewall must implement a deny-all, allow-by-exception policy for inbound packets.','In "ip6tables" the default policy is applied only after all the applicable rules in the table are examined for a match. Setting the default policy to "DROP" implements proper design for a firewall, i.e., any packets which are not explicitly permitted should not be accepted. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.6.2 - Red Hat Enterprise. 3.6.2 - CentOS', 'F-43389r3_fix','Note: Following steps may block you from accessing internet. Hence, make sure you run the commands cautiously.To disable IPv6 module, add net.ipv6.conf.all.disable_ipv6 = 1 to following file /etc/sysctl.confand run the following command to reload settings from config files without rebooting the system. sysctl --systemTo disable IPv6 module from GRUB, add following line in /etc/default/grub. GRUB_CMDLINE_LINUX="ipv6.disable=1"and run the following command to update the grub. grub2-mkconfig -o /boot/grub2/grub.cfgMake sure you added rule to accept connections from CloudRaxak by using following command. ip6tables -A INPUT -m string --hex-string "|0A|cloudraxak|03|net" --algo bm -j ACCEPTTo set default policy to DROP for INPUT chain run following command. ip6tables -P INPUT DROPMake sure all your iptables configuration is persistent.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000523','C-45999r2_chk','Check if IPv6 module is enabled or not using the following command : sysctl "net.ipv6.conf" | grep "disable_ipv6 = 0"0 is enabled, 1 is disabled.To verify if IPv6 is disabled in GRUB, run the following: grep -iw "ipv6.disable" /boot/grub2/grub.cfg | grep -v "^\s*"0 is enabled, 1 is disabled.If IPv6 is disabled, this is not applicable.Run the following command to determine the current status of the Firewall: ip6tables -LMake sure default INPUT policy is set to DROP.Also make sure your iptables configuration is persistent. If the default input policy is not set to DROP, this is a finding.','Customized rule by Cloud Raxak') from dual;

--3.6.3
select add_rule_data ('default','C-30016','SV-3023r1_rule','default','high', 'Ensure loopback traffic is configured', 'Configure the loopback interface to accept traffic. Configure all other interfaces to deny traffic to the loopback network (127.0.0.0/8). Loopback traffic is generated between processes on machine and is typically critical to operation of the system. The loopback interface is the only place that loopback network (127.0.0.0/8) traffic should be seen, all other interfaces should ignore traffic on this network as an anti-spoofing measure. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.6.3 - Red Hat Enterprise. 3.6.3 - CentOS', 'F-30016', 'Run the following commands to implement the loopback rules: cmd# iptables -A INPUT -i lo -j ACCEPT cmd# iptables -A OUTPUT -o lo -j ACCEPT cmd# iptables -A INPUT -s 127.0.0.0/8 -j DROP', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30016', 'Run the following commands and verify output includes the listed rules in order (packet and byte counts may differ): cmd# iptables -L INPUT -v -n cmd# iptables -L OUTPUT -v -n', 'Customized rule by Cloud Raxak') from dual;

--3.6.4
select add_rule_data ('default','C-30017','SV-3024r1_rule','default','high', 'Ensure outbound and established connections are configured', 'Configure the firewall rules for new outbound, and established connections. If rules are not in place for new outbound, and established connections all packets will be dropped by the default policy preventing network usage. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.6.4 - Red Hat Enterprise. 3.6.4 - CentOS', 'F-30017', 'Configure iptables in accordance with site policy. The following commands will implement a policy to allow all outbound connections and all established connections: cmd# iptables -A OUTPUT -p tcp -m state --state NEW,ESTABLISHED -j ACCEPT cmd# iptables -A OUTPUT -p udp -m state --state NEW,ESTABLISHED -j ACCEPT cmd# iptables -A OUTPUT -p icmp -m state --state NEW,ESTABLISHED -j ACCEPT cmd# iptables -A INPUT -p tcp -m state --state ESTABLISHED -j ACCEPT cmd# iptables -A INPUT -p udp -m state --state ESTABLISHED -j ACCEPT cmd# iptables -A INPUT -p icmp -m state --state ESTABLISHED -j ACCEPT', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30017', 'Run the following command and verify all rules for new outbound, and established connections match site policy: # iptables -L -v -n', 'Customized rule by Cloud Raxak') from dual;

--3.6.5
select add_rule_data ('default','C-30018','SV-3025r1_rule','default','high', 'Ensure firewall rules exist for all open ports', 'Any ports that have been opened on non-loopback addresses need firewall rules to govern traffic. Without a firewall rule configured for open ports default firewall policy will drop all packets to these ports. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.6.5 - Red Hat Enterprise. 3.6.5 - CentOS', 'F-30018', 'For each port identified in the audit which does not have a firewall rule establish a proper rule for accepting inbound connections: # iptables -A INPUT -p <protocol> --dport <port> -m state --state NEW -j ACCEPT', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30018', 'Run the following command to determine open ports: # netstat -ln. Run the following command to determine firewall rules: # iptables -L INPUT -v -n', 'Customized rule by Cloud Raxak') from dual;

--3.7
select add_rule_data ('default','C-30019','SV-3026r1_rule','default','high', 'Ensure wireless interfaces are disabled', 'Wireless networking is used when wired networks are unavailable. Red Hat Enterprise Linux 7 contains a wireless tool kit to allow system administrators to configure and use wireless networks. If wireless is not to be used, wireless devices can be disabled to reduce the potential attack surface Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 3.7 - Red Hat Enterprise. 3.7 - CentOS', 'F-30019', 'Run the following command to disable any wireless interfaces: # ip link set <interface> down. Disable any wireless interfaces in your network configuration', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30019', 'Run the following command to determine wireless interfaces on the system: cmd# iwconfig. Run the following command and verify wireless interfaces are active: cmd# ip link show up', 'Customized rule by Cloud Raxak') from dual;

--4 Logging and Auditing
--4.1 Configure System Accounting (auditd)
--4.1.1 Configure Data Retention
--4.1.1.1
select add_rule_data ('default','V-38633','SV-50434r1_rule','default','medium','The system must set a maximum audit log file size.','The total storage for audit log files must be large enough to retain log information over the period required. This is a function of the maximum log file size and the number of logs retained. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.1.1 - Red Hat Enterprise. 4.1.1.1 - CentOS', 'F-43582r1_fix','Determine the amount of audit data (in megabytes) which should be retained in each log file. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting the correct value for []: max_log_file = [STOREMB]Set the value to "6" (MB) or higher for general-purpose systems. Larger values, of course, support retention of even more audit data.If auditd package is not installed then rule will install it before fixing changes.Reload the auditd.$ service auditd reload' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000160','C-46192r1_chk','Inspect "/etc/audit/auditd.conf" and locate the following line to determine how much data the system will retain in each audit log file:  grep -wi max_log_file /etc/audit/auditd.conf | grep -v "^" max_log_file = 6If the system audit data threshold hasn"t been properly set up, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.1.2
select add_rule_data ('default','V-54381','SV-68627r1_rule','default','medium','The audit system must switch the system to single-user mode when available audit storage volume becomes dangerously low.','Administrators should be made aware of an inability to record audit records. If a separate partition or logical volume of adequate size is used, running low on space for audit records should never occur.  Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.1.2 - Red Hat Enterprise. 4.1.1.2 - CentOS', 'F-59235r2_fix','The "auditd" service can be configured to take an action when disk space is running low but prior to running out of space completely. Edit the file "/etc/audit/auditd.conf". Add or modify the following line, substituting [] appropriately:admin_space_left_action = [ACTION]Set this value to "single" to cause the system to switch to single-user mode for corrective action. Acceptable values also include "suspend" and "halt". For certain systems, the need for availability outweighs the need to log all actions, and a different setting should be determined. Details regarding all possible values for [ACTION] are described in the "auditd.conf" man page. ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000163','C-54997r2_chk','Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to either suspend, switch to single-user mode, or halt when disk space has run low:admin_space_left_action singleIf the system is not configured to switch to single-user mode for corrective action, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38470','SV-50270r2_rule','default','medium','The audit system must alert designated staff members when the audit storage volume approaches capacity.','Notifying administrators of an impending disk space problem may allow them to take corrective action prior to any disruption. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.1.2 - Red Hat Enterprise. 4.1.1.2 - CentOS', 'F-43415r2_fix','The "auditd" service can be configured to take an action when disk space starts to run low. Edit the file "/etc/audit/auditd.conf". Modify the following line, substituting [] appropriately: space_left_action = [ACTION]Possible values for [ACTION] are described in the "auditd.conf" man page. These include: "ignore""syslog""email""exec""suspend""single""halt"Set this to "email" (instead of the default, which is "suspend") as it is more likely to get prompt attention.  The "syslog" option is acceptable, provided the local log management infrastructure notifies an appropriate administrator in a timely manner.RHEL-06-000521 ensures that the email generated through the operation "space_left_action" will be sent to an administrator.If auditd package is not installed then rule will install it before fixing changes.Reload the auditd.$ service auditd reload' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000005','C-46025r3_chk','Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to email the administrator when disk space is starting to run low:  grep -wi space_left_action /etc/audit/auditd.conf | grep -v "^"space_left_action = emailIf the system is not configured to send an email to the system administrator when disk space is starting to run low, this is a finding.  The "syslog" option is acceptable when it can be demonstrated that the local log management infrastructure notifies an appropriate administrator in a timely manner.','Customized rule by Cloud Raxak') from dual;

--4.1.1.3
select add_rule_data ('default','V-38634','SV-50435r2_rule','default','medium','The system must rotate audit log files that reach the maximum file size.','Automatically rotating logs (by setting this to "rotate") minimizes the chances of the system unexpectedly running out of disk space by being overwhelmed with log data. However, for systems that must never discard log data, or which use external processes to transfer it and reclaim space, "keep_logs" can be employed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.1.3 - Red Hat Enterprise. 4.1.1.3 - CentOS', 'F-43583r1_fix','The default action to take when the logs reach their maximum size is to rotate the log files, discarding the oldest one. To configure the action taken by "auditd", add or correct the line in "/etc/audit/auditd.conf": max_log_file_action = []Possible values for [ACTION] are described in the "auditd.conf" man page. These include: "ignore""syslog""suspend""rotate""keep_logs"Set the "[ACTION]" to "rotate" to ensure log rotation occurs. This is the default. The setting is case-insensitive.If auditd package is not installed then rule will install it before fixing changes.Reload the auditd.$ service auditd reload' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000161','C-46193r3_chk','Inspect "/etc/audit/auditd.conf" and locate the following line to determine if the system is configured to rotate logs when they reach their maximum size: grep -wi max_log_file_action /etc/audit/auditd.conf | grep -v "^"max_log_file_action = rotateIf the "keep_logs" option is configured for the "max_log_file_action" line in "/etc/audit/auditd.conf" and an alternate process is in place to ensure audit data does not overwhelm local audit storage, this is not a finding.If the system has not been properly set up to rotate audit logs, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.2 and 4.1.3
select add_rule_data ('default','V-38438','SV-50238r2_rule','default','low','Auditing must be enabled at boot by setting a kernel parameter.','Each process on the system carries an "auditable" flag which indicates whether its activities can be audited. Although "auditd" takes care of enabling this for all processes which launch after it does, adding the kernel argument ensures it is set for every process during boot. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.2 and 4.1.3 - Red Hat Enterprise. 4.1.2 and 4.1.3 - CentOS', 'F-43382r2_fix','To ensure all processes can be audited, even those which start prior to the audit daemon, add the argument "audit=1" to the kernel line in "/etc/default/grub", in the manner below:GRUB_CMDLINE_LINUX="audit=1"and run the following command to update the grub. update-grubUEFI systems may prepend "/boot" to the "/vmlinuz-version" argument.If auditd package is not installed then rule will install it before fixing changes.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000525','C-45992r2_chk','Inspect the kernel boot arguments (which follow the word "GRUB_CMDLINE_LINUX") in "/etc/default/grub". If they include "audit=1", then auditing is enabled at boot time. If auditing is not enabled at boot time, this is a finding.If auditd package is not installed then rule will install it before fixing changes.','Customized rule by Cloud Raxak') from dual;

--4.1.4
select add_rule_data ('default','V-38522','SV-50323r3_rule','default','low','The audit system must be configured to audit all attempts to alter system time through settimeofday.','Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.4 - Red Hat Enterprise. 4.1.4 - CentOS', 'F-43470r2_fix','If auditd service is not installed or auditd service not running, then rule will install and start the auditd service before fixing changes in /etc/audit/audit.rules file. On a 32-bit system, add the following to "/etc/audit/audit.rules":  audit_time_rules -a always,exit -F arch=b32 -S settimeofday -S adjtimex -S stime -k audit_time_rules. On a 64-bit system, add the following to "/etc/audit/audit.rules":  audit_time_rules-a always,exit -F arch=b64 -S settimeofday -S adjtimex -k audit_time_rules. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rulesNow, to get recently added audit rules into effect run the following command:  auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000167','C-46080r2_chk','If auditd service is not installed or auditd service not running, then rule get failed.To determine if the system is configured to audit calls to the "settimeofday" system call, run the following command:$ sudo grep -w "settimeofday" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. If the system is not configured to audit time changes, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38527','SV-50328r3_rule','default','low','The audit system must be configured to audit all attempts to alter system time through clock_settime.','Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.4 - Red Hat Enterprise. 4.1.4 - CentOS', 'F-43475r2_fix','If auditd service is not installed or auditd service not running, then rule will install and start the auditd service before fixing changes in /etc/audit/audit.rules file. On a 32-bit system, add the following to "/etc/audit/audit.rules":  audit_time_rules -a always,exit -F arch=b32 -S clock_settime -k audit_time_rules. On a 64-bit system, add the following to "/etc/audit/audit.rules":  audit_time_rules-a always,exit -F arch=b64 -S clock_settime -k audit_time_rules. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport. Multiple system calls can be defined on the same line to save space if desired, but is not required. See an example of multiple combined syscalls: -a always,exit -F arch=b64 -S adjtimex -S settimeofday -S clock_settime -k audit_time_rulesNow, to get recently added audit rules into effect run the following command:  auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000171','C-46085r2_chk','If auditd service is not installed or auditd service not running, then rule get failed.To determine if the system is configured to audit calls to the "clock_settime" system call, run the following command:$ sudo grep -w "clock_settime" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. If the system is not configured to audit time changes, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38530','SV-50331r1_rule','default','low','The audit system must be configured to audit all attempts to alter system time through /etc/localtime.','Arbitrary changes to the system time can be used to obfuscate nefarious activities in log files, as well as to confuse network services that are highly dependent upon an accurate system time (such as sshd). All changes to the system time should be audited. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.4 - Red Hat Enterprise. 4.1.4 - CentOS', 'F-43477r1_fix','Add the following to "/etc/audit/audit.rules": -w /etc/localtime -p wa -k audit_time_rules. The -k option allows for the specification of a key in string form that can be used for better reporting capability through ausearch and aureport and should always be used.Now, to get recently added audit rules into effect run the following command:  auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000173','C-46087r1_chk','To determine if the system is configured to audit attempts to alter time via the /etc/localtime file, run the following command:  auditctl -l | grep "watch=/etc/localtime"If the system is configured to audit this activity, it will return a line. If the system is not configured to audit time changes, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.5
select add_rule_data ('default','V-38531','SV-50332r1_rule','default','low','The operating system must automatically audit account creation.','In addition to auditing new user and group accounts, these watches will alert the system administrator(s) to any modifications. Any unexpected users, groups, or modifications should be investigated for legitimacy. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.5 - Red Hat Enterprise. 4.1.5 - CentOS', 'F-43480r1_fix','Add the following to "/etc/audit/audit.rules", in order to capture events that modify account changes:  audit_account_changes-w /etc/group -p wa -k audit_account_changes-w /etc/passwd -p wa -k audit_account_changes-w /etc/gshadow -p wa -k audit_account_changes-w /etc/shadow -p wa -k audit_account_changes-w /etc/security/opasswd -p wa -k audit_account_changesNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000174','C-46090r1_chk','To determine if the system is configured to audit account changes, run the following command: auditctl -l | egrep "(/etc/passwd|/etc/shadow|/etc/group|/etc/gshadow|/etc/security/opasswd)"If the system is configured to watch for account changes, lines should be returned for each file specified (and with "perm=wa" for each). If the system is not configured to audit account changes, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.6
select add_rule_data ('default','V-38540','SV-50341r2_rule','default','low','The audit system must be configured to audit modifications to the systems network configuration.','The network environment should not be modified by anything other than administrator action. Any change to network parameters should be audited. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.6 - Red Hat Enterprise. 4.1.6 - CentOS', 'F-43488r2_fix','Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system:  audit_network_modifications
-a always,exit -F arch=ARCH -S sethostname -S setdomainname -k audit_network_modifications
-w /etc/issue -p wa -k audit_network_modifications
-w /etc/issue.net -p wa -k audit_network_modifications
-w /etc/hosts -p wa -k audit_network_modifications
-w /etc/sysconfig/network -p wa -k audit_network_modifications
-w /etc/sysconfig/network-scripts/ -p wa -k system-locale.
Now, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000182','C-46098r1_chk','To determine if the system is configured to audit changes to its network configuration, run the following command: auditctl -l | egrep "(sethostname|setdomainname|/etc/issue|/etc/issue.net|/etc/hosts|/etc/sysconfig/network)"If the system is configured to watch for network configuration changes, a line should be returned for each file specified (and "perm=wa" should be indicated for each). If the system is not configured to audit changes of the network configuration, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.7
select add_rule_data ('default','V-38541','SV-50342r1_rule','default','low','The audit system must be configured to audit modifications to the systems Mandatory Access Control (MAC) configuration (apparmor).',
'The system"s mandatory access policy (SELinux) should not be arbitrarily changed by anything other than administrator action. 
All changes to MAC policy should be audited. 
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.7 - Red Hat Enterprise. 4.1.7 - CentOS', 
'F-43489r1_fix','Add the following to "/etc/audit/audit.rules":
-w /etc/apparmor/ -p wa -k MAC-policy
-w /usr/share/selinux/ -p wa -k MAC-policy
Now, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000183','C-46099r1_chk','To determine if the system is configured to audit changes to its MAC configuration files, run the following command: grep -w "/etc/apparmor" /etc/audit/audit.rulesIf the system is configured to watch for changes to its MAC configuration, a line should be returned (including "perm=wa" indicating permissions that are watched).If the system is not configured to audit attempts to change the MAC policy, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.8
select add_rule_data ('default','C-30020','SV-3027r1_rule','default','high', 'Ensure login and logout events are collected', 'Monitor login and logout events. The parameters below track changes to files associated with login/logout events. The file /var/log/lastlog maintain records of the last time a user successfully logged in. The /var/run/failock directory maintains records of login failures via the pam_faillock module. Monitoring login/logout events could provide a system administrator with information associated with brute force attacks against user logins. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.8 - Red Hat Enterprise. 4.1.8 - CentOS', 'F-30020', 'Add the following lines to the /etc/audit/audit.rules file: -w /var/log/lastlog -p wa -k logins -w /var/run/faillock/ -p wa -k logins', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30020', 'Run the following command and verify output matches: cmd# grep logins /etc/audit/audit.rules output# -w /var/log/lastlog -p wa -k logins -w /var/run/faillock/ -p wa -k logins', 'Customized rule by Cloud Raxak') from dual;

--4.1.9
select add_rule_data ('default','C-30021','SV-3028r1_rule','default','high', 'Ensure session initiation information is collected', 'Monitor session initiation events. The parameters in this section track changes to the files associated with session events. The file /var/run/utmp file tracks all currently logged in users. All audit records will be tagged with the identifier "session." The /var/log/wtmp file tracks logins, logouts, shutdown, and reboot events. The file /var/log/btmp keeps track of failed login attempts and can be read by entering the command /usr/bin/last -f /var/log/btmp . All audit records will be tagged with the identifier "logins." Monitoring these files for changes could alert a system administrator to logins occurring at unusual hours, which could indicate intruder activity (i.e. a user logging in at a time when they do not normally log in). Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.9 - Red Hat Enterprise. 4.1.9 - CentOS', 'F-30021', 'Add the following lines to the /etc/audit/audit.rules file: -w /var/run/utmp -p wa -k session -w /var/log/wtmp -p wa -k logins -w /var/log/btmp -p wa -k logins', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30021', 'Run the following commands: cmd# grep session /etc/audit/audit.rules cmd# auditctl -l | grep session. Verify output of both matches: output# -w /var/run/utmp -p wa -k session. Run the following commands: cmd# grep logins /etc/audit/audit.rules cmd# auditctl -l | grep logins Verify output of both matches: output# -w /var/log/wtmp -p wa -k logins -w /var/log/btmp -p wa -k logins', 'Customized rule by Cloud Raxak') from dual;

--4.1.10
select add_rule_data ('default','V-38543','SV-50344r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using chmod.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43491r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S chmod -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S chmod -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S chmod -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S chmod -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000184','C-46101r2_chk','To determine if the system is configured to audit calls to the "chmod" system call, run the following command:$ sudo grep -w "chmod" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If the system is not configured to audit permission changes, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38547','SV-50348r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fchmod.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43495r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fchmod -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fchmod -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fchmod -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fchmod -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000186','C-46105r2_chk','To determine if the system is configured to audit calls to the "fchmod" system call, run the following command:$ sudo grep -w "fchmod" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38550','SV-50351r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fchmodat.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43498r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fchmodat -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fchmodat -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fchmodat -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fchmodat -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000187','C-46108r2_chk','To determine if the system is configured to audit calls to the "fchmodat" system call, run the following command:$ sudo grep -w "fchmodat" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38545','SV-50346r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using chown.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43493r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S chown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S chown -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S chown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S chown -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000185','C-46103r2_chk','To determine if the system is configured to audit calls to the "chown" system call, run the following command:$ sudo grep -w "chown" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines.If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38552','SV-50353r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fchown.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43500r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fchown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fchown -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fchown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fchown -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000188','C-46110r2_chk','To determine if the system is configured to audit calls to the "fchown" system call, run the following command:$ sudo grep -w "fchown" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38554','SV-50355r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fchownat.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43502r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fchownat -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fchownat -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fchownat -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fchownat -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000189','C-46112r2_chk','To determine if the system is configured to audit calls to the "fchownat" system call, run the following command:$ sudo grep -w "fchownat" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38558','SV-50359r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using lchown.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43506r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S lchown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S lchown -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S lchown -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S lchown -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000192','C-46116r2_chk','To determine if the system is configured to audit calls to the "lchown" system call, run the following command:$ sudo grep -w "lchown" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38561','SV-50362r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using lsetxattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43509r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S lsetxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S lsetxattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S lsetxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S lsetxattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000194','C-46119r2_chk','To determine if the system is configured to audit calls to the "lsetxattr" system call, run the following command:$ sudo grep -w "lsetxattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38557','SV-50358r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fsetxattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43505r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fsetxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fsetxattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fsetxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fsetxattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000191','C-46115r2_chk','To determine if the system is configured to audit calls to the "fsetxattr" system call, run the following command:$ sudo grep -w "fsetxattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38565','SV-50366r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using setxattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43513r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S setxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S setxattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S setxattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S setxattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000196','C-46123r2_chk','To determine if the system is configured to audit calls to the "setxattr" system call, run the following command:$ sudo grep -w "setxattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38556','SV-50357r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using fremovexattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43504r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S fremovexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S fremovexattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S fremovexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S fremovexattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000190','C-46114r2_chk','To determine if the system is configured to audit calls to the "fremovexattr" system call, run the following command:$ sudo grep -w "fremovexattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38559','SV-50360r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using lremovexattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43507r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S lremovexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S lremovexattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S lremovexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S lremovexattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000193','C-46117r2_chk','To determine if the system is configured to audit calls to the "lremovexattr" system call, run the following command:$ sudo grep -w "lremovexattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38563','SV-50364r3_rule','default','low','The audit system must be configured to audit all discretionary access control permission modifications using removexattr.','The changing of file permissions could indicate that a user is attempting to gain access to information that would otherwise be disallowed. Auditing DAC modifications can facilitate the identification of patterns of abuse among both authorized and unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.10 - Red Hat Enterprise. 4.1.10 - CentOS', 'F-43511r2_fix','At a minimum, the audit system should collect file permission changes for all users and root. Add the following to "/etc/audit/audit.rules": -a always,exit -F arch=b32 -S removexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b32 -S removexattr -F auid=0 -k perm_modIf the system is 64-bit, then also add the following: -a always,exit -F arch=b64 -S removexattr -F auid>=500 -F auid!=4294967295 \-k perm_mod-a always,exit -F arch=b64 -S removexattr -F auid=0 -k perm_modNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000195','C-46121r2_chk','To determine if the system is configured to audit calls to the "removexattr" system call, run the following command:$ sudo grep -w "removexattr" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.11
select add_rule_data ('default','V-38566','SV-50367r2_rule','default','low','The audit system must be configured to audit failed attempts to access files and programs.','Unsuccessful attempts to access files could be an indicator of malicious activity on a system. Auditing these events could serve as evidence of potential system compromise. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.11 - Red Hat Enterprise. 4.1.11 - CentOS', 'F-43514r2_fix','At a minimum, the audit system should collect unauthorized file accesses for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system: -a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \-S ftruncate -F exit=-EACCES -F auid>=500 -F auid!=4294967295 -k access-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \-S ftruncate -F exit=-EPERM -F auid>=500 -F auid!=4294967295 -k access-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \-S ftruncate -F exit=-EACCES -F auid=0 -k access-a always,exit -F arch=ARCH -S creat -S open -S openat -S truncate \-S ftruncate -F exit=-EPERM -F auid=0 -k accessNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000197','C-46124r1_chk','To verify that the audit system collects unauthorized file accesses, run the following commands:  grep EACCES /etc/audit/audit.rules grep EPERM /etc/audit/audit.rulesIf either command lacks output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.12
select add_rule_data ('default','V-38567','SV-50368r4_rule','default','low','The audit system must be configured to audit all use of setuid and setgid programs.','Privileged programs are subject to escalation-of-privilege attacks, which attempt to subvert their normal role of providing some necessary but limited capability. As such, motivation exists to monitor these programs for unusual activity. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.12 - Red Hat Enterprise. 4.1.12 - CentOS', 'F-43515r6_fix','At a minimum, the audit system should collect the execution of privileged commands for all users and root. To find the relevant setuid / setgid programs, run the following command for each local partition []:$ sudo find [PART] -xdev -type f -perm /6000 2>/dev/nullThen, for each setuid / setgid program on the system, add a line of the following form to "/etc/audit/audit.rules", where [SETUID_PROG_PATH] is the full path to each setuid / setgid program in the list:-a always,exit -F path=[SETUID_PROG_PATH] -F perm=x -F auid>=500 -F auid!=4294967295 -k privilegedNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000198','C-46125r7_chk','To verify that auditing of privileged command use is configured, run the following command once for each local partition [] to find relevant setuid / setgid programs:$ sudo find [PART] -xdev -type f -perm /6000 2>/dev/nullRun the following command to verify entries in the audit rules for all programs found with the previous command:$ sudo grep path /etc/audit/audit.rulesIt should be the case that all relevant setuid / setgid programs have a line in the audit rules. If that is not the case, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--4.1.13
select add_rule_data ('default','V-38568','SV-50369r3_rule','default','low','The audit system must be configured to audit successful file system mounts.','The unauthorized exportation of data to external media could result in an information leak where classified information, Privacy Act information, and intellectual property could be lost. An audit trail should be created each time a filesystem is mounted to help identify and guard against information loss. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.13 - Red Hat Enterprise. 4.1.13 - CentOS', 'F-43516r2_fix','At a minimum, the audit system should collect media exportation events for all users and root. Add the following to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system: -a always,exit -F arch=ARCH -S mount -F auid>=500 -F auid!=4294967295 -k export-a always,exit -F arch=ARCH -S mount -F auid=0 -k exportNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000199','C-46126r2_chk','To verify that auditing is configured for all media exportation events, run the following command: $ sudo grep -w "mount" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return several lines. If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--4.1.14
select add_rule_data ('default','V-38575','SV-50376r4_rule','default','low','The audit system must be configured to audit user deletions of files and programs.','Auditing file deletions will create an audit trail for files that are removed from the system. The audit trail could aid in system troubleshooting, as well as detecting malicious processes that attempt to delete log files to conceal their presence. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.14 - Red Hat Enterprise. 4.1.14 - CentOS', 'F-43523r4_fix','At a minimum, the audit system should collect file deletion events for all users and root. Add the following (or equivalent) to "/etc/audit/audit.rules", setting ARCH to either b32 or b64 as appropriate for your system: -a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid>=500 -F auid!=4294967295 -k delete-a always,exit -F arch=ARCH -S rmdir -S unlink -S unlinkat -S rename -S renameat -F auid=0 -k deleteNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000200','C-46133r3_chk','To determine if the system is configured to audit calls to the "rmdir" system call, run the following command:$ sudo grep -w "rmdir" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlink" system call, run the following command:$ sudo grep -w "unlink" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "unlinkat" system call, run the following command:$ sudo grep -w "unlinkat" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "rename" system call, run the following command:$ sudo grep -w "rename" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "renameat" system call, run the following command:$ sudo grep -w "renameat" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line.If no line is returned, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--4.1.15
select add_rule_data ('default','V-38578','SV-50379r1_rule','default','low','The audit system must be configured to audit changes to the /etc/sudoers file.',
'The actions taken by system administrators should be audited to keep a record of what was executed on the system, as well as, for accountability purposes. 
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.15 - Red Hat Enterprise. 4.1.15 - CentOS', 
'F-43526r1_fix','At a minimum, the audit system should collect administrator actions for all users and root. 
Add the following to "/etc/audit/audit.rules": 
-w /etc/sudoers -p wa -k actions
-w /etc/sudoers.d/ -p wa -k scope.
Now, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules', 
'[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000201','C-46136r1_chk','To verify that auditing is configured for system administrator actions, run the following command:  auditctl -l | grep "watch=/etc/sudoers"If there is no output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.1.16
select add_rule_data ('default','C-30022','SV-3029r1_rule','default','high', 'Ensure system administrator actions (sudolog) are collected', 'Monitor the sudo log file. If the system has been properly configured to disable the use of the su command and force all administrators to have to log in first and then use sudo to execute privileged commands, then all administrator commands will be logged to /var/log/sudo.log . Any time a command is executed, an audit event will be triggered as the /var/log/sudo.log file will be opened for write and the executed administration command will be written to the log. Changes in /var/log/sudo.log indicate that an administrator has executed a command or the log file itself has been tampered with. Administrators will want to correlate the events written to the audit trail with the records written to /var/log/sudo.log to verify if unauthorized commands have been executed. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.16 - Red Hat Enterprise. 4.1.16 - CentOS', 'F-30022', 'Add the following lines to the /etc/audit/audit.rules file: -w /var/log/sudo.log -p wa -k actions', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30022', 'Run the following commands: cmd# grep actions /etc/audit/audit.rules cmd# auditctl -l | grep actions. Verify output of both matches: -w /var/log/sudo.log -p wa -k actions', 'Customized rule by Cloud Raxak') from dual;

--4.1.17
select add_rule_data ('default','V-38580','SV-50381r2_rule','default','medium','The audit system must be configured to audit the loading and unloading of dynamic kernel modules.','The addition/removal of kernel modules can be used to alter the behavior of the kernel and potentially introduce malicious code into kernel space. It is important to have an audit trail of modules that have been introduced into the kernel. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.17 - Red Hat Enterprise. 4.1.17 - CentOS', 'F-43528r2_fix','Add the following to "/etc/audit/audit.rules" in order to capture kernel module loading and unloading events, setting ARCH to either b32 or b64 as appropriate for your system: -w /sbin/insmod -p x -k modules-w /sbin/rmmod -p x -k modules-w /sbin/modprobe -p x -k modules-a always,exit -F arch=[] -S init_module -S delete_module -k modulesNow, to get recently added audit rules into effect run the following command: auditctl -R /etc/audit/audit.rules   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000202','C-46138r3_chk','To determine if the system is configured to audit execution of module management programs, run the following commands:$ sudo egrep -e "(-w |-F path=)/sbin/insmod" /etc/audit/audit.rules$ sudo egrep -e "(-w |-F path=)/sbin/rmmod" /etc/audit/audit.rules$ sudo egrep -e "(-w |-F path=)/sbin/modprobe" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line.To determine if the system is configured to audit calls to the "init_module" system call, run the following command:$ sudo grep -w "init_module" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. To determine if the system is configured to audit calls to the "delete_module" system call, run the following command:$ sudo grep -w "delete_module" /etc/audit/audit.rulesIf the system is configured to audit this activity, it will return a line. If no line is returned for any of these commands, this is a finding. ','Customized rule by Cloud Raxak') from dual;

--4.1.18
select add_rule_data ('default','C-30023','SV-3030r1_rule','default','high', 'Ensure the audit configuration is immutable', 'Set system audit so that audit rules cannot be modified with auditctl . Setting the flag "-e 2" forces audit to be put in immutable mode. Audit changes can only be made on system reboot. In immutable mode, unauthorized users cannot execute changes to the audit system to potentially hide malicious activity and then put the audit rules back. Users would most likely notice a system reboot and that could alert administrators of an attempt to make unauthorized audit changes. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.1.18 - Red Hat Enterprise. 4.1.18 - CentOS', 'F-30030', 'Add the following line to the end of the /etc/audit/audit.rules file. -e 2', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30030', 'Run the following command and verify output matches: cmd# grep "^\s*[^#]" /etc/audit/audit.rules | tail -1 output# -e 2', 'Customized rule by Cloud Raxak') from dual;

--4.2 Configure Logging
--4.2.1 Configure rsyslog
--4.2.1.1
select add_rule_data ('default','V-56062','SV-50462r1_rule','default','high','The rsyslog daemon must be running.','RSYSLOG is the rocket-fast system for log processing.It offers high-performance, great security features and a modular design. While it started as a regular syslogd, rsyslog has evolved into a kind of swiss army knife of logging, being able to accept inputs from a wide variety of sources, transform them, and output to the results to diverse destinations.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.1.1 - Red Hat Enterprise. 4.2.1.1 - CentOS', 'F-56062','The "rsyslog" service can be enabled with the following commands: chkconfig rsyslog on service rsyslog start' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Run the following command to verify "rsyslog" is enabled through current runtime configuration: service rsyslog statusIf the service is rsyslog the command will return the following output:rsyslog is running.To check that the "rsyslog" service is enabled in system boot configuration, run the following command: chkconfig rsyslog --listOutput should indicate the "rsyslog" service has been enabled at default and current runlevels or at all runelvel, as shown in the example below: chkconfig "rsyslog" --list"rsyslog" 0:on 1:on 2:on 3:on 4:on 5:on 6:on S:onIf the service is not running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.2.1.2
--select add_rule_data ('default','C-30024','SV-3031r1_rule','default','high', 'Ensure logging is configured', 'The /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files specifies rules for logging and which files are to be used to log certain classes of messages. A great deal of important security-related information is sent via rsyslog (e.g., successful and failed su attempts, failed login attempts, root login attempts, etc.). Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.1.2 - Red Hat Enterprise. 4.2.1.2 - CentOS', 'F-30024', 'Edit the following lines in the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files as appropriate for your environment: *.emerg :omusrmsg:* mail.* -/var/log/mail mail.info -/var/log/mail.info mail.warning -/var/log/mail.warn mail.err /var/log/mail.err news.crit -/var/log/news/news.crit news.err -/var/log/news/news.err news.notice -/var/log/news/news.notice *.=warning;*.=err -/var/log/warn *.crit /var/log/warn *.*;mail.none;news.none -/var/log/messages local0,local1.* -/var/log/localmessages local2,local3.* -/var/log/localmessages local4,local5.* -/var/log/localmessages local6,local7.* -/var/log/localmessages. Run the following command to reload the rsyslogd configuration: cmd# pkill -HUP rsyslogd', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30024', 'Review the contents of the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files to ensure appropriate logging is set. In addition, run the following command and verify that the log files are logging information: # ls -l /var/log/', 'Customized rule by Cloud Raxak') from dual;

--4.2.1.3
--select add_rule_data ('default','C-30025','SV-3032r1_rule','default','high', 'Ensure rsyslog default file permissions configured', 'rsyslog will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files. It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.1.3 - Red Hat Enterprise. 4.2.1.3 - CentOS', 'F-30025', 'Edit the /etc/rsyslog.conf and /etc/rsyslog.d/*.conf files and set $FileCreateMode to 0640 or more restrictive: $FileCreateMode 0640', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30025', 'Run the following command and verify that $FileCreateMode is 0640 or more restrictive: # grep ^\$FileCreateMode /etc/rsyslog.conf /etc/rsyslog.d/*.conf', 'Customized rule by Cloud Raxak') from dual;

--4.2.1.4
select add_rule_data ('default','V-56048','SV-50462r1_rule','default','high','System must be configured to send logs to a Remote Log Host.','A log server (loghost) receives syslog messages from one or more systems. This data can be used as an additional log source in the event a system is compromised and its local logs are suspect. Forwarding log messages to a remote loghost also provides system administrators with a centralized place to view the status of multiple hosts within the enterprise. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.1.4 - Red Hat Enterprise. 4.2.1.4 - CentOS', 'F-55014','To configure rsyslog to send logs to a remote log server, open "/etc/rsyslog.conf" and read and understand the last section of the file, which describes the multiple directives necessary to activate remote logging. Along with these other directives, the system can be configured to forward its logs to a particular log server by adding or correcting one of the following lines, substituting "[]" appropriately. The choice of protocol depends on the environment of the system; although TCP and RELP provide more reliable message delivery, they may not be supported in all environments.To use UDP for log message delivery:*.* @[loghost.example.com]To use TCP for log message delivery:*.* @@[loghost.example.com]To use RELP for log message delivery:*.* :omrelp:[loghost.example.com]If the rsyslog version being used is lower than 6 add the following text in /etc/sysconfig/rsyslogSYSLOGD_OPTIONS="-c 5 -r"' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To ensure logs are sent to a remote host, examine the file "/etc/rsyslog.conf". If using UDP, a line similar to the following should be present:*.* @[]If using TCP, a line similar to the following should be present:*.* @@[loghost.example.com]If using RELP, a line similar to the following should be present:*.* :omrelp:[loghost.example.com]If none of these are present, this is a finding.If the rsyslog version being used is lower than 6.the syslog options have to be checked. grep -w SYSLOGD_OPTIONS /etc/sysconfig/rsyslog | grep -v "^"If the option "-r" is not found in the result, this is a finding.The "-r" option enables the system to forward logs to remote hosts.','Customized rule by Cloud Raxak') from dual;

--4.2.1.5
--select add_rule_data ('default','C-30026','SV-3033r1_rule','default','high', 'Ensure remote rsyslog messages are only accepted on designated log hosts.', 'By default, rsyslog does not listen for log messages coming in from remote systems. The ModLoad tells rsyslog to load the imtcp.so module so it can listen over a network via TCP. The InputTCPServerRun option instructs rsyslogd to listen on the specified TCP port. The guidance in the section ensures that remote log hosts are configured to only accept rsyslog data from hosts within the specified domain and that those systems that are not designed to be log hosts do not accept any remote rsyslog messages. This provides protection from spoofed log data and ensures that system administrators are reviewing reasonably complete syslog data in a central location. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.1.5 - Red Hat Enterprise. 4.2.1.5 - CentOS', 'F-30026', 'For hosts that are designated as log hosts, edit the /etc/rsyslog.conf file and uncomment or add the following lines: $ModLoad imtcp $InputTCPServerRun 514. For hosts that are not designated as log hosts, edit the /etc/rsyslog.conf file and comment or remove the following lines  # $ModLoad imtcp # $InputTCPServerRun 514 Run the following command to reload the rsyslogd configuration: cmd# pkill -HUP rsyslogd', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30026', 'Run the following commands and verify the resulting lines are uncommented on designated log hosts and commented or removed on all others: cmd# grep "$ModLoad imtcp" /etc/rsyslog.conf /etc/rsyslog.d/*.conf output#$ModLoad imtcp cmd# grep $InputTCPServerRun /etc/rsyslog.conf /etc/rsyslog.d/*.conf output#$InputTCPServerRun 514', 'Customized rule by Cloud Raxak') from dual;

--4.2.2 Configure syslog-ng
--4.2.2.1
--select add_rule_data ('default','C-30027','SV-3034r1_rule','default','high', 'Ensure syslog-ng service is enabled', 'Once the syslog-ng package is installed it needs to be activated. If the syslog-ng service is not activated the system may default to the syslogd service or lack logging instead. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.2.1 - Red Hat Enterprise. 4.2.2.1 - CentOS', 'F-30027', 'Run the following command to enable syslog-ng : # systemctl enable syslog-ng', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30027', 'Run the following command and verify result is "enabled": cmd# systemctl is-enabled syslog-ng output# enabled', 'Customized rule by Cloud Raxak') from dual;

--4.2.2.2
--select add_rule_data ('default','C-30028','SV-3035r1_rule','default','high', 'Ensure logging is configured', 'The /etc/syslog-ng/syslog-ng.conf file specifies rules for logging and which files are to be used to log certain classes of messages. A great deal of important security-related information is sent via syslog-ng (e.g., successful and failed su attempts, failed login attempts, root login attempts, etc.). Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.2.2 - Red Hat Enterprise. 4.2.2.2 - CentOS', 'F-30028', 'Edit the log lines in the /etc/syslog-ng/syslog-ng.conf file as appropriate for your environment. Run the following command to reload the syslog-ng configuration: # pkill -HUP syslog-ng', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30028', 'Review the contents of the /etc/syslog-ng/syslog-ng.conf file to ensure appropriate logging is set. In addition, run the following command and ensure that the log files are logging information: # ls -l /var/log/', 'Customized rule by Cloud Raxak') from dual;

--4.2.2.3
--select add_rule_data ('default','C-30029','SV-3036r1_rule','default','high', 'Ensure syslog-ng default file permissions configured', 'syslog-ng will create logfiles that do not already exist on the system. This setting controls what permissions will be applied to these newly created files. It is important to ensure that log files exist and have the correct permissions to ensure that sensitive syslog-ng data is archived and protected. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.2.3 - Red Hat Enterprise. 4.2.2.3 - CentOS', 'F-30029', 'Edit the /etc/syslog-ng/syslog-ng.conf and set perm option to 0640 or more restrictive: options { chain_hostnames(off); flush_lines(0); perm(0640); stats_freq(3600); threaded(yes); };', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30029', 'Run the following command and verify the perm option is 0640 or more restrictive: cmd# grep ^options /etc/syslog-ng/syslog-ng.conf output# options { chain_hostnames(off); flush_lines(0); perm(0640); stats_freq(3600); threaded(yes); };', 'Customized rule by Cloud Raxak') from dual;

--4.2.2.4
--select add_rule_data ('default','C-30030','SV-3037r1_rule','default','high', 'Ensure syslog-ng is configured to send logs to a remote log host', 'The syslog-ng utility supports the ability to send logs it gathers to a remote log host or to receive messages from remote hosts, reducing administrative overhead. Storing log data on a remote host protects log integrity from local attacks. If an attacker gains root access on the local system, they could tamper with or remove log data that is stored on the local system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.2.4 - Red Hat Enterprise. 4.2.2.4 - CentOS', 'F-30030', 'Edit the /etc/syslog-ng/syslog-ng.conf file and add the following lines (where logfile.example.com is the name of your central log host). destination logserver { tcp("logfile.example.com" port(514)); }; log { source(src); destination(logserver); };. Run the following command to reload the syslog-ng configuration: cmd# pkill -HUP syslog-ng', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30030', 'Review the /etc/syslog-ng/syslog-ng.conf file and verify that logs are sent to a central host (where logfile.example.com is the name of your central log host): destination logserver { tcp("logfile.example.com" port(514)); }; log { source(src); destination(logserver); };', 'Customized rule by Cloud Raxak') from dual;

--4.2.2.5
--select add_rule_data ('default','C-30031','SV-3038r1_rule','default','high', 'Ensure remote syslog-ng messages are only accepted on designated log hosts', 'By default, syslog-ng does not listen for log messages coming in from remote systems. The guidance in the section ensures that remote log hosts are configured to only accept syslog-ng data from hosts within the specified domain and that those systems that are not designed to be log hosts do not accept any remote syslog-ng messages. This provides protection from spoofed log data and ensures that system administrators are reviewing reasonably complete syslog data in a central location. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.2.5 - Red Hat Enterprise. 4.2.2.5 - CentOS', 'F-30031', 'On designated log hosts edit the /etc/syslog-ng/syslog-ng.conf file and configure the following lines are appropriately: source net{ tcp(); }; destination remote { file("/var/log/remote/${FULLHOST}-log"); }; log { source(net); destination(remote); };. On non designated log hosts edit the /etc/syslog-ng/syslog-ng.conf file and remove or edit any sources that accept network sourced log messages. Run the following command to reload the syslog-ng configuration: # pkill -HUP syslog-ng', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30031', 'Review the /etc/syslog-ng/syslog-ng.conf file and verify the following lines are configured appropriately on designated log hosts source net{ tcp(); }; destination remote { file("/var/log/remote/${FULLHOST}-log"); }; log { source(net); destination(remote); };', 'Customized rule by Cloud Raxak') from dual;

--4.2.3
--select add_rule_data ('default','V-38520','SV-50321r1_rule','default','medium','The operating system must back up audit records on an organization defined frequency onto a different system or media than the system being audited.',
--'A log server (loghost) receives syslog messages from one or more systems. 
--This data can be used as an additional log source in the event a system is compromised and its local logs are suspect. 
--Forwarding log messages to a remote loghost also provides system administrators with a centralized place to view the status of multiple hosts within the enterprise.
--Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 
--4.2.3 - Red Hat Enterprise
--4.2.3 - CentOS',
--'F-43468r1_fix','To configure rsyslog to send logs to a remote log server, open "/etc/rsyslog.conf" and read and understand the last section of the file, which describes the multiple directives necessary to activate remote logging. Along with these other directives, the system can be configured to forward its logs to a particular log server by adding or correcting one of the following lines, substituting "[]" appropriately. The choice of protocol depends on the environment of the system; although TCP and RELP provide more reliable message delivery, they may not be supported in all environments. To use UDP for log message delivery: *.* @[loghost.example.com]To use TCP for log message delivery: *.* @@[loghost.example.com]To use RELP for log message delivery: *.* :omrelp:[loghost.example.com]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000136','C-46078r1_chk','To ensure logs are sent to a remote host, examine the file "/etc/rsyslog.conf". If using UDP, a line similar to the following should be present: *.* @[]If using TCP, a line similar to the following should be present: *.* @@[loghost.example.com]If using RELP, a line similar to the following should be present: *.* :omrelp:[loghost.example.com]If none of these are present, this is a finding.','Customized rule by Cloud Raxak') from dual;

--4.2.4
--select add_rule_data ('default','C-30033','SV-3040r1_rule','default','high', 'Ensure permissions on all logfiles are configured', 'Log files stored in /var/log/ contain logged information from many services on the system, or on log hosts others as well. It is important to ensure that log files have the correct permissions to ensure that sensitive data is archived and protected. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.2.4 - Red Hat Enterprise. 4.2.4 - CentOS', 'F-30033', 'Run the following command to set permissions on all existing log files: # find /var/log -type f -exec chmod g-wx,o-rwx {} +', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30033', 'Run the following command and verify that other has no permissions on any files and group does not have write or execute permissions on any files: # find /var/log -type f -lss', 'Customized rule by Cloud Raxak') from dual;

--4.3
select add_rule_data ('default','V-38624','SV-50425r1_rule','default','low','System logs must be rotated daily.','Log files that are not properly rotated run the risk of growing so large that they fill up the /var/log partition. Valuable logging information could be lost if the /var/log partition becomes full. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 4.3 - Red Hat Enterprise. 4.3 - CentOS', 'F-43573r1_fix','If the "logrotate" service is not installed, install it by running. yum install logrotateAdd the following text to the top of the configuration file /etc/logrotate.conf :dailyTo Schedule a cron job in /etc/crontab :Make sure logrotate script is present in /etc/cron.daily directory. ls -l /etc/cron.daily/logrotateSchedule the job as below:25 6 * * * root run-parts --report /etc/cron.dailyOR you can schedule it in /etc/anacrontabTo schedule a cron job in /etc/anacrontab :1 5 cron.daily run-parts --report /etc/cron.daily' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000138','C-46183r1_chk','Run the following commands to determine the current status of the "logrotate" configuration.Make sure logrotate configuration file is configured to rotate logs daily. grep daily /etc/logrotate.confThe string "daily" must be at the top of the configuration file /etc/logrotate.conf.Check whether a cron job is scheduled in /etc/crontab or /etc/anacrontab which rotates logs daily. Make sure it is scheduled for daily execution. grep /etc/cron.daily /etc/crontab grep /etc/cron.daily /etc/anacrontabIf the logrotate service is not run on a daily basis by cron in crontab or anacrontab, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5 Access, Authentication and Authorization
--5.1 Configure cron
--5.1.1
select add_rule_data ('default','V-38605','SV-50406r2_rule','default','medium','The cron service must be running.','Due to its usage for maintenance and security-supporting tasks, enabling the cron daemon is essential. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.1 - Red Hat Enterprise. 5.1.1 - CentOS', 'F-43553r2_fix','The "cron" service is used to execute commands at preconfigured times. It is required by almost all systems to perform necessary maintenance tasks, such as notifying root of system activity. The "cron" service can be enabled with the following commands:  sysv-rc-conf --level 0123456S cron on service cron start' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000224','C-46163r1_chk','Run the following command to determine the current status of the "crond" service:  service cron statusIf the service is enabled, it should return the following: cron start/runningIf the service is not running, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.1.2
select add_rule_data ('default','V-56002','SV-50462r1_rule','default','high','The /etc/crontab file must be user/group owned by root and must have mode 0600.','Crontab is the program used to install, deinstall or list the tables used to drive the cron daemon in Vixie Cron. An active line in a crontab will be either an environment setting or a cron command. Protection of this file is critical for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.2 - Red Hat Enterprise. 5.1.2 - CentOS', 'F-55014','Change the permission of /etc/crontab to 600 and change the user and group ownership to root. chmod 600 /etc/crontab chown root /etc/crontab chgrp root /etc/crontab' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/crontab" file, run the following command: stat --format=%U,%G,%a /etc/crontabIf properly configured, the output should indicate the following permissions.User and Group ownership should be root and permission should be 600 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.3
select add_rule_data ('default','V-56005','SV-50462r1_rule','default','high','The /etc/cron.hourly directory must be user/group owned by root and must have mode 0700.','This /etc/cron.hourly directory contains script which are executed hourly. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.3 - Red Hat Enterprise. 5.1.3 - CentOS', 'F-55014','Change the permission of /etc/cron.hourly to 700 and change the user and group ownership to root. chmod 700 /etc/cron.hourly chown root /etc/cron.hourly chgrp root /etc/cron.hourly' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.hourly", run the following command: stat --format=%U,%G,%a /etc/cron.hourlyIf properly configured, the output should indicate the following permissions.User and Group ownership should be root and permission should be 700 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.4
select add_rule_data ('default','V-56006','SV-50462r1_rule','default','high','The  /etc/cron.daily directory must be user/group owned by root and must have mode 0700.','This /etc/cron.daily directory contain script which are executed daily. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.4 - Red Hat Enterprise. 5.1.4 - CentOS', 'F-55014','Change the permission of /etc/cron.daily to 700 and change the user and group ownership to root. chmod 700 /etc/cron.daily chown root /etc/cron.daily chgrp root /etc/cron.daily' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.daily", run the following command: stat --format=%U,%G,%a /etc/cron.dailyIf properly configured, the output should indicate the following permissionsUser and Group ownership should be root and permission should be 700 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.5
select add_rule_data ('default','V-56003','SV-50462r1_rule','default','high','The /etc/cron.weekly directory must be user/group owned by root and must have mode 0700.','This /etc/cron.weekly directory contain script which are executed weekly. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.5 - Red Hat Enterprise. 5.1.5 - CentOS', 'F-55014','Change the permission of /etc/cron.weekly to 700 and change the user and group ownership to root. chmod 700 /etc/cron.weekly chown root /etc/cron.weekly chgrp root /etc/cron.weekly' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.weekly", run the follwoing command: stat --format=%U,%G,%a /etc/cron.weeklyIf properly configured, the output should indicate the following permissionsUser and Group ownership should be root and permission should be 700 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.6
select add_rule_data ('default','V-56004','SV-50462r1_rule','default','high','The /etc/cron.monthly directory must be user/group owned by root and must have mode 0700.','This /etc/cron.monthly directory contain script which are executed monthly. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.6 - Red Hat Enterprise. 5.1.6 - CentOS', 'F-55014','Change the permission of /etc/cron.monthly to 700 and change the user and group ownership to root. chmod 700 /etc/cron.monthly chown root /etc/cron.monthly chgrp root /etc/cron.monthly' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.monthly", run the following command: stat --format=%U,%G,%a /etc/cron.monthlyIf properly configured, the output should indicate the following permissions.User and Group ownership should be root and permission should be 700 or more restrictive. Otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.7
select add_rule_data ('default','V-56007','SV-50462r1_rule','default','high','The /etc/cron.d directory must be user/group owned by root and must have mode 0700.','/etc/cron.d directory contains system cronjobs stored for different users. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.7 - Red Hat Enterprise. 5.1.7 - CentOS', 'F-55014','Change the permission of /etc/cron.d to 700 and change the user and group ownership to root. chmod 700 /etc/cron.d chown root /etc/cron.d chgrp root /etc/cron.d' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.d", run the following command: stat --format=%U,%G,%a /etc/cron.dIf properly configured, the output should indicate the following permissions.User and Group ownership should be root and permission should be 700 or more restrictive. otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.1.8
select add_rule_data ('default','V-56013','SV-50462r1_rule','default','high','File /etc/cron.deny must not exist on the system.','This rule verifies that /etc/cron.deny file does not exist on the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.8 - Red Hat Enterprise. 5.1.8 - CentOS', 'F-56013','If the file /etc/cron.deny exists, for removing it run: rm /etc/cron.deny' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether /etc/cron.deny file exists on the system. If the file exists, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56014','SV-50462r1_rule','default','high','The /etc/cron.allow file must be user/group owned by root and must have mode 0600.','The /etc/cron.allow file is used to restrict access to cron. The root user can always use cron, regardless of the usernames listed in the access control files. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.8 - Red Hat Enterprise. 5.1.8 - CentOS', 'F-55014','Change the permission of /etc/cron.allow to 600 and change the user and group ownership to root. chmod 600 /etc/cron.allow chown root /etc/cron.allow chgrp root /etc/cron.allow' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/cron.allow", run the following  command: stat --format=%U,%G,%a /etc/cron.allow If properly configured, the output should indicate the following permissions. User and Group ownership should be root and permission should be 600 or more restrictive.Otherwise this is finding.If cron.allow does not exist, users listed in cron.deny are not allowed to use cron.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56015','SV-50462r1_rule','default','high','File /etc/at.deny must not exist on the system.','This rule verifies that /etc/at.deny file does not exist. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.8 - Red Hat Enterprise. 5.1.8 - CentOS', 'F-55014','If the file /etc/at.deny exists, for removing it run: rm /etc/at.deny' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether /etc/at.deny file exists on the system. If the file exists, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-56016','SV-50462r1_rule','default','high','The /etc/at.allow file must be user/group owned by root and must have mode 0600.','/etc/at.allow file is used to restrict the access to the at and batch commands. The root user can always execute at and batch commands, regardless of the content of the access control files. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.1.8 - Red Hat Enterprise. 5.1.8 - CentOS', 'F-55014','Change the permission of /etc/at.allow to 600 and change the user and group ownership to root. chmod 600 /etc/at.allow chown root /etc/at.allow chgrp root /etc/at.allow' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of "/etc/at.allow", run the following command: stat --format=%U,%G,%a /etc/at.allow If properly configured, the output should indicate the following permissions. User and Group ownership should be root and permission should be 600 or more restrictive. Otherwise this is finding.If at.allow does not exist, users listed in at.deny are not allowed to use "at" or "batch" commands.','Customized rule by Cloud Raxak') from dual;

--5.2 SSH Server Configuration
--5.2.1
select add_rule_data ('default','V-56026','SV-50462r1_rule','default','high','The /etc/ssh/sshd_config file must be user/group owned by root and must have mode 0600.','The /etc/ssh/sshd_config file is the system-wide configuration file for OpenSSH which allows you to set options that modify the operation of the daemon. This file contains keyword-value pairs, one per line, with keywords being case insensitive. Here are the most important keywords to configure your sshd for top security. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.1 - Red Hat Enterprise. 5.2.1 - CentOS', 'F-55014','Change the permission of /etc/ssh/sshd_config to 600 and change the user and group ownership to root. chmod 600 /etc/ssh/sshd_config chown root /etc/ssh/sshd_config chgrp root /etc/ssh/sshd_config' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the ownership, group ownership and permission of  "/etc/ssh/sshd_config", run the following  command: stat --format=%U,%G,%a /etc/ssh/sshd_configIf properly configured, the output should indicate the following permissions.User and Group ownership should be root and permission should be 600 or more restrictive. otherwise this is finding.','Customized rule by Cloud Raxak') from dual;

--5.2.2
select add_rule_data ('default','V-38607','SV-50408r1_rule','default','high','The SSH daemon must be configured to use only the SSHv2 protocol.','SSH protocol version 1 suffers from design flaws that result in security vulnerabilities and should not be used. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.2 - Red Hat Enterprise. 5.2.2 - CentOS', 'F-43555r1_fix','Only SSH protocol version 2 connections should be permitted. The default setting in "/etc/ssh/sshd_config" is correct, and can be verified by ensuring that the following line appears: Protocol 2Restart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000227','C-46165r1_chk','To check which SSH protocol version is allowed, run the following command:  grep -iw Protocol /etc/ssh/sshd_config  | grep -v "^"If configured properly, output should be Protocol 2If it is not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.3
select add_rule_data ('default','V-56027','SV-50462r1_rule','default','high','The Loglevel for SSH daemon must be set to INFO.','This rule verifies that LogLevel parameter is set to INFO. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.3 - Red Hat Enterprise. 5.2.3 - CentOS', 'F-56027','Loglevel gives the verbosity level that is used when logging messages from sshd. Set this to INFO in sshd_config file.LogLevel INFORestart the ssh service:$ service ssh restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check for Loglevel value in sshd_config file by running: grep -iw LogLevel /etc/ssh/sshd_config  | grep -v "^"Acceptable value is INFO. If its not this is the finding.','Customized rule by Cloud Raxak') from dual;

--5.2.4
select add_rule_data ('default','V-56064','SV-50462r1_rule','default','high','The SSH X11 Forwarding must be disabled.','SSH X11 forwarding gives the user an ability to graphically run programs on remote machine. If an attacker gets access of machine via SSH, he/she can misuse the graphical console there by making it easy for them to attack a system. This rule verifies that X11Forwarding parameter is set to no. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.4 - Red Hat Enterprise. 5.2.4 - CentOS', 'F-56064','If SSH X11 Forwarding is enabled edit the file /etc/ssh/sshd_configX11Forwarding no []Restart the ssh service:$ service ssh restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check the whether X11 Forwarding is disabled run: grep -iw "X11Forwarding" /etc/ssh/sshd_config | grep -v "^"The parameter should have the value set to "no", if this is not the case then this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.5
select add_rule_data ('default','V-56025','SV-50462r1_rule','default','high','The maximum number of authentication attempts permitted per connection must be set to 4 or less.','This rule verifies that MaxAuthTries parameter is set to 4. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.5 - Red Hat Enterprise. 5.2.5 - CentOS', 'F-56025','Set the MaxAuthTries parameter in sshd_config file to 4.MaxAuthTries 4Restart the ssh service:$ service ssh restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check the value of maximum number of authentication attempts permitted per connection by running: grep -iw MaxAuthTries /etc/ssh/sshd_config  | grep -v "^"The output should be 2,3,4, if its not then this is the finding.','Customized rule by Cloud Raxak') from dual;

--5.2.6
select add_rule_data ('default','V-38611','SV-50412r1_rule','default','medium','The SSH daemon must ignore .rhosts files.','SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.6 - Red Hat Enterprise. 5.2.6 - CentOS', 'F-43559r1_fix','SSH can emulate the behavior of the obsolete rsh command in allowing users to enable insecure access to their accounts via ".rhosts" files. To ensure this behavior is disabled, add or correct the following line in "/etc/ssh/sshd_config": IgnoreRhosts yes' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000234','C-46169r1_chk','To determine how the SSH daemon"s "IgnoreRhosts" option is set, run the following command:  grep -i IgnoreRhosts /etc/ssh/sshd_configIf no line, a commented line, or a line indicating the value "yes" is returned, then the required value is set. If the required value is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.7
select add_rule_data ('default','V-38612','SV-50413r1_rule','default','medium','The SSH daemon must not allow host-based authentication.','SSH trust relationships mean a compromise on one host can allow an attacker to move trivially to other hosts. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.7 - Red Hat Enterprise. 5.2.7 - CentOS', 'F-43560r1_fix','SSH"s cryptographic host-based authentication is more secure than ".rhosts" authentication, since hosts are cryptographically authenticated. However, it is not recommended that hosts unilaterally trust one another, even within an organization. To disable host-based authentication, add or correct the following line in "/etc/ssh/sshd_config": HostbasedAuthentication noRestart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000236','C-46170r1_chk','To determine how the SSH daemon"s "HostbasedAuthentication" option is set, run the following command:  grep -iw HostbasedAuthentication /etc/ssh/sshd_config | grep -v "^If no line, a commented line, or a line indicating the value "no" is returned, then the required value is set. If the required value is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.8
select add_rule_data ('default','V-38613','SV-50414r1_rule','default','medium','The system must not permit root logins using remote access programs such as ssh.','Permitting direct root login reduces auditable information about who ran privileged commands on the system and also allows direct attack attempts on root"s password. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.8 - Red Hat Enterprise. 5.2.8 - CentOS', 'F-43561r1_fix','The root user should never be allowed to log into a system directly over a network. To disable root login via SSH, add or correct the following line in "/etc/ssh/sshd_config": PermitRootLogin noThen, Restart the ssh service:$ service ssh restartIn Case if "PermitRootLogin no" already exist and no valid user exist. Then in recommended fix create a valid user with below condition:1. User account must not be expired.2. User account should be unlocked.3. User account must have sudo privileges.4. User account password  must be set or RSA key??pairs should be configured.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000237','C-46171r1_chk','To determine how the SSH daemon"s "PermitRootLogin" option is set, run the following command:  grep -iw PermitRootLogin /etc/ssh/sshd_config  | grep -v "^"If a line indicating "no" is returned, then the required value is set. If the required value is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.9
select add_rule_data ('default','V-38614','SV-50415r1_rule','default','high','The SSH daemon must not allow authentication using an empty password.','Configuring this setting for the SSH daemon provides additional assurance that remote login via SSH will require a password, even in the event of misconfiguration elsewhere. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.9 - Red Hat Enterprise. 5.2.9 - CentOS', 'F-43562r1_fix','To explicitly disallow remote login from accounts with empty passwords, add or correct the following line in "/etc/ssh/sshd_config": PermitEmptyPasswords noAny accounts with empty passwords should be disabled immediately, and PAM configuration should prevent users from being able to assign themselves empty passwords.Restart ssh service to get changes in effect:$ service ssh restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000239','C-46172r1_chk','To determine how the SSH daemon"s "PermitEmptyPasswords" option is set, run the following command:  grep -iw PermitEmptyPasswords /etc/ssh/sshd_config  | grep -v "^"If no line, a commented line, or a line indicating the value "no" is returned, then the required value is set. If the required value is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.10
select add_rule_data ('default','V-38616','SV-50417r1_rule','default','low','The SSH daemon must not permit user environment settings.','SSH environment options potentially allow users to bypass access restriction in some configurations. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.10 - Red Hat Enterprise. 5.2.10 - CentOS', 'F-43565r1_fix','To ensure users are not able to present environment options to the SSH daemon, add or correct the following line in "/etc/ssh/sshd_config": PermitUserEnvironment noRestart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000241','C-46175r1_chk','To ensure users are not able to present environment daemons, run the following command:  grep -iw PermitUserEnvironment /etc/ssh/sshd_config | grep -v "^"If properly configured, output should be: PermitUserEnvironment noIf it is not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.11
select add_rule_data ('default','C-30024','SV-3041r1_rule','default','high', 'Ensure only approved MAC algorithms are used', 'This variable limits the types of MAC algorithms that SSH can use during communication. MD5 and 96-bit MAC algorithms are considered weak and have been shown to increase exploitability in SSH downgrade attacks. Weak algorithms continue to have a great deal of attention as a weak spot that can be exploited with expanded computing power. An attacker that breaks the algorithm could take advantage of a MiTM position to decrypt the SSH tunnel and capture credentials and information Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.11 - Red Hat Enterprise. 5.2.11 - CentOS', 'F-30024', 'Edit the /etc/ssh/sshd_config file to set the parameter in accordance with site policy. The following includes all supported and accepted MACs:MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30024', 'Run the following command and verify that output does not contain any unlisted MAC algorithms: cmd# grep "MACs" /etc/ssh/sshd_config output# MACs hmac-sha2-512-etm@openssh.com,hmac-sha2-256-etm@openssh.com,umac-128-etm@openssh.com,hmac-sha2-512,hmac-sha2-256,umac-128@openssh.com,curve25519-sha256@libssh.org,diffie-hellman-group-exchange-sha256', 'Customized rule by Cloud Raxak') from dual;

--5.2.12
select add_rule_data ('default','V-38610','SV-50411r1_rule','default','low','The SSH daemon must set a timeout count on idle sessions.','This ensures a user login will be terminated as soon as the "ClientAliveCountMax" is reached. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.12 - Red Hat Enterprise. 5.2.12 - CentOS','F-43558r1_fix','To ensure the SSH idle timeout occurs precisely when the "ClientAliveCountMax" is set, edit "/etc/ssh/sshd_config" as follows: ClientAliveCountMax 0. Restart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000231','C-46168r1_chk','To ensure the SSH idle timeout will occur when the "ClientAliveCountMax" is set, run the following command:  grep -iw ClientAliveCountMax /etc/ssh/sshd_config  | grep -v "^"If properly configured, output should be: ClientAliveCountMax 0If it is not, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38608','SV-50409r1_rule','default','low','The SSH daemon must set a timeout interval on idle sessions.','Causing idle users to be automatically logged out guards against compromises one system leading trivially to compromises on another. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.12 - Red Hat Enterprise. 5.2.12 - CentOS', 'F-43556r1_fix','SSH allows administrators to set an idle timeout interval. After this interval has passed, the idle user will be automatically logged out. To set an idle timeout interval, edit the following line in "/etc/ssh/sshd_config" as follows: ClientAliveInterval []The timeout [interval] is given in seconds. To have a timeout of 15 minutes, set [interval] to 900. If a shorter timeout has already been set for the login shell, that value will preempt any SSH setting made here. Keep in mind that some processes may stop SSH from correctly detecting that the user is idle.Restart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000230','C-46167r1_chk','Run the following command to see what the timeout interval is:  grep -iw ClientAliveInterval /etc/ssh/sshd_config  | grep -v "^"If properly configured, the output should be: ClientAliveInterval 900If it is not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.2.13
--select add_rule_data ('default','C-30025','SV-3042r1_rule','default','high', 'Ensure SSH LoginGraceTime is set to one minute or less', 'The LoginGraceTime parameter specifies the time allowed for successful authentication to the SSH server. The longer the Grace period is the more open unauthenticated connections can exist. Like other session controls in this session the Grace Period should be limited to appropriate organizational limits to ensure the service is available for needed access. Setting the LoginGraceTime parameter to a low number will minimize the risk of successful brute force attacks to the SSH server. It will also limit the number of concurrent unauthenticated connections While the recommended setting is 60 seconds (1 Minute), set the number based on site policy. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.13 - Red Hat Enterprise. 5.2.13 - CentOS', 'F-30025', 'Edit the /etc/ssh/sshd_config file to set the parameter as follows: LoginGraceTime 60', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30025', 'Run the following command and verify that output LoginGraceTime is between 1 and 60: cmd# grep "^LoginGraceTime" /etc/ssh/sshd_config output# LoginGraceTime 60', 'Customized rule by Cloud Raxak') from dual;

--5.2.14
select add_rule_data ('default','C-30025','SV-3043r1_rule','default','high', 'Ensure SSH access is limited', 'There are several options available to limit which users and group can access the system via SSH. It is recommended that at least one of the following options be leveraged: AllowUsers The AllowUsers variable gives the system administrator the option of allowing specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by only allowing the allowed users to log in from a particular host, the entry can be specified in the form of user@host. AllowGroups The AllowGroups variable gives the system administrator the option of allowing specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable. DenyUsers The DenyUsers variable gives the system administrator the option of denying specific users to ssh into the system. The list consists of space separated user names. Numeric user IDs are not recognized with this variable. If a system administrator wants to restrict user access further by specifically denying a users access from a particular host, the entry can be specified in the form of user@host. DenyGroups. The DenyGroups variable gives the system administrator the option of denying specific groups of users to ssh into the system. The list consists of space separated group names. Numeric group IDs are not recognized with this variable. Restricting which users can remotely access the system via SSH will help ensure that only authorized users access the system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.14 - Red Hat Enterprise. 5.2.14 - CentOS', 'F-30025', 'Edit the /etc/ssh/sshd_config file to set one or more of the parameter as follows: AllowUsers <userlist> AllowGroups <grouplist> DenyUsers <userlist> DenyGroups <grouplist>', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30025', 'Run the following commands and verify that output matches for at least one: cmd# grep "^AllowUsers" /etc/ssh/sshd_config output# AllowUsers <userlist> cmd# grep "^AllowGroups" /etc/ssh/sshd_config output# AllowGroups <grouplist> cmd# grep "^DenyUsers" /etc/ssh/sshd_config output# DenyUsers <userlist> cmd# grep "^DenyGroups" /etc/ssh/sshd_config output# DenyGroups <grouplist>', 'Customized rule by Cloud Raxak') from dual;

--5.2.15
select add_rule_data ('default','V-38615','SV-50416r1_rule','default','medium','The SSH daemon must be configured with the Department of Defense (DoD) login banner.','The warning message reinforces policy awareness during the logon process and facilitates possible legal action against attackers. Alternatively, systems whose ownership should not be obvious should ensure usage of a banner that does not provide easy attribution. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.2.15 - Red Hat Enterprise. 5.2.15 - CentOS', 'F-43563r1_fix','To enable the warning banner and ensure it is consistent across the system, add or correct the following line in "/etc/ssh/sshd_config": Banner /etc/issueAnother section contains information on how to create an appropriate system-wide warning banner.Restart ssh service to get changes in effect:$ service sshd restart' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000240','C-46173r1_chk','To determine how the SSH daemon"s "Banner" option is set, run the following command:  grep -iw Banner /etc/ssh/sshd_config | grep -v "^"If a line indicating /etc/issue is returned, then the required value is set. If the required value is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.3 Configure PAM
--5.3.1
select add_rule_data ('default','V-38475','SV-50275r1_rule','default','medium','The system must require passwords to contain a minimum of 14 characters.','Requiring a minimum password length makes password cracking attacks more difficult by ensuring a larger search space. However, any security benefit from an onerous requirement must be carefully weighed against usability problems, support costs, or counterproductive behavior that may result.While it does not negate the password length requirement, it is preferable to migrate from a password-based authentication scheme to a stronger one based on PKI (public key infrastructure). Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.1 - Red Hat Enterprise. 5.3.1 - CentOS', 'F-43419r1_fix','Check if the libpam-cracklib package exists. If it is not installed, install the package:$ apt-get -y install libpam-cracklibTo specify password length requirements for new accounts,edit the file "/etc/pam.d/common-password" and update the minimum password length (minlen) parameter in the below line e.g:password requisite pam_cracklib.so minlen=14 ucredit=0 lcredit=0 ocredit=0 dcredit=0INFO: minlen should be >= 14 and the credits limit should be less or equal to 0 for the validation criteria in the rule.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000050','C-46029r1_chk','To check the minimum password length and to check the other settings required for the password authentication, run the command:$ grep -v "^" /etc/pam.d/common-password | grep -w pam_cracklib.so | grep -w passwordIf minlen is not set, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38482','SV-50282r1_rule','default','low','The system must require passwords to contain at least one numeric character.','Requiring digits makes password guessing attacks more difficult by ensuring a larger search space. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.1 - Red Hat Enterprise. 5.3.1 - CentOS','F-43427r1_fix','Check if the libpam-cracklib package exists. If it is not installed, install the package: apt-get -y install libpam-cracklibThe pam_cracklib module"s "dcredit" parameter controls requirements for usage of digits in a password. When set to a negative number, any password will be required to contain that many digits. When set to a positive number, pam_cracklib will grant +1 additional length credit for each digit. Add "dcredit=-1" after pam_cracklib.so in /etc/pam.d/common-password file to require use of a digit in password.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000056','C-46037r1_chk','To check how many digits are required in a password, run the following command: $ grep -w pam_cracklib /etc/pam.d/common-password | grep -w requisite | grep -v "^"The "dcredit" parameter (as a negative number) will indicate how many digits are required. The requirement is at least one digit in a password. This would appear as "dcredit=-1". If dcredit is not found or not set to the required value, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38571','SV-50372r1_rule','default','low','The system must require passwords to contain at least one lowercase alphabetic character.','Requiring a minimum number of lowercase characters makes password guessing attacks more difficult by ensuring a larger search space. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.1 - Red Hat Enterprise. 5.3.1 - CentOS','F-43519r1_fix','Check if the libpam-cracklib package exists. If it is not installed, install the package:$ apt-get -y install libpam-cracklibThe pam_cracklib module"s "lcredit=" parameter controls requirements for usage of lowercase letters in a password. When set to a negative number, any password will be required to contain that many lowercase characters. When set to a positive number, pam_cracklib will grant +1 additional length credit for each lowercase character. Add "lcredit=-1" after pam_cracklib.so in /etc/pam.d/common-password file to require use of a lowercase character in password.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000059','C-46129r1_chk','To check how many lowercase characters are required in a password, run the following command: $ grep -w pam_cracklib /etc/pam.d/common-password | grep -w requisite | grep -v "^"The "lcredit" parameter (as a negative number) will indicate how many special characters are required. The requirement is at least one lowercase character in a password. This would appear as "lcredit=-1". If lcredit is not found or not set to the required value, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38569','SV-50370r1_rule','default','low','The system must require passwords to contain at least one uppercase alphabetic character.','Requiring a minimum number of uppercase characters makes password guessing attacks more difficult by ensuring a larger search space. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.1 - Red Hat Enterprise. 5.3.1 - CentOS','F-43517r1_fix','Check if the libpam-cracklib package exists. If it is not installed, install the package:$ apt-get -y install libpam-cracklibThe pam_cracklib module"s "ucredit=" parameter controls requirements for usage of uppercase letters in a password. When set to a negative number, any password will be required to contain that many uppercase characters. When set to a positive number, pam_cracklib will grant +1 additional length credit for each uppercase character. Add "ucredit=-1" after pam_cracklib.so in /etc/pam.d/common-password file to require use of an uppercase character in a password.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000057','C-46127r1_chk','To check how many uppercase characters are required in a password, run the following command: $ grep -w pam_cracklib /etc/pam.d/common-password | grep -w requisite | grep -v "^"The "ucredit" parameter (as a negative number) will indicate how many uppercase characters are required. The requirement is at least one uppercase character in a password. This would appear as "ucredit=-1". If ucredit is not found or not set to the required value, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38570','SV-50371r1_rule','default','low','The system must require passwords to contain at least one special character.','Requiring a minimum number of special characters makes password guessing attacks more difficult by ensuring a larger search space. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.1 - Red Hat Enterprise. 5.3.1 - CentOS','F-43518r1_fix','Check if the libpam-cracklib package exists. If it is not installed, install the package:$ apt-get -y install libpam-cracklibThe pam_cracklib module"s "ocredit=" parameter controls requirements for usage of special (or "other") characters in a password. When set to a negative number, any password will be required to contain that many special characters. When set to a positive number, pam_cracklib will grant +1 additional length credit for each special character.  Add "ocredit=-1" after pam_cracklib.so in /etc/pam.d/common-password file to require use of a special character in passwords.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000058','C-46128r1_chk','To check how many special characters are required in a password, run the following command: $ grep -w pam_cracklib /etc/pam.d/common-password | grep -w requisite | grep -v "^"The "ocredit" parameter (as a negative number) will indicate how many special characters are required. The requirement is at least one special character in a password. This would appear as "ocredit=-1". If ocredit is not found or not set to the required value, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.3.2
select add_rule_data ('default','V-38592','SV-50393r4_rule','default','medium','The system must require administrator action to unlock an account locked by excessive failed login attempts.','Locking out user accounts after a number of incorrect attempts prevents direct password guessing attacks. Ensuring that an administrator is involved in unlocking locked accounts draws appropriate attention to such situations. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.2 - Red Hat Enterprise. 5.3.2 - CentOS','F-43541r6_fix','To configure the system to lock out accounts after a number of incorrect logon attempts and require an administrator to unlock the account using "pam_faillock.so", modify the content of both "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" as follows: Add the following line immediately before the "pam_unix.so" statement in the "AUTH" section: auth required pam_faillock.so preauth silent deny=3 unlock_time=604800 fail_interval=900. Add the following line immediately after the "pam_unix.so" statement in the "AUTH" section: auth [] pam_faillock.so authfail deny=3 unlock_time=604800 fail_interval=900. Add the following line immediately before the "pam_unix.so" statement in the "ACCOUNT" section: account required pam_faillock.soNote that any updates made to "/etc/pam.d/system-auth" and "/etc/pam.d/password-auth" may be overwritten by the "authconfig" program.  The "authconfig" program should not be used.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000356','C-46151r5_chk','To ensure the failed password attempt policy is configured correctly, run the following command:  grep -w pam_faillock /etc/pam.d/system-auth /etc/pam.d/password-auth | grep -v "^"The output should show "unlock_time=<some-large-number>"; the largest acceptable value is 604800 seconds (one week). If that is not the case, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.3.3
select add_rule_data ('default','V-38658','SV-50459r1_rule','default','medium','The system must prohibit the reuse of passwords within twenty-four iterations.','Preventing reuse of previous passwords helps ensure that a compromised password is not reused by a user. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.3 - Red Hat Enterprise. 5.3.3 - CentOS', 'F-43608r1_fix','Do not allow users to reuse recent passwords. This can be accomplished by using the "remember" option for the "pam_unix" PAM module. In the file "/etc/pam.d/common-password", append "remember=24" to the line which refers to the "pam_unix.so" module, as shown:??password sufficient pam_unix.so [] remember=24The requirement is 24 passwords.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000274','C-46219r1_chk','To verify the password reuse setting is compliant, run the following command:??$ grep -w remember /etc/pam.d/common-password | grep -w password | grep -v "^"The output should show the following at the end of the line:??remember=24If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.3.4
select add_rule_data ('default','V-38574','SV-50375r2_rule','default','medium','The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes (common-password).','Using a stronger hashing algorithm makes password cracking attacks more difficult. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.3.4 - Red Hat Enterprise. 5.3.4 - CentOS','F-43522r2_fix','In "/etc/pam.d/common-password", among potentially other files, the "password" section of the files control which PAM modules execute during a password change. Set the "pam_unix.so" module in the "password" section to include the argument "sha512", as shown below: password [] pam_unix.so obscure use_authtok try_first_pass sha512This will help ensure when local users change their passwords, hashes for the new passwords will be generated using the SHA-512 algorithm. This is the default.Note that any updates made to "/etc/pam.d/common-password" will be overwritten by the "authconfig" program.  The "authconfig" program should not be used.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000062','C-46132r3_chk','Inspect the "password" section of "/etc/pam.d/common-password", and other files in "/etc/pam.d" and ensure that the "pam_unix.so" module includes the argument "sha512".$ grep -w password /etc/pam.d/common-password | grep -w pam_unix.so | grep -v "^"If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.4 User Accounts and Environment
--5.4.1 Set Shadow Password Suite Parameters
--5.4.1.1
select add_rule_data ('default','C-50014','SV-3044r1_rule','default','high', 'Ensure password expiration is 365 days or less', 'The PASS_MAX_DAYS parameter in /etc/login.defs allows an administrator to force passwords to expire once they reach a defined age. It is recommended that the PASS_MAX_DAYS parameter be set to less than or equal to 365 days. The window of opportunity for an attacker to leverage compromised credentials or successfully compromise credentials via an online brute force attack is limited by the age of the password. Therefore, reducing the maximum age of a password also reduces an attackers window of opportunity. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.1.1 - Red Hat Enterprise. 5.4.1.1 - CentOS', 'F-50014', 'Set the PASS_MAX_DAYS parameter to conform to site policy in /etc/login.defs : PASS_MAX_DAYS 90. Modify user parameters for all users with a password set to match: # chage --maxdays 90 <user>', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-50014', 'Run the following command and verify PASS_MAX_DAYS conforms to site policy (no morethan 365 days): cmd# grep PASS_MAX_DAYS /etc/login.defs output# PASS_MAX_DAYS 90. Verify all users with a password maximum days between password change conforms to site policy (no more than 365 days): cmd# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 output# <list of users> # chage --list <user> Maximum number of days between password change ', 'Customized rule by Cloud Raxak') from dual;

--5.4.1.2
select add_rule_data ('default','C-50013','SV-3045r1_rule','default','high', 'Ensure minimum days between password changes is 7 or more ', 'The PASS_MIN_DAYS parameter in /etc/login.defs allows an administrator to prevent users from changing their password until a minimum number of days have passed since the last time the user changed their password. It is recommended that PASS_MIN_DAYS parameter be set to 7 or more days. By restricting the frequency of password changes, an administrator can prevent users from repeatedly changing their password in an attempt to circumvent password reuse controls. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.1.2 - Red Hat Enterprise. 5.4.1.2 - CentOS', 'F-50013', 'Set the PASS_MIN_DAYS parameter to 7 in /etc/login.defs : PASS_MIN_DAYS 7 Modify user parameters for all users with a password set to match: # chage --mindays 7 <user>', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-50013', 'Run the following command and verify PASS_MIN_DAYS is 7 or more: cmd# grep PASS_MIN_DAYS /etc/login.defs output# PASS_MIN_DAYS 7 Verify all users with a password have their minimum days between password change set to 7 or more: cmd# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 outpit# <list of users> # chage --list <user> Minimum number of days between password change : 7', 'Customized rule by Cloud Raxak') from dual;

--5.4.1.3
select add_rule_data ('default','C-50015','SV-3046r1_rule','default','high', 'Ensure password expiration warning days is 7 or more', 'The PASS_WARN_AGE parameter in /etc/login.defs allows an administrator to notify users that their password will expire in a defined number of days. It is recommended that the PASS_WARN_AGE parameter be set to 7 or more days. Providing an advance warning that a password will be expiring gives users time to think of a secure password. Users caught unaware may choose a simple password or write it down where it may be discovered. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.1.3 - Red Hat Enterprise. 5.4.1.3 - CentOS', 'F-50015', 'Set the PASS_WARN_AGE parameter to 7 in /etc/login.defs : PASS_WARN_AGE 7. Modify user parameters for all users with a password set to match: # chage --warndays 7 <user>', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-50015', 'Run the following command and verify PASS_WARN_AGE is 7 or more: cmd# grep PASS_WARN_AGE /etc/login.defs output# PASS_WARN_AGE 7 Verify all users with a password have their number of days of warning before password expires set to 7 or more: cmd# egrep ^[^:]+:[^\!*] /etc/shadow | cut -d: -f1 ouput# <list of users> # chage --list <user> Number of days of warning before password expires : 7', 'Customized rule by Cloud Raxak') from dual;

--5.4.1.4
select add_rule_data ('default','V-38690','SV-50491r1_rule','default','low','Emergency accounts must be provisioned with an expiration date.','When emergency accounts are created, there is a risk they may remain in place and active after the need for them no longer exists. Account expiration greatly reduces the risk of accounts being misused or hijacked. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.1.4 - Red Hat Enterprise. 5.4.1.4 - CentOS', 'F-43639r1_fix','In the event emergency accounts are required, configure the system to terminate them after a documented time period. For every emergency account, run the following command to set an expiration date on it, substituting "[]" and "[YYYY-MM-DD]" appropriately:  chage -E [YYYY-MM-DD] [USER]"[YYYY-MM-DD]" indicates the documented expiration date for the account.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000298','C-46251r1_chk','For every emergency account, run the following command to obtain its account aging and expiration information:  chage -l []Verify each of these accounts has an expiration date set as documented. If any emergency accounts have no expiration date set or do not expire within a documented time frame, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.4.1.5
select add_rule_data ('default','C-30026','SV-3047r1_rule','default','high', 'Ensure all users last password change date is in the past', 'All users should have a password change date in the past. If a users recorded password change date is in the future then they could bypass any set password expiration. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.1.5 - Red Hat Enterprise. 5.4.1.5 - CentOS', 'F-30026', 'Investigate any users with a password change date in the future and correct them. Locking the account, expiring the password, or resetting the password manually may be appropriate.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30026', 'Verify no users with a have Password change date in the future: cmd# cat /etc/shadow | cut -d: -f1 output#<list of users> # chage --list <user> Last Change ', 'Customized rule by Cloud Raxak') from dual;

--5.4.2
select add_rule_data ('default','V-38496','SV-50297r3_rule','default','medium','Default operating system accounts, other than root, must be locked.','Disabling authentication for default system accounts makes it more difficult for attackers to make use of them to compromise a system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.2 - Red Hat Enterprise. 5.4.2 - CentOS', 'F-43442r2_fix','Some accounts are not associated with a human user of the system, and exist to perform some administrative function. An attacker should not be able to log into these accounts. Disable logon access to these accounts with the command:  passwd -l []' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000029','C-46052r2_chk','To obtain the system accounts which is unlocked run the following command: $ passwd -S < username > | grep -v LKIdentify the operating system accounts from this listing. These will primarily be the accounts with UID numbers less than 500, other than root. If get any output this is finding.','Customized rule by Cloud Raxak') from dual;

--5.4.3
select add_rule_data ('default','V-56071','SV-50462r1_rule','default','high','Root account must have it"s GID as 0.','This rule verifies that for root account GID is 0. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.3 - Red Hat Enterprise. 5.4.3 - CentOS', 'F-56071','Set root account"s GID as 0 by running: usermod -g 0 root' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check the group id (GID) of the root user: id -g rootIf it is anything other than 0, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.4.4
select add_rule_data ('default','V-38647','SV-50448r1_rule','default','low','The system default umask in /etc/profile must be 027.','The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read and/or written to by unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.4 - Red Hat Enterprise. 5.4.4 - CentOS', 'F-43596r1_fix','To ensure the default umask controlled by "/etc/profile" is set properly, add or correct the "umask" setting in "/etc/profile" to read as follows: umask 077' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000344','C-46207r1_chk','Verify the "umask" setting is configured correctly in the "/etc/profile" file by running the following command: grep "umask" /etc/profileAll output must show the value of "umask" set to 077, as shown in the below: grep "umask" /etc/profileumask 077If the above command returns no output, or if the umask is configured incorrectly, this is a finding.','Customized rule by Cloud Raxak') from dual;
select add_rule_data ('default','V-38651','SV-50452r1_rule','default','low','The system default umask for the bash shell must be 077.','The umask value influences the permissions assigned to files when they are created. A misconfigured umask value could result in files with excessive permissions that can be read and/or written to by unauthorized users. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.4 - Red Hat Enterprise. 5.4.4 - CentOS','F-43600r1_fix','To ensure the default umask for users of the Bash shell is set properly, add or correct the "umask" setting in "/etc/bash.bashrc" to read as follows:umask 077' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000342','C-46211r1_chk','Verify the "umask" setting is configured correctly in the "/etc/bash.bashrc" file by running the following command: grep "umask" /etc/bash.bashrcAll output must show the value of "umask" set to 077, as shown below:  grep "umask" /etc/bash.bashrcumask 077umask 077If the above command returns no output, or if the umask is configured incorrectly, this is a finding.','Customized rule by Cloud Raxak') from dual;

--5.4.5
select add_rule_data ('default','C-30027','SV-3048r1_rule','default','high', 'Ensure default user shell timeout is 900 seconds or less', 'The default TMOUT determines the shell timeout for users. The TMOUT value is measured in seconds. Having no timeout value associated with a shell could allow an unauthorized user access to another users shell session (e.g. user walks away from their computer and doesnt lock the screen). Setting a timeout value at least reduces the risk of this happening Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.4.5 - Red Hat Enterprise. 5.4.5 - CentOS', 'F-30027', 'Edit the /etc/bashrc and /etc/profile files (and the appropriate files for any other shell supported on your system) and add or edit any umask parameters as follows: TMOUT=600', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30027', 'Run the following commands and verify all TMOUT lines returned are 900 or less and at least one exists in each file. cmd# grep "^TMOUT" /etc/bashrc output# TMOUT=600 cmd# grep "^TMOUT" /etc/profile output# TMOUT=600', 'Customized rule by Cloud Raxak') from dual;

--5.5
select add_rule_data ('default','C-30028','SV-3049r1_rule','default','high', 'Ensure root login is restricted to system console', 'The file /etc/securetty contains a list of valid terminals that may be logged in directly as root. Since the system console has special properties to handle emergency situations, it is important to ensure that the console is in a physically secure location and that unauthorized consoles have not been defined. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.5 - Red Hat Enterprise. 5.5 - CentOS', 'F-30028', 'Remove entries for any consoles that are not in a physically secure location.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30028', 'Run following cmd: # cat /etc/securetty', 'Customized rule by Cloud Raxak') from dual;

--5.6
select add_rule_data ('default','C-30029','SV-3050r1_rule','default','high', 'Ensure access to the su command is restricted', 'The su command allows a user to run a command or shell as another user. The program has been superseded by sudo , which allows for more granular control over privileged access. Normally, the su command can be executed by any user. By uncommenting the pam_wheel.so statement in /etc/pam.d/su , the su command will only allow users in the wheel group to execute su. Restricting the use of su , and using sudo in its place, provides system administrators better control of the escalation of user privileges to execute privileged commands. The sudo utility also provides a better logging and audit mechanism, as it can log each command executed via sudo , whereas su can only record that a user executed the su program. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 5.6 - Red Hat Enterprise. 5.6 - CentOS', 'F-30029', 'Add the following line to the /etc/pam.d/su file: auth required pam_wheel.so use_uid Create a comma separated list of users in the wheel statement in the /etc/group file: wheel:x:10:root,<user list>', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30029', 'Run the following command and verify output includes matching line: cmd# grep pam_wheel.so /etc/pam.d/su output# auth required pam_wheel.so use_uid. Run the following command and verify users in wheel group match site policy: cmd# grep wheel /etc/group output# wheel:x:10:root,<user list>', 'Customized rule by Cloud Raxak') from dual;

--6 System Maintenance
--6.1 System File Permissions
--6.1.1
select add_rule_data ('default','V-38447','SV-50247r2_rule','default','low','The system package management tool must verify contents of all files associated with packages.',
'The hash on important files like system executables should match the information given by the RPM database. 
Executables with erroneous hashes could be a sign of nefarious activity on the system.
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 
6.1.1 - Red Hat Enterprise
6.1.1 - CentOS',
'F-43392r1_fix','The RPM package management system can check the hashes of installed software packages, including many that are important to system security. Run the following command to list which files on the system have hashes that differ from what is expected by the RPM database:  rpm -Va | grep "^..5"A "c" in the second column indicates that a file is a configuration file, which may appropriately be expected to change. If the file that has changed was not expected to then refresh from distribution media or online repositories. rpm -Uvh []OR yum reinstall [affected_package]' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000519','C-46002r3_chk','The following command will list which files on the system have file hashes different from what is expected by the RPM database.  rpm -Va | awk "$1 ~ /..5/ ANDAND $2 != "c""If there is output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.1.2
select add_rule_data ('default','V-38450','SV-50250r1_rule','default','medium','The /etc/passwd file must be owned by root.','The "/etc/passwd" file contains information about the users that are configured on the system. Protection of this file is critical for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.2 - Red Hat Enterprise. 6.1.2 - CentOS', 'F-43395r1_fix','Run the below command to change the ownership of "/etc/passwd" to root:   chown root /etc/passwd' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000039','C-46005r1_chk','To check the ownership of "/etc/passwd", run the command: $ ls -l /etc/passwdIf its properly configured, the output should be displayed as shown below:"File "/etc/passwd" is owned by root."If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.1.3
select add_rule_data ('default','V-38502','SV-50303r1_rule','default','medium','The /etc/shadow file must be owned by root.','The "/etc/shadow" file contains the list of local system accounts and stores password hashes. Protection of this file is critical for system security. Failure to give ownership of this file to root provides the designated owner with access to sensitive information which could weaken the system security posture. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.3 - Red Hat Enterprise. 6.1.3 - CentOS', 'F-43449r1_fix','Run the below command to change the ownership of "/etc/shadow" to root: chown root /etc/shadow' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000033','C-46059r1_chk','To check the ownership of "/etc/shadow", run the command: $ ls -l /etc/shadowIf its properly configured, the output should be displayed as shown below:"File "/etc/shadow" is owned by root."If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.1.4
select add_rule_data ('default','V-38458','SV-50258r1_rule','default','medium','The /etc/group file must be owned by root.','The "/etc/group" file contains information regarding groups that are configured on the system. Protection of this file is important for system security. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.4 - Red Hat Enterprise. 6.1.4 - CentOS', 'F-43403r1_fix','Run the below command to change the ownership of "/etc/group" to root:  chown root /etc/group' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000042','C-46013r1_chk','To check the ownership of "/etc/group", run the command: $ ls -l /etc/groupIf its properly configured, the output should be displayed as shown below:"File "/etc/group" is owned by root."If it does not, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.1.5
select add_rule_data ('default','C-50001','SV-3052r1_rule','default','high', 'Ensure permissions on /etc/gshadow are configured', 'The /etc/gshadow file is used to store the information about groups that is critical to the security of those accounts, such as the hashed password and other security information. If attackers can gain read access to the /etc/gshadow file, they can easily run a password cracking program against the hashed password to break it. Other security information that is stored in the /etc/gshadow file (such as group administrators) could also be useful to subvert the group. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.5 - Red Hat Enterprise. 6.1.5 - CentOS', 'F-50001', 'Run the following chown to set permissions on /etc/gshadow : # chown root:root /etc/gshadow # chmod 000 /etc/gshadow', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-50001', 'Run the following command and verify Uid and Gid are 0/root , and Access is 000 : cmd# stat /etc/gshadow output#Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)', 'Customized rule by Cloud Raxak') from dual;

--6.1.6
select add_rule_data ('default','C-30030','SV-3053r1_rule','default','high', 'Ensure permissions on /etc/passwd- are configured', 'The /etc/passwd- file contains backup user account information. It is critical to ensure that the /etc/passwd- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.6 - Red Hat Enterprise. 6.1.6 - CentOS', 'F-30030', 'Run the following command to set permissions on /etc/passwd- : # chown root:root /etc/passwd- # chmod u-x,go-wx /etc/passwd', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30030', 'Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive: cmd# stat /etc/passwd output#Access: (0644/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)', 'Customized rule by Cloud Raxak') from dual;

--6.1.7
select add_rule_data ('default','C-30031','SV-3054r1_rule','default','high', 'Ensure permissions on /etc/shadow- are configured', 'The /etc/shadow- file is used to store backup information about user accounts that is critical to the security of those accounts, such as the hashed password and other security information. It is critical to ensure that the /etc/shadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.7 - Red Hat Enterprise. 6.1.7 - CentOS', 'F-30031', 'Run the following commands to set permissions on /etc/shadow-: # chown root:root /etc/shadow- # chmod 000 /etc/shadow', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30031', 'Run the following command and verify verify Uid and Gid is 0/root, and Access is 000: cmd# stat /etc/shadow output#Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)', 'Customized rule by Cloud Raxak') from dual;

--6.1.8
select add_rule_data ('default','C-30032','SV-3055r1_rule','default','high', 'Ensure permissions on /etc/group- are configured', 'The /etc/group- file contains a backup list of all the valid groups defined in the system. It is critical to ensure that the /etc/group- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.8 - Red Hat Enterprise. 6.1.8 - CentOS', 'F-30032', 'Run the following command to set permissions on /etc/group- : # chown root:root /etc/group- # chmod u-x,go-wx /etc/group-', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30032', 'Run the following command and verify Uid and Gid are both 0/root and Access is 644 or more restrictive: cmd# stat /etc/group- output# Access: (0644/-rw-------) Uid: ( 0/ root) Gid: ( 0/ root)', 'Customized rule by Cloud Raxak') from dual;

--6.1.9
select add_rule_data ('default','C-30033','SV-3056r1_rule','default','high', 'Ensure permissions on /etc/gshadow- are configured', 'The /etc/gshadow- file is used to store backup information about groups that is critical to the security of those accounts, such as the hashed password and other security information. It is critical to ensure that the /etc/gshadow- file is protected from unauthorized access. Although it is protected by default, the file permissions could be changed either inadvertently or through malicious actions. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.9 - Red Hat Enterprise. 6.1.9 - CentOS', 'F-30033', 'Run the following commands to set permissions on /etc/gshadow- : # chown root:root /etc/gshadow- # chmod 000 /etc/gshadow-', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30033', 'Run the following command and verify verify Uid and Gid are 0/root, and Access is 000: cmd# stat /etc/gshadow- output# Access: (0000/----------) Uid: ( 0/ root) Gid: ( 0/ root)', 'Customized rule by Cloud Raxak') from dual;

--6.1.10
select add_rule_data ('default','V-38643','SV-50444r3_rule','default','medium','There must be no world-writable files on the system.','Data in world-writable files can be modified by any user on the system. In almost all circumstances, files can be configured using a combination of user and group permissions to support whatever legitimate access is needed without the risk caused by world-writable files. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.10 - Red Hat Enterprise. 6.1.10 - CentOS', 'F-43591r1_fix','It is generally a good idea to remove global (other) write access to a file when it is discovered. However, check with documentation for specific applications before making changes. Also, monitor for recurring world-writable files, as these may be symptoms of a misconfigured application or user account.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000282','C-46202r3_chk','To find world-writable files, run the following command for each local partition [], excluding special filesystems such as /selinux, /proc, or /sys: $ find / -type f -perm -002 -print 2>>/dev/null | grep -v -e ^"/proc" -e ^"/selinux" -e ^"/sys"If there is output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.1.11
select add_rule_data ('default','C-30034','SV-3057r1_rule','default','high', 'Ensure no unowned files or directories exist', 'Sometimes when administrators delete users from the password file they neglect to remove all files owned by those users from the system. A new user who is assigned the deleted users user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.11 - Red Hat Enterprise. 6.1.11 - CentOS', 'F-30034', 'Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30034', 'Run the following command and verify no files are returned: # df --local -P | awk {"if (NR!=1) print $6"} | xargs -I "{}" find "{}" -xdev -nouser. The command above only searches local filesystems, there may still be compromised items on network mounted partitions. The following command can be run manually for individual partitions if needed: # find <partition> -xdev -nouser', 'Customized rule by Cloud Raxak') from dual;

--6.1.12
select add_rule_data ('default','C-30035','SV-3059r1_rule','default','high', 'Ensure no ungrouped files or directories exist', 'Sometimes when administrators delete users or groups from the system they neglect to remove all files owned by those users or groups. A new user who is assigned the deleted users user ID or group ID may then end up "owning" these files, and thus have more access on the system than was intended. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.13 - Red Hat Enterprise. 6.1.12 - CentOS', 'F-30035', 'Locate files that are owned by users or groups not listed in the system configuration files, and reset the ownership of these files to some active user on the system as appropriate.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30035', 'Run the following command and verify no files are returned: # df --local -P | awk {"if (NR!=1) print $6"} | xargs -I "{}" find "{" -xdev -nogroup. The command above only searches local filesystems, there may still be compromised items on network mounted partitions. The following command can be run manually for individual partitions if needed: # find <partition> -xdev -nogroup', 'Customized rule by Cloud Raxak') from dual;

--6.1.13
select add_rule_data ('default','C-30036','SV-3060r1_rule','default','high', 'Audit SUID executables', 'The owner of a file can set the files permissions to run with the owners or groups permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SUID program is to enable users to performfunctions (such as changing their password) that require root privileges. There are valid reasons for SUID programs, but it is important to identify and review such programs to ensure they are legitimate. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.14 - Red Hat Enterprise. 6.1.13 - CentOS', 'F-30036', 'Ensure that no rogue SUID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30036', 'Run the following command to list SUID files: # df --local -P | awk {"if (NR!=1) print $6"} | xargs -I "{}" find "{}" -xdev -type f -perm -4000. The command above only searches local filesystems, there may still be compromised items on network mounted partitions. The following command can be run manually for individual partitions if needed: # find <partition> -xdev -type f -perm -4000', 'Customized rule by Cloud Raxak') from dual;

--6.1.14
select add_rule_data ('default','C-30037','SV-3061r1_rule','default','high', 'Audit SGID executables', 'The owner of a file can set the files permissions to run with the owners or groups permissions, even if the user running the program is not the owner or a member of the group. The most common reason for a SGID program is to enable users to perform functions (such as changing their password) that require root privileges. There are valid reasons for SGID programs, but it is important to identify and review such programs to ensure they are legitimate. Review the files returned by the action in the audit section and check to see if system binaries have a different md5 checksum than what from the package. This is an indication that the binary may have been replaced. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.1.15 - Red Hat Enterprise. 6.1.14 - CentOS', 'F-30037', 'Ensure that no rogue SGID programs have been introduced into the system. Review the files returned by the action in the Audit section and confirm the integrity of these binaries.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30037', 'Run the following command to list SGID files: # df --local -P | awk {"if (NR!=1) print $6"} | xargs -I "{}" find "{}" -xdev -type f -perm -2000. The command above only searches local filesystems, there may still be compromised items on network mounted partitions. The following command can be run manually for individual partitions if needed: # find <partition> -xdev -type f -perm -2000', 'Customized rule by Cloud Raxak') from dual;

--6.2 User and Group Settings
--6.2.1
select add_rule_data ('default','V-56018','SV-50462r1_rule','default','high',' The password fields in /etc/shadow must not be empty.',' If an account with empty password field exists means that anybody may login as that user without providing a password.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.1 - Red Hat Enterprise. 6.2.1 - CentOS', 'F-56018','If there are users which have empty password fields, they don"t have a password set. Set a password for these users to avoid passwordless login and to avoid security risks.   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Run the below command to check for empty password fields: grep "^[]*::" /etc/shadow | cut -d: -f1If a line is returned, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.2, 6.2.3 and 6.2.4
select add_rule_data ('default','V-56001','SV-50462r1_rule','default','high',' Legacy user account entries should not exist in /etc/passwd, /etc/shadow, and /etc/group files.',' These legacy user entries may provide an avenue for attackers to gain privileged access on the system.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.2, 6.2.3 and 6.2.4 - Red Hat Enterprise. 6.2.2, 6.2.3 and 6.2.4 - CentOS', 'F-56001',' If legacy user "+" entries exist in files /etc/passwd, /etc/shadow, /etc/group. Delete or replace them as normal users.   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','To check for any legacy user entry run: grep "^+:" /etc/passwd /etc/shadow /etc/groupIf any line is returned this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.5
select add_rule_data ('default','V-38500','SV-50301r2_rule','default','medium','The root account must be the only account having a UID of 0.','An account has root authority if it has a UID of 0. Multiple accounts with a UID of 0 afford more opportunity for potential intruders to guess a password for a privileged account. Proper configuration of sudo is recommended to afford multiple system administrators access to root privileges in an accountable manner. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.5 - Red Hat Enterprise. 6.2.5 - CentOS', 'F-43447r1_fix','If any account other than root has a UID of 0, this misconfiguration should be investigated and the accounts other than root should be removed or have their UID changed.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000032','C-46057r2_chk','To list all password file entries for accounts with UID 0, run the following command:  awk -F: "($3 == "0") {print}" /etc/passwd | grep -v "^"This should print only one line, for the user root. If any account other than root has a UID of 0, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.6
select add_rule_data ('default','C-30044','SV-3062r1_rule','default','high', 'Ensure root PATH Integrity', 
'The root user can execute any command on the system and could be fooled into executing programs unintentionally if the PATH is not set correctly. 
Including the current working directory (.) or other writable directory in roots executable path makes it likely that an attacker can gain superuser access by forcing an administrator operating as root to execute a Trojan horse program. 
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 
6.2.6 - Red Hat Enterprise
6.2.6 - CentOS', 
'F-30054', 'Correct or justify any items discovered in the Audit step.', 
'[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30054', 'Run the following script and verify no results are returned:#!/bin/bash;if [ "`echo ;PATH | grep ::`" != "" ]; then;echo "Empty Directory in PATH (::)";fi;if [ "`echo ;PATH | grep :;`" != "" ]; then;echo "Trailing : in PATH";fi;p=`echo ;PATH | sed -e "s/::/:/" -e "s/:;//" -e "s/:/ /g"`;set -- ;p;while [ ";1" != "" ]; do;if [ ";1" = "." ]; then;echo "PATH contains .";shift;continue;fi;if [ -d ;1 ]; then;dirperm=`ls -ldH ;1 | cut -f1 -d" "`;if [ `echo ;dirperm | cut -c6` != "-" ]; then;echo "Group Write permission set on directory ;1";fi;if [ `echo ;dirperm | cut -c9` != "-" ]; then;echo "Other Write permission set on directory ;1";fi;dirown=`ls -ldH ;1 | awk "{print ;3}"`;if [ ";dirown" != "root" ] ; then;echo ;1 is not owned by root;fi;else;echo ;1 is not a directory;fi;shift;done;', 'Customized rule by Cloud Raxak') from dual;

--6.2.7
select add_rule_data ('default','V-56019','SV-50462r1_rule','default','high',' All users must have valid home directories.','If the user"s home directory does not exist or is unassigned, the user will be placed in "/" and will not be able to write any files or have local environment variables set.    Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.7 - Red Hat Enterprise. 6.2.7 - CentOS', 'F-56019','If there are users with unassigned home directories, they should be assigned a home directory appropriately.   ' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','','Check the users home directories assigned in the /etc/passwd file awk -F: "$3>=1000 ANDAND $3<=60000 {print $1, $6}" /etc/passwdIf any user"s home directories do not exist, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.8
select add_rule_data ('default','C-30038','SV-3063r1_rule','default','high', 'Ensure users home directories permissions are 750 or more restrictive', 'While the system administrator can establish secure permissions for users home directories, the users can easily override these. Group or world-writable user home directories may enable malicious users to steal or modify other users data or to gain another users system privileges. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.8 - Red Hat Enterprise. 6.2.8 - CentOS', 'F-30038', 'Making global modifications to user home directories without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user file permissions and determine the action to be taken in accordance with site policy', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30038', 'Run the following script and verify no results are returned:;#!/bin/bash;cat /etc/passwd | egrep -v "^(root|halt|sync|shutdown)" | awk -F: "($7 !=;"/sbin/nologin" andand $7 != "/bin/false") { print $1 " " $6 }" | while read user;dir; do;if [ ! -d "$dir" ]; then;echo "The home directory ($dir) of user $user does not exist.";else;dirperm=`ls -ld $dir | cut -f1 -d" "`;if [ `echo $dirperm | cut -c6` != "-" ]; then;echo "Group Write permission set on the home directory ($dir) of user;$user";fi;if [ `echo $dirperm | cut -c8` != "-" ]; then;echo "Other Read permission set on the home directory ($dir) of user;$user";fi;if [ `echo $dirperm | cut -c9` != "-" ]; then;echo "Other Write permission set on the home directory ($dir) of user;$user";fi;if [ `echo $dirperm | cut -c10` != "-" ]; then;echo "Other Execute permission set on the home directory ($dir) of user;$user";fi;fi;done;', 'Customized rule by Cloud Raxak') from dual;

--6.2.9
select add_rule_data ('default','C-30039','SV-3064r1_rule','default','high', 'Ensure users own their home directories', 'The user home directory is space defined for the particular user to set local environment variables and to store personal files. Since the user is accountable for files stored in the user home directory, the user must be the owner of the directory. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.9 - Red Hat Enterprise. 6.2.9 - CentOS', 'F-30039', 'Change the ownership of any home directories that are not owned by the defined user to the correct user.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30039', 'Run the following script and verify no results are returned: #!/bin/bash;cat /etc/passwd | egrep -v "^(root|halt|sync|shutdown)" | awk -F: "($7 !="/sbin/nologin" "{&&}" $7 != "/bin/false") { print $1 " " $6 }" | while read user;dir; do;if [ ! -d "$dir" ]; then;echo "The home directory ($dir) of user $user does not exist.";else;owner=$(stat -L -c "%U" "$dir");if [ "$owner" != "$user" ]; then;echo "The home directory ($dir) of user $user is owned by $owner.";fi;fi;done;', 'Customized rule by Cloud Raxak') from dual;

--6.2.10
select add_rule_data ('default','C-30045','SV-3065r1_rule','default','high', 'Ensure users dot files are not group or world writable', 'While the system administrator can establish secure permissions for users "dot" files, the users can easily override these. 
Group or world-writable user configuration files may enable malicious users to steal or modify other users data or to gain another users system privileges. 
Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 
6.2.10 - Red Hat Enterprise
6.2.10 - CentOS', 
'F-30057', 'Making global modifications to users files without alerting the user community can result in unexpected outages and unhappy users. 
Therefore, it is recommended that a monitoring policy be established to report user dot file permissions and determine the action to be taken in accordance with site policy.', 
'[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent',
'CHK-30057', 'Run the following script and verify no results are returned:
#!/bin/bash
cat /etc/passwd | egrep -v "^(root|halt|sync|shutdown)" | awk -F: "($7 !="/sbin/nologin" "{&&}" $7 != "/bin/false") { print $1 " " $6 }" | while read user
dir; do
 if [ ! -d "$dir" ]; then
 echo "The home directory ($dir) of user $user does not exist."
 else
 for file in $dir/.[A-Za-z0-9]*; do
 if [ ! -h "$file" -a -f "$file" ]; then
 fileperm=`ls -ld $file | cut -f1 -d" "`
 if [ `echo $fileperm | cut -c6` != "-" ]; then
 echo "Group Write permission set on file $file"
 fi
 if [ `echo $fileperm | cut -c9` != "-" ]; then
 echo "Other Write permission set on file $file"
 fi
 fi
 done
 fi
done', 'Customized rule by Cloud Raxak') from dual;

--6.2.11
select add_rule_data ('default','C-30040','SV-3066r1_rule','default','high', 'Ensure no users have .forward files', 'The .forward file specifies an email address to forward the users mail to. Use of the .forward file poses a security risk in that sensitive data may be inadvertently transferred outside the organization. The .forward file also poses a risk as it can be used to execute commands that may perform unintended actions. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.11 - Red Hat Enterprise. 6.2.11 - CentOS', 'F-30040', 'Making global modifications to users files without alerting the user community can result in unexpected outages and unhappy users. Therefore, it is recommended that a monitoring policy be established to report user .forward files and determine the action to be taken in accordance with site policy.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30040', 'Run the following script and verify no results are returned: #!/bin/bash;cat /etc/passwd | egrep -v "^(root|halt|sync|shutdown)" | awk -F: "($7 !="/sbin/nologin" "{&&}" $7 != "/bin/false") { print $1 " " $6 }" | while read user;dir; do;if [ ! -d "$dir" ]; then;echo "The home directory ($dir) of user $user does not exist.";else;if [ ! -h "$dir/.forward" -a -f "$dir/.forward" ]; then;echo ".forward file $dir/.forward exists";fi;fi;done;', 'Customized rule by Cloud Raxak') from dual;

--6.2.12
select add_rule_data ('default','V-38619','SV-50420r2_rule','default','medium','There must be no .netrc files on the system.','Unencrypted passwords for remote FTP servers may be stored in ".netrc" files. DoD policy requires passwords be encrypted in storage and not used in access scripts. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.12 - Red Hat Enterprise. 6.2.12 - CentOS', 'F-43569r2_fix','The ".netrc" files contain logon information used to auto-logon into FTP servers and reside in the user"s home directory. These files may contain unencrypted passwords to remote FTP servers making them susceptible to access by unauthorized users and should not be used. Any ".netrc" files should be removed.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000347','C-46179r3_chk','To check the system for the existence of any ".netrc" files, run the following command: $ find /root /home -iname ".netrc" -type fIf any .netrc files exist, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.13
--select add_rule_data ('default','C-30059','SV-3067r1_rule','default','high', 'TTILE', 'DESCRIPTION Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.13 - Red Hat Enterprise. 6.2.13 - CentOS', 'F-30059', 'FIXDESC', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30059', 'CHECKDESC', 'Customized rule by Cloud Raxak') from dual;

--6.2.14
select add_rule_data ('default','V-38491','SV-50292r1_rule','default','high','There must be no .rhosts or hosts.equiv files on the system.','Trust files are convenient, but when used in conjunction with the R-services, they can allow unauthenticated access to a system. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.14 - Red Hat Enterprise. 6.2.14 - CentOS', 'F-43438r1_fix','The files "/etc/hosts.equiv" and "~/.rhosts" (in each user"s home directory) list remote hosts and users that are trusted by the local system when using the rshd daemon. To remove these files, run the following command to delete them from any location.  find /root /home -iname ".rhosts" -type f | xargs rm {} 2>/dev/null find /etc -iname "hosts.equiv" -type f | xargs rm {} 2>/dev/null' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000019','C-46048r1_chk','The existence of the file named "hosts.equiv" or ".rhosts" inside a user home directory indicates the presence of an Rsh trust relationship, use the command: find /root /home -iname ".rhosts" -type f find /etc -iname "hosts.equiv" -type fIf these files exist, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.15
select add_rule_data ('default','V-38681','SV-50482r2_rule','default','low','All GIDs referenced in /etc/passwd must be defined in /etc/group','Inconsistency in GIDs between /etc/passwd and /etc/group could lead to a user having unintended rights. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.15 - Red Hat Enterprise. 6.2.15 - CentOS', 'F-43630r1_fix','Add a group to the system for each GID referenced without a corresponding group.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000294','C-46243r2_chk','To ensure all GIDs referenced in /etc/passwd are defined in /etc/group, run the following command:  pwck -r | grep "no group"There should be no output. If there is output, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.16
select add_rule_data ('default','V-56073','SV-50462r1_rule','default','high','There must be no duplicate UIDs.','This rule verifies that there are no duplicate UIDs. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.16 - Red Hat Enterprise. 6.2.16 - CentOS', 'F-56073','If there are users with duplicate UIDs, assign a different UID to them by running: usermod -u new_UID user_nameWhere in new_UID will take the new UID to be assigned and user_name is the particular user account"s name.' , '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','RHEL-06-000276','','Check whether there aren"t any duplicate UIDs:$ awk -F: "{print $3}" /etc/passwd | sort | uniq -dIf there is any duplicate UID, this is a finding.','Customized rule by Cloud Raxak') from dual;

--6.2.17
select add_rule_data ('default','C-30041','SV-3068r1_rule','default','high', 'Ensure no duplicate GIDs exist', 'Although the groupadd program will not let you create a duplicate Group ID (GID), it is possible for an administrator to manually edit the /etc/group file and change the GID field. User groups must be assigned unique GIDs for accountability and to ensure appropriate access protections. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.17 - Red Hat Enterprise. 6.2.17 - CentOS', 'F-30060', 'Based on the results of the audit script, establish unique GIDs and review all files owned by the shared GID to determine which group they are supposed to belong to.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30060', 'Run the following script and verify no results are returned:
#!/bin/bash
cat /etc/group | cut -f3 -d":" | sort -n | uniq -c | while read x ; do
 [ -z "${x}" ] "{&&}" break
 set - $x
 if [ $1 -gt 1 ]; then
 groups=`awk -F: "($3 == n) { print $1 }" n=$2 /etc/group | xargs`
 echo "Duplicate GID ($2): ${groups}"
 fi
done', 'Customized rule by Cloud Raxak') from dual;

--6.2.18
select add_rule_data ('default','C-30042','SV-3069r1_rule','default','high', 'Ensure no duplicate user names exist', 'Although the useradd program will not let you create a duplicate user name, it is possible for an administrator to manually edit the /etc/passwd file and change the user name. If a user is assigned a duplicate user name, it will create and have access to files with the first UID for that username in /etc/passwd . For example, if "test4" has a UID of 1000 and a subsequent "test4" entry has a UID of 2000, logging in as "test4" will use UID 1000. Effectively, the UID is shared, which is a security problem. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.18 - Red Hat Enterprise. 6.2.18 - CentOS', 'F-30061', 'Based on the results of the audit script, establish unique user names for the users. File ownerships will automatically reflect the change as long as the users have unique UIDs.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30061', 'Run the following script and verify no results are returned:
#!/bin/bash
cat /etc/passwd | cut -f1 -d":" | sort -n | uniq -c | while read x ; do
 [ -z "${x}" ] "{&&}" break
 set - $x
 if [ $1 -gt 1 ]; then
 uids=`awk -F: "($1 == n) { print $3 }" n=$2 /etc/passwd | xargs`
 echo "Duplicate User Name ($2): ${uids}"
 fi
done', 'Customized rule by Cloud Raxak') from dual;

--6.2.19
select add_rule_data ('default','C-30043','SV-3070r1_rule','default','high', 'Ensure no duplicate group names exist', 'Although the groupadd program will not let you create a duplicate group name, it is possible for an administrator to manually edit the /etc/group file and change the group name. If a group is assigned a duplicate group name, it will create and have access to files with the first GID for that group in /etc/group . Effectively, the GID is shared, which is a security problem. Rulenumber as per CIS Linux 7 Benchmark v2.2.0 (12/27/2017): 6.2.19 - Red Hat Enterprise. 6.2.19 - CentOS', 'F-30062', 'Based on the results of the audit script, establish unique names for the user groups. File group ownerships will automatically reflect the change as long as the groups have unique GIDs.', '[rpm-based Linux] CIS Profile (Full)','Profile Customized by CloudRaxak','cis_rhel_cent','CHK-30062', 'Run the following script and verify no results are returned:
#!/bin/bash
cat /etc/group | cut -f1 -d":" | sort -n | uniq -c | while read x ; do
 [ -z "${x}" ] "{&&}" break
 set - $x
 if [ $1 -gt 1 ]; then
 gids=`gawk -F: "($1 == n) { print $3 }" n=$2 /etc/group | xargs`
 echo "Duplicate Group Name ($2): ${gids}"
 fi
done', 'Customized rule by Cloud Raxak') from dual;
