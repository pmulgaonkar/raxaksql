select add_profile_data ('VMware ESXi Version 5 Virtual Machine' , ' II - Mission Support Classified ','Linux-based OS','https://www.stigviewer.com/stig/vmware_esxi_version_5_virtual_machine/2015-12-03/MAC-2_Classified/' , '2015-12-03' ,'Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39488','SV-51346r1_rule','default','low','"The system must disable VIX messages from the VM."','"The VIX API is a library for writing scripts and programs to manipulate virtual machines. If custom VIX programming is not used in the environment; then disable features to reduce the potential for vulnerabilities. Unprivileged code running in a VMware virtual machine (guest OS) may break out of the VMX process; and elevate from unprivileged guest code execution to host kernel code execution. The ability to send messages from the VM to the host is one of these features. Note that disabling this feature does ""not"" adversely affect the functioning of VIX operations that originate outside the guest; so certain VMware and 3rd party solutions that rely upon this capability should continue to work."','F-44501r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.vixMessage.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46748r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.vixMessage.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39489','SV-51347r3_rule','default','medium','"The system must disconnect unauthorized floppy devices."','"Besides disabling unnecessary virtual devices from within the virtual machine; ensure no device is connected to a virtual machine if it is not required to be there. For example; serial and parallel ports are rarely used for virtual machines in a datacenter environment; and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required; the parameter must be assigned a value of false. NOTE: The parameters listed are not sufficient to ensure a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel."','F-44785r2_fix','"Configure the vmx file with the correct attribute/assignment pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively. Start the ESXi Shell service; where/as required. As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following line to the vmx file. Note that X must be greater than or equal to 0 (based on the system configuration).floppyX.present = ""false""Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46749r4_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server, click on the desired host. Click the Configuration tab. Click Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively. Start the ESXi Shell service, where/as required. \n\nAs root, log in to the ESXi Shell and locate any/all vmx files.\n# find / | grep vmx\n\nCheck the ".vmx" file for the correct attribute/assignment pair. Note that the integer value of X (for the attribute floppyX.present) must be greater than or equal to 0, depending upon the system configuration.\n# grep "^floppy" <the VM"s vmx file>\n\nExample output for the above command: \nfloppyX.present = "false"\n\nIf the floppyX.present attribute (X must be greater than or equal to 0) is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39482','SV-51340r1_rule','default','low','The unexposed feature keyword isolation.tools.unity.push.update.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44495r3_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unity.push.update.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','E','C-46742r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unity.push.update.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39483','SV-51341r1_rule','default','low','The unexposed feature keyword isolation.tools.unity.taskbar.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44496r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unity.taskbar.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000027','C-46743r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unity.taskbar.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39480','SV-51338r1_rule','default','low','The unexposed feature keyword isolation.tools.unity.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44493r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unity.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000024','C-46740r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unity.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39481','SV-51339r1_rule','default','low','The unexposed feature keyword isolation.tools.unityInterlockOperation.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44494r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unityInterlockOperation.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46741r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unityInterlockOperation.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39486','SV-51344r1_rule','default','low','The unexposed feature keyword isolation.tools.vmxDnDVersionGet.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44499r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.vmxDnDVersionGet.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-','C-46746r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.vmxDnDVersionGet.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39487','SV-51345r1_rule','default','low','The unexposed feature keyword isolation.tools.guestDnDVersionSet.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44500r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.guestDnDVersionSet.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46747r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.guestDnDVersionSet.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39484','SV-51342r1_rule','default','low','The unexposed feature keyword isolation.tools.unityActive.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44497r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unityActive.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000028','C-46744r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unityActive.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39485','SV-51343r1_rule','default','low','The unexposed feature keyword isolation.tools.unity.windowContents.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44498r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.unity.windowContents.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46745r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.unity.windowContents.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39477','SV-51335r1_rule','default','low','The unexposed feature keyword isolation.tools.dispTopoRequest.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44490r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.dispTopoRequest.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-V','C-46737r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.dispTopoRequest.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39490','SV-51348r2_rule','default','medium','"The system must disconnect unauthorized IDE devices."','"Besides disabling unnecessary virtual devices from within the virtual machine; ensure no device is connected to a virtual machine if it is not required to be there. For example; serial and parallel ports are rarely used for virtual machines in a datacenter environment; and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required; either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel."','F-44502r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = ideX:Y.present (X and Y >= 0)keyval = FALSE Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46750r3_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = ideX:Y.present (X and Y >= 0)\nkeyval = FALSE \n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the ideX:Y.present keyval is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39508','SV-51366r2_rule','default','medium','The system must control access to VMs through the VMsafe CPU/memory vmsafe.enable API.','"The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs; for the purpose of detecting and preventing malware attacks. However; an attacker might compromise the VM by making use of this introspection channel; therefore it should be monitored for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API; one to set the IP address used by the security virtual appliance on the introspection vSwitch; and one to set the port number for that IP address. If the VM is being protected by such a product; then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which this protection is wanted."','F-44520r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = vmsafe.enablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46768r3_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = vmsafe.enable\nkeyval = TRUE (if the VMSafe API is used)\nkeyval = FALSE (if the VMSafe API is "not" used)\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the keyval is set to "TRUE" and use of the VMSafe API is required, this is not a finding.\n\nOtherwise, if the keyval is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39461','SV-51319r1_rule','default','low','The unexposed feature keyword isolation.tools.memSchedFakeSampleStats.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44473r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.memSchedFakeSampleStats.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46734r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.memSchedFakeSampleStats.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39462','SV-51320r1_rule','default','low','The unexposed feature keyword isolation.tools.ghi.protocolhandler.info.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44475r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.ghi.protocolhandler.info.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46735r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.ghi.protocolhandler.info.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39463','SV-51321r1_rule','default','low','The unexposed feature keyword isolation.ghi.host.shellAction.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44476r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.ghi.host.shellAction.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000','C-46736r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.ghi.host.shellAction.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39446','SV-51304r1_rule','default','low','"The system must explicitly disable any GUI functionality for copy/paste operations."','"Copy and paste operations are disabled by default; however; by explicitly disabling this feature it will enable audit controls to check that this setting is correct. Copy; paste; drag and drop; or GUI copy/paste operations between the guest OS and the remote console could provide the means for an attacker to compromise the VM."','F-44459r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.setGUIOptions.enablekeyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000005','C-46721r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.setGUIOptions.enable\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39447','SV-51305r1_rule','default','low','"The system must explicitly disable paste operations."','"Copy and paste operations are disabled by default; however; by explicitly disabling this feature it will enable audit controls to check that this setting is correct. Copy; paste; drag and drop; or GUI copy/paste operations between the guest OS and the remote console could provide the means for an attacker to compromise the VM."','F-44460r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.paste.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000006','C-46722r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.paste.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39444','SV-51302r1_rule','default','low','"The system must explicitly disable copy operations."','"Copy and paste operations are disabled by default; however; by explicitly disabling this feature it will enable audit controls to check that this setting is correct. Copy; paste; drag and drop; or GUI copy/paste operations between the guest OS and the remote console could provide the means for an attacker to compromise the VM."','F-44457r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.copy.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000003','C-46719r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.copy.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39445','SV-51303r2_rule','default','low','"The system must explicitly disable drag and drop operations."','"Copy and paste operations are disabled by default; however; by explicitly disabling this feature it will enable audit controls to check that this setting is correct. Copy; paste; drag and drop; or GUI copy/paste operations between the guest OS and the remote console could provide the means for an attacker to compromise the VM."','F-44458r3_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.dnd.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000004','C-46720r4_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.dnd.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the keyval is set to "FALSE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39442','SV-51300r2_rule','default','high','The system must control virtual machine access to host resources.','"By default; all virtual machines on an ESXi host share the resources equally. By using the resource management capabilities of ESXi; such as shares and limits; you can control the server resources that a virtual machine consumes.  You can use this mechanism to prevent a denial of service that causes one virtual machine to consume so much of the hosts resources that other virtual machines on the same host cannot perform their intended functions."','F-44455r2_fix','"From the vCenter client; select the Datacenter/host. Right-click the VM select Edit Settings to configure the virtual machines memory and/or CPU limits; shares; and/or reservation(s). Appropriate values must be set for memory; CPU; advanced CPU; and disk variables. With the appropriate (site-specific) level selected for the VM; select the OK button to save any change(s)."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000001','C-46717r4_chk','Virtual machines (VMs) that have a greater risk of being exploited or attacked, or that run applications known to potentially consume resources must be constrained. From the vSphere Client/vCenter, select the Datacenter/host. Right-click the VM, select Edit Settings to check the virtual machine"s memory and/or CPU shares, limits, and/or reservation(s). Appropriate values must be set for memory, CPU, advanced CPU, and disk variables. Care must be taken to ensure that the settings do not hamper dynamic resource allocation and management proper to virtualization systems.\n\nIf any host VMs do not have share, limit, and/or reservation setpoints initialized, as appropriate to their respective levels of the risk of exploit or attack, this is a finding.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39443','SV-51301r1_rule','default','low','"The system must disable tools auto install."','"Tools auto install can initiate an automatic reboot; disabling this option will prevent tools from being installed automatically and prevent automatic machine reboots."','F-44456r4_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.autoInstall.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000002','C-46718r4_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.autoInstall.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39505','SV-51363r1_rule','default','low','"The system must control access to VMs through the dvfilter network APIs."','"A VM must be configured explicitly to accept access by the dvfilter network API. This should be performed only for VMs that require the dvfilter network API. An attacker might compromise the VM by making use of this introspection channel."','F-44517r2_fix','"To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively. Start the ESXi Shell service; where/as required. As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.ethernet0.filter1.name = dv-filter1Where ""ethernet0"" is the network adaptor interface of the virtual machine that is to be protected; ""filter1"" is the number of the filter that is being used; and ""dv-filter1"" is the name of the particular data path kernel module that is protecting the VM.Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46765r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server, click on the desired host. Click the Configuration tab. Click Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively. Start the ESXi Shell service, where/as required. As root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nIf a VM is not supposed to be protected by a product using the dvfilter API, ensure the following is not present in its VMX file: \n\nethernet0.filter1.name = dv-filter1\n\nwhere "ethernet0" is the network adaptor interface of the virtual machine that is to be protected, "filter1" is the number of the filter that is being used, and "dv-filter1" is the name of the particular data path kernel module that is protecting the VM. If the VM is supposed to be protected, check that the name of the data path kernel is set correctly.\n# grep "^ethernet" <the VM"s vmx file>\n\nIf a dvfilter is not being used, and the above command return is empty, this is not a finding.\n\nIf a dvfilter is being used, and the above command return is either empty or does not contain the correctly formatted network adaptor interface, filter number , and data path kernel module, this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39504','SV-51362r1_rule','default','low','"The system must use templates to deploy VMs whenever possible."','"By capturing a hardened base operating system image (with no applications installed) in a template; ensure all virtual machines are created with a known baseline level of security. Then use this template to create other; application-specific templates; or use the application template to deploy virtual machines. Manual installation of the OS and applications into a VM introduces the risk of misconfiguration due to human or process error."','F-44516r1_fix','"Hardened; patched templates must be used for VM creation; properly configured OS deployments and applications. Applications dependent on VM-specific information must also use hardened; patched templates."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000050','C-46764r1_chk','Ask the SA if hardened, patched templates are used for VM creation, properly configured OS deployments, including applications both dependent and non-dependent on VM-specific configurations.\n\n\n\n\nIf hardened, patched templates are not used for VM creation, this is a finding.\n\n\n\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39448','SV-51306r1_rule','default','high','"The system must disable virtual disk shrinking."','"Shrinking a virtual disk reclaims unused space in it. If there is empty space in the disk; this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes-that is; users and processes without root or administrator privileges-within virtual machines have the capability to invoke this procedure. However; if this is done repeatedly; the virtual disk can become unavailable while this shrinking is being performed; effectively causing a denial-of-service. In most datacenter environments; disk shrinking is not done; so this feature must be disabled. Repeated disk shrinking can make a virtual disk unavailable. The capability to shrink is available to non-administrative users operating within the VMs guest OS."','F-44461r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.diskShrink.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46723r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.diskShrink.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39449','SV-51307r1_rule','default','high','"The system must disable virtual disk erasure."','"Shrinking and wiping (erasing) a virtual disk reclaims unused space in it. If there is empty space in the disk; this process reduces the amount of space the virtual disk occupies on the host drive. Normal users and processes - that is; users and processes without root or administrator privileges - within virtual machines have the capability to invoke this procedure. However; if this is done repeatedly; the virtual disk can become unavailable while this shrinking is being performed; effectively causing a denial-of-service. In most datacenter environments; disk shrinking is not done; so this feature must be disabled. Repeated disk shrinking can make a virtual disk unavailable. The capability to wipe (erase) is available to non-administrative users operating within the VMs guest OS."','F-44463r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.diskWiper.disable keyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46724r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.diskWiper.disable \nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39503','SV-51361r1_rule','default','medium','"The system must use secure protocols for virtual serial port access."','"Serial ports are interfaces for connecting peripherals to the virtual machine. They are often used on physical systems to provide a direct; low-level connection to the console of a server; and a virtual serial port allows for the same access to a virtual machine. Serial ports allow for low-level access; which often does not have strong controls like logging or privileges."','F-44515r1_fix','"Use a secure protocol like SSH or Telnets (Telnet with SSL) as opposed to Telnet to access virtual serial ports. Note that SSH is preferred to Telnets."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000049','C-46763r1_chk','Ask the SA if a secure protocol like SSH or Telnets (Telnet with SSL) as opposed to Telnet to access virtual serial ports. Note that SSH is preferred to Telnets.\n\n\nIf Telnet is used, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39499','SV-51357r1_rule','default','medium','"The system must prevent unauthorized removal; connection and modification of devices by setting the isolation.device.connectable.disable keyword to true."','"Normal users and processes-that is; users and processes without root or administrator privileges-within virtual machines have the capability to connect or disconnect devices; such as network adaptors and CD-ROM drives; as well as the ability to modify device settings. In general; the virtual machine settings should use editor or configuration editor to remove any unneeded or unused hardware devices. However; the device may need to be used again; so removing it is not always a good solution. In that case; prevent a user or running process in the virtual machine from connecting or disconnecting a device from within the guest operating system; as well as modifying devices; by adding the following parameters. By default; a rogue user with non-administrator privileges in a virtual machine can connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive."','F-44511r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.device.connectable.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46759r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.device.connectable.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39498','SV-51356r1_rule','default','medium','"The system must minimize use of the VM console."','"The VM console enables a connection to the console of a virtual machine; in effect seeing what a monitor on a physical server would show. The VM console also provides power management and removable device connectivity controls; which might potentially allow a malicious user to bring down a virtual machine. In addition; it also has a performance impact on the service console; especially if many VM console sessions are open simultaneously."','F-44510r1_fix','"Develop a policy prohibiting the use of a VM console for performing management services. This policy should include procedures for the use of SSH and Terminal Management services for VM management. Where SSH and Terminal Management services prove insufficient to troubleshoot a VM; access to the VM console may be temporarily granted for simultaneous."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000044','C-46758r1_chk','Remote management services, such as terminal services and SSH, must be used to interact with virtual machines. VM console access should only be granted when remote management services are unavailable or insufficient to perform necessary management tasks.\n\nAsk the SA if a VM console is used to perform VM management tasks, other than for troubleshooting (non-management) VM performance issues. \n\nIf a VM console is used to perform VM management tasks, other than for troubleshooting (non-management) VM performance issues, this is a finding. \n\n\nIf SSH and/or terminal management services are exclusively used to perform management tasks, this is not a finding.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39495','SV-51353r1_rule','default','medium','"The system must limit VM logging records."','"Use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted; so the file can grow to be quite large. Ensure new log files are created more frequently by limiting the maximum size of the log files. If restricting the total size of logging data is wanted; VMware recommends saving 10 log files; each one limited to 1;000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB; so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log; the size of the log is checked; if it is over the limit; the next entry is written to a new log. If the maximum number of log files already exists; when a new one is created; the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB; so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial-of-service due to the datastore becoming filled."','F-44507r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = log.keepOldkeyval = 10Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46755r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = log.keepOld\nkeyval = 10\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding. NOTE: This setting has no effect on VMs that already have logging disabled. This setting, however, will enforce the limiting of VM logging records should there be a "temporary" need to enable VM logging to troubleshoot a VM performance issue.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39494','SV-51352r1_rule','default','medium','"The system must limit sharing of console connections."','"By default; remote console sessions can be connected to by more than one user at a time.  When multiple sessions are activated; each terminal window gets a notification about the new session. If an administrator in the VM logs in using a VMware remote console during their session; a non-administrator in the VM might connect to the console and observe the administrators actions.  Also; this could result in an administrator losing console access to a virtual machine. For example; if a jump box is being used for an open console session and the admin loses connection to that box; then the console session remains open. Allowing two console sessions permits debugging via a shared session.  For highest security; only one remote console session at a time should be allowed."','F-44506r4_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = RemoteDisplay.maxConnectionskeyval = 1Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46754r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = RemoteDisplay.maxConnections\nkeyval = 1\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39497','SV-51355r1_rule','default','low','"The system must limit informational messages from the VM to the VMX file."','"The configuration file containing these name-value pairs is limited to a size of 1MB. If not limited; VMware tools in the guest OS are capable of sending a large and continuous data stream to the host. This 1MB capacity should be sufficient for most cases; but this value can change if necessary. The value can be increased if large amounts of custom information are being stored in the configuration file. The default limit is 1MB."','F-44509r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = tools.setinfo.sizeLimitkeyval = 1048576Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000043','C-46757r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = tools.setinfo.sizeLimit\nkeyval = 1048576\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39496','SV-51354r1_rule','default','medium','"The system must limit VM logging record contents."','"Use these settings to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted; so the file can grow to be quite large. Ensure new log files are created more frequently by limiting the maximum size of the log files. If restricting the total size of logging data is wanted; VMware recommends saving 10 log files; each one limited to 1;000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB; so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log; the size of the log is checked; if it is over the limit; the next entry is written to a new log. If the maximum number of log files already exists; when a new one is created; the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB; so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial-of-service due to the datastore becoming filled."','F-44508r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = log.rotateSize keyval = 100000Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46756r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = log.rotateSize \nkeyval = 100000\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39491','SV-51349r2_rule','default','medium','"The system must disconnect unauthorized parallel devices."','"Besides disabling unnecessary virtual devices from within the virtual machine; ensure no device is connected to a virtual machine if it is not required to be there. For example; serial and parallel ports are rarely used for virtual machines in a datacenter environment; and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required; either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel."','F-44503r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = parallelX.present (X >= 0)keyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46751r3_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = parallelX.present (X >= 0)\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the keyval is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39501','SV-51359r1_rule','default','medium','"The system must not send host information to guests."','"If enabled; a VM can obtain detailed information about the physical host. The default value for the parameter is FALSE. This setting should not be TRUE unless a particular VM requires this information for performance monitoring. An adversary potentially can use this information to inform further attacks on the host."','F-44513r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = tools.guestlib.enableHostInfokeyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000047','C-46761r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = tools.guestlib.enableHostInfo\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39493','SV-51351r2_rule','default','medium','"The system must disconnect unauthorized USB devices."','"Besides disabling unnecessary virtual devices from within the virtual machine; ensure no device is connected to a virtual machine if it is not required to be there. For example; serial and parallel ports are rarely used for virtual machines in a datacenter environment; and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required; either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel."','F-44505r2_fix','"If USB is required; no fix is required.Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = usb.presentkeyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46753r3_chk','If USB is required, this check is not applicable.\n\nTemporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = usb.present\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the usb.present keyval is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39492','SV-51350r2_rule','default','medium','"The system must disconnect unauthorized serial devices."','"Besides disabling unnecessary virtual devices from within the virtual machine; ensure no device is connected to a virtual machine if it is not required to be there. For example; serial and parallel ports are rarely used for virtual machines in a datacenter environment; and CD/DVD drives are usually connected only temporarily during software installation. For less commonly used devices that are not required; either the parameter should not be present or its value must be FALSE. NOTE: The parameters listed are not sufficient to ensure a device is usable; other parameters are required to indicate specifically how each device is instantiated. Any enabled or connected device represents another potential attack channel."','F-44504r3_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = serialX.present (X >= 0)keyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46752r5_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = serialX.present (X >= 0)\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the keyval is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39500','SV-51358r1_rule','default','medium','"The system must prevent unauthorized removal; connection and modification of devices."','"Normal users and processes-that is; users and processes without root or administrator privileges-within virtual machines have the capability to connect or disconnect devices; such as network adaptors and CD-ROM drives; as well as the ability to modify device settings. In general; the virtual machine settings should use editor or configuration editor to remove any unneeded or unused hardware devices. However; the device may need to be used again; so removing it is not always a good solution. In that case; prevent a user or running process in the virtual machine from connecting or disconnecting a device from within the guest operating system; as well as modifying devices; by adding the following parameters. By default; a rogue user with non-administrator privileges in a virtual machine can connect a disconnected CD-ROM drive and access sensitive information on the media left in the drive."','F-44512r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.device.edit.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46760r3_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.device.edit.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39507','SV-51365r1_rule','default','medium','The system must control access to VMs through the VMsafe CPU/memory vmsafe.agentPort API.','"The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs; for the purpose of detecting and preventing malware attacks. However; an attacker might compromise the VM by making use of this introspection channel; therefore it should be monitored for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API; one to set the IP address used by the security virtual appliance on the introspection vSwitch; and one to set the port number for that IP address. If the VM is being protected by such a product; then make sure the latter two parameters are set correctly.  This should be done only for specific VMs for which this protection is wanted. "','F-44519r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = vmsafe.agentPortkeyval = nnnn (nnnn is the port number that the VMsafe CPU/memory used to connect to the introspection virtual switch)Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46767r2_chk','If the VMsafe API is not used, this check is not applicable.\n\nTemporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = vmsafe.agentPort\nkeyval = nnnn (nnnn is the port number that the VMsafe CPU/memory used to connect to the introspection virtual switch)\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), and the VMsafe API is used, this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39506','SV-51364r1_rule','default','medium','"The system must control access to VMs through VMsafe CPU/memory APIs."','"The VMsafe CPU/memory API allows a security virtual machine to inspect and modify the contents of the memory and CPU registers on other VMs; for the purpose of detecting and preventing malware attacks. However; an attacker might compromise the VM by making use of this introspection channel; therefore it should be monitored for unauthorized usage of this API. A VM must be configured explicitly to accept access by the VMsafe CPU/memory API. This involves three parameters: one to enable the API; one to set the IP address used by the security virtual appliance on the introspection vSwitch; and one to set the port number for that IP address. If the VM is being protected by such a product; then make sure the latter two parameters are set correctly. This should be done only for specific VMs for which this protection is wanted."','F-44518r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = vmsafe.agentAddresskeyval = www.xxx.yyy.zzz (w thru z are integer values of the agents site-specific IP Address)Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46766r2_chk','If the VMsafe API is not used, this check is not applicable.\n\nTemporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = vmsafe.agentAddress\nkeyval = www.xxx.yyy.zzz (w thru z are integer values of the agent"s site-specific IP Address)\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), and the VMsafe API is used, this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39451','SV-51309r3_rule','default','high','"The system must not use independent; non-persistent disks."','"The security issue with non-persistent disk mode is that successful attackers; with a simple shutdown or reboot; might undo or remove any traces that they were ever on the machine. To safeguard against this risk; production virtual machines should be set to use persistent disk mode; additionally; ensure activity within the VM is logged remotely on a separate server; such as a syslog server or equivalent Windows-based event collector. Without a persistent record of activity on a VM; administrators might never know whether they have been attacked or hacked."','F-44465r4_fix','"Configure the vmx file with the correct attribute/assignment pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively. Start the ESXi Shell service; where/as required. As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following line to the vmx file. Note that X and Y must be greater than or equal to 0 (based on the system configuration).scsiX:Y.mode = ""independent-persistent""Re-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46726r5_chk','If a virtual machine does not utilize independent disks, this is not applicable\n\nTemporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log on with appropriate credentials. If connecting to vCenter Server, click on the desired host. Click the Configuration tab. Click Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively. Start the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate any/all vmx files.\n# find / | grep vmx\n\nCheck the ".vmx" file for the correct attribute/assignment pair. Note that the integer values of both X and Y (for the attribute scsiX:Y.mode) must be greater than or equal to 0 , depending upon the system configuration.\n# grep "^scsi" <the VM"s vmx file> | grep independent\n\nExample output for the above command:\nscsi2:0.mode = "independent-persistent"\n\nIf the attribute assignment is not "independent-persistent", this is a finding.\nRe-enable Lockdown Mode on the host.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39450','SV-51308r1_rule','default','medium','"The system must disable HGFS file transfers."','"Certain automated operations such as automated tools upgrades; use a component into the hypervisor called ""Host Guest File System"" and an attacker could potentially use this to transfer files inside the guest OS."','F-44464r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.hgfsServerSet.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000009','C-46725r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.hgfsServerSet.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39453','SV-51311r2_rule','default','medium','"The system must disable VM logging; unless required."','"Excessive VM logging may degrade system performance. The following settings can be used to limit the total size and number of log files. Normally a new log file is created only when a host is rebooted; so the file can grow to be quite large. Ensure new log files are created more frequently by limiting the maximum size of the log files. To restrict the total size of logging data; VMware recommends saving 10 log files; each one limited to 1;000KB. Datastores are likely to be formatted with a block size of 2MB or 4MB; so a size limit too far below this size would result in unnecessary storage utilization. Each time an entry is written to the log; the size of the log is checked; if it is over the limit; the next entry is written to a new log. If the maximum number of log files already exists; when a new one is created; the oldest log file is deleted. A denial-of-service attack that avoids these limits might be attempted by writing an enormous log entry. But each log entry is limited to 4KB; so no log files are ever more than 4KB larger than the configured limit. A second option is to disable logging for the virtual machine. Disabling logging for a virtual machine makes troubleshooting challenging and support difficult. Do not consider disabling logging unless the log file rotation approach proves insufficient. Uncontrolled logging can lead to denial-of-service due to the datastore becoming filled."','F-44467r2_fix','"VM logging should be disabled by default; unless required for troubleshooting. To disable logging for a VM with logging enabled; configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = loggingkeyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','','C-46728r2_chk','If VM log file rotation is not degrading system performance and the VM requires logging to be enabled for troubleshooting, this check is not applicable.\n\nTemporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = logging\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the logging keyword is set to "TRUE", this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39452','SV-51310r1_rule','default','medium','"The system must disable VM-to-VM communication through VMCI."','"If the interface is not restricted; a VM can detect and be detected by all other VMs with the same option enabled within the same host. This might be the intended behavior; but custom-built software can have unexpected vulnerabilities that might potentially lead to an exploit. Additionally; it is possible for a VM to detect how many other VMs are within the same ESX system by simply registering the VM. This information might also be used for a potentially malicious objective. By default; the setting is FALSE. The VM can be exposed to other VMs within the same system as long as there is at least one program connected to the VMCI socket interface."','F-44466r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = vmci0.unrestrictedkeyval = FALSERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ',':','C-46727r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = vmci0.unrestricted\nkeyval = FALSE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39454','SV-51312r1_rule','default','medium','"The system must disable VM Monitor Control during normal operation."','"When Virtual Machines are running on a hypervisor they are ""aware"" that they are running in a virtual environment and this information is available to tools inside the guest OS.  This can give attackers information about the platform that they are running on that they may not get from a normal physical server.  This option completely disables all hooks for a virtual machine and the guest OS will not be aware that it is running in a virtual environment at all. This feature may be enabled for short term diagnostics and troubleshooting; but must be disabled prior to resumption of normal operations."','F-44468r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.monitor.control.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000','C-46729r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.monitor.control.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39457','SV-51315r1_rule','default','low','The unexposed feature keyword isolation.bios.bbs.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44784r1_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.bios.bbs.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000015','C-46731r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.bios.bbs.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39456','SV-51314r1_rule','default','low','The unexposed feature keyword isolation.tools.ghi.autologon.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44469r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.ghi.autologon.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-0000','C-46730r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.ghi.autologon.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39459','SV-51317r1_rule','default','low','The unexposed feature keyword isolation.tools.ghi.launchmenu.change must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44472r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.ghi.launchmenu.changekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-0000','C-46733r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.ghi.launchmenu.change\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39458','SV-51316r1_rule','default','low','The unexposed feature keyword isolation.tools.getCreds.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44471r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.getCreds.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000016','C-46732r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.getCreds.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39479','SV-51337r1_rule','default','low','The unexposed feature keyword isolation.tools.ghi.trayicon.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44492r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.ghi.trayicon.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000023','C-46739r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.ghi.trayicon.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-39478','SV-51336r1_rule','default','low','The unexposed feature keyword isolation.tools.trashFolderState.disable must be initialized to decrease the VMs potential attack vectors.','"Because VMware virtual machines are designed to work on both vSphere; as well as; hosted virtualization platforms; such as Workstation and Fusion; there are some VMX parameters that do not apply when running on vSphere.  Although the functionality governed by these parameters is not exposed on ESX; explicitly disabling them will reduce the potential for vulnerabilities.  Disabling these features reduces the number of vectors through which a guest can attempt to influence the host; and thus may help prevent successful exploits."','F-44491r2_fix','"Configure the VM with the correct ""<keyword> = <keyval>"" pair. To edit a powered-down virtual machines .vmx file; first remove it from vCenter Servers inventory. Manual additions to the .vmx file from ESXi will be overwritten by any registered entries stored in the vCenter Server database. Make a backup copy of the .vmx file. If the edit breaks the virtual machine; it can be rolled back to the original version of the file. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Remove from inventory.Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Software; Security Profile; Services; Properties; ESXi Shell; and Options; respectively.Start the ESXi Shell service; where/as required.As root; log in to the ESXi host and locate the VMs vmx file.  find / | grep vmxAdd the following to the VMs vmx file.keyword = ""keyval""Where:keyword = isolation.tools.trashFolderState.disablekeyval = TRUERe-enable Lockdown Mode on the host.Re-register the VM with the vCenter Server:Open the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. If connecting to vCenter Server; click on the desired host. Click the Configuration tab. Click Storage. Right-click on the appropriate datastore and click Browse Datastore. Navigate to the folder named after the virtual machine; and locate the <virtual machine>.vmx file. Right-click the .vmx file and click Add to inventory. The Add to Inventory wizard opens. Continue to follow the wizard to add the virtual machine."','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI','C-46738r2_chk','Temporarily disable Lockdown Mode and enable the ESXi Shell via the vSphere Client. \n\nOpen the vSphere/VMware Infrastructure (VI) Client and log in with appropriate credentials. \nIf connecting to vCenter Server, click on the desired host. \nClick the Configuration tab. \nClick Software, Security Profile, Services, Properties, ESXi Shell, and Options, respectively.\nStart the ESXi Shell service, where/as required.\n\nAs root, log in to the ESXi Shell and locate the VM"s vmx file.\n# find / | grep vmx\n\nCheck the VM"s ".vmx" file for the correct "<keyword> = <keyval>" pair.\nkeyword = isolation.tools.trashFolderState.disable\nkeyval = TRUE\n# grep "^<keyword>" <the VM"s vmx file>\n\nIf the above command return is either empty or does not reflect the above keyword and keyval value(s), this is a finding.\n\nRe-enable Lockdown Mode on the host.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','','','default','','','','','','VMware ESXi Version 5 Virtual Machine',' II - Mission Support Classified ','ESXI5-VM-000001','C-46717r4_chk','Virtual machines (VMs) that have a greater risk of being exploited or attacked, or that run applications known to potentially consume resources must be constrained. From the vSphere Client/vCenter, select the Datacenter/host. Right-click the VM, select Edit Settings to check the virtual machine"s memory and/or CPU shares, limits, and/or reservation(s). Appropriate values must be set for memory, CPU, advanced CPU, and disk variables. Care must be taken to ensure that the settings do not hamper dynamic resource allocation and management proper to virtualization systems.\n\nIf any host VMs do not have share, limit, and/or reservation setpoints initialized, as appropriate to their respective levels of the risk of exploit or attack, this is a finding.','Imported data from UCF - DISA') from dual;
