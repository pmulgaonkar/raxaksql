select add_profile_data ('HP-UX SMSE' , ' III - Administrative Sensitive ','Linux-based OS','https://www.stigviewer.com/stig/hp-ux_smse/2014-02-28/MAC-3_Sensitive/' , '2014-02-28' ,'Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40446','SV-52433r1_rule','default','medium','The ability to boot the system into single user mode must be restricted to root.','"Single user mode access must be strictly limited to the privileged user root. The ability to boot to single user mode allows a malicious user the opportunity to modify; compromise; or otherwise damage the system."','F-45395r1_fix','"For Trusted Mode:If single user boot authentication is disabled; use the System Administration Manager (SAM) or the System Management Homepage (SMH) to allow single user boot for root only.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute. See the below example:BOOT_USERS=rootNote: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0230','C-47006r1_chk','For Trusted Mode:\nProtected password database files are maintained in the /tcb/files/auth hierarchy. This directory contains other directories each named with a single letter from the alphabet. User authentication profiles are stored in these directories based on the first letter of the user account name. Next check that only root is authorized to boot into single user mode.\n# grep \u201c:u_bootauth:\u201d /tcb/files/auth/[a-z,A-Z]/"\n\nIf any non-root users have been granted single user boot privileges, this is a finding.\n\nFor SMSE:\nCheck the /etc/default/security file for the following attribute(s) and attribute values:\nBOOT_USERS=root (Note: BOOT_USERS attribute values are comma delimited strings).\n# grep \u201cBOOT_USERS\u201d /etc/default/security /var/adm/userdb/"\n\nIf the BOOT_USERS attribute contains any username other than root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22339','SV-38340r2_rule','default','medium','"The /etc/shadow file (or equivalent) must be group-owned by root; bin; sys or other."','The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  The file also contains password hashes which must not be accessible to users other than root.','F-31655r2_fix','"For Trusted Mode: chgrp root /tcbchgrp root /tcb/files /tcb/files/auth chgrp root  /tcb/files/auth/[a-z]/* For SMSE: chgrp root /etc/shadow "','HP-UX SMSE',' III - Administrative Sensitive ','GEN001410','C-36356r2_chk','For Trusted Mode:\nCheck the TCB auth files and directories.\n# ls -lLd /tcb /tcb/files /tcp/files/auth \n# ls -lL /tcb/files/auth/[a-z,A-Z]/"\n\nIf the group-owner of any of the /tcb files and directories is not root, bin, sys, or other, this is a finding.\n\nFor SMSE:\nCheck the /etc/shadow file.\n# ls -lL /etc/shadow\n\nIf the /etc/shadow file is not group-owned by root, bin, sys or other, this is a finding. \n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-4084','SV-38417r2_rule','default','medium','The system must prohibit the reuse of passwords within five iterations.','"If a user; or root; used the same password continuously or was allowed to change it back shortly after being forced to change it; this would provide a potential intruder with the opportunity to keep guessing at one users password until it was guessed correctly."','F-31540r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /etc/default/security file and update the PASSWORD_HISTORY_DEPTH attribute. See the below example:PASSWORD_HISTORY_DEPTH=5If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_HISTORY_DEPTH attribute. See the below example:PASSWORD_HISTORY_DEPTH=5Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000800','C-36283r2_chk','For Trusted Mode:\nCheck the PASSWORD_HISTORY_DEPTH setting.\n# cat /etc/default/security | grep PASSWORD_HISTORY_DEPTH \n\nIf PASSWORD_HISTORY_DEPTH is not set to 5 or greater, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_HISTORY_DEPTH setting.\n# grep PASSWORD_HISTORY_DEPTH /etc/default/security /var/adm/userdb/"\n\nIf PASSWORD_HISTORY_DEPTH is not set to 5 or greater, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-960','SV-38681r2_rule','default','medium','The system must be configured to operate in a security mode.','"When operating in standard  mode; account passwords are stored in the /etc/passwd file; which is world readable. By operating in either Trusted Mode or Standard Mode with Security Extensions; the system security posture is enhanced thru the addition of a secure; non-world readable password container other than /etc/passwd."','F-33047r2_fix','"SAM/SMH must be used to convert standard mode HP-UX to Trusted Mode (optional for SMSE). For Trusted Mode only:The following command may be used to “manually” convert from Standard Mode to Trusted Mode (note that its use is not vendor supported): tsconvert -cFor SMSE only:The following command may be used to “manually” create the /etc/shadow file with information from the /etc/passwd file (use of this commend is vendor supported). pwconvNote that additional software bundles and/or patches may be required in order to completely convert a standard mode system to SMSE."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0020','C-2278r3_chk','For Trusted Mode, determine if the /tcb directory tree exists.\n# ls -lLd /tcb\nIf the /tcb directory tree does not exist, this is a finding.\n\nFor SMSE:\nDetermine if the userdb directory tree and the /etc/shadow file exists.\n# ls -lL /var/adm/userdb\n# ls -lL /etc/shadow\n\nIf both the /var/adm/userdb directory tree and the /etc/shadow file do not exist, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-941','SV-35206r2_rule','default','medium','The systems access control program must log each system’s access attempt.','"If access attempts are not logged; then multiple attempts to log on to the system by an unauthorized user may go undetected."','F-32112r1_fix','"Configure the access restriction program to log every access attempt. Ensure the implementation instructions for TCP_WRAPPERS are followed so logging of system access attempts is logged into the system log files. If an alternate application is used; it must support this function.   "','HP-UX SMSE',' III - Administrative Sensitive ','GEN006600','C-35049r2_chk','Normally, tcpd logs to the mail facility in the syslog.conf file (normally located within the /etc directory). Determine if syslog is configured to log events by tcpd.\n# find /etc -type f -name syslog.conf\n# cat <path>/syslog.conf | tr "\\011" " " | tr -s " " | sed -e "s/^[ \\t]"//" |grep -v \u201c^#\u201d | egrep \u201cmail.debug|mail.info|mail.\\"\u201d\n\nLook for an entry similar to the following, indicating that mail alerts are being logged:\nmail." /var/log/maillog\n\nIf no entries for mail exist, then tcpd is not logging and this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40350','SV-52330r1_rule','default','medium','"userdb database must not be used to override the system-wide variables in the security file; unless required."','The user database stores per-user information. It consists of the /var/adm/userdb directory and the files within it. A per-user value in /var/adm/userdb will override any corresponding system-wide default configured in the /etc/default/security file. Allowing per-user files to relax system-wide security settings creates potential security gaps that can compromise overall system security.','F-45321r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Delete any configured users from the /var/adm/userdb database: /usr/sbin/userdbset -d -u <user>Restart auditing: /sbin/init.d/auditing stop /sbin/init.d/auditing start	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0200','C-46983r1_chk','If the system is operating in Trusted Mode, this check is not applicable.\n\nFor SMSE:\nCheck the /var/adm/userdb database for individual user settings: \n# /usr/sbin/userdbget -a\n\nIf the \u201cuserdb\u201d database is used exclusively to enhance/tighten the security requirements as defined in the /etc/default/security file (see the following example), this is not a finding.\nExample: /etc/default/security requires a MIN_PASSWORD_LENGTH attribute setting of N=14 and specific per user attribute values in /var/adm/userdb are set to 15.\n\nIf any user information is returned that is greater than the required attribute setpoint in the/etc/default/security file (see the following example), this is a finding.\nExample: /etc/default/security requires a MIN_PASSWORD_LENGTH attribute setting of N=14 and specific per user attribute values in /var/adm/userdb are set to 13.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22702','SV-38406r2_rule','default','medium','"System audit logs must be group-owned by root; bin; sys; or other."','Sensitive system and user information could provide a malicious user with enough information to penetrate further into the system.','F-31789r2_fix','"As root; change the group ownership. chgrp root  <audit directory> chgrp root  <audit file>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002690','C-36450r2_chk','Inspect the auditing configuration file, /etc/rc.config.d/auditing, to determine the filename and path of the audit logs. The entries should appear similar to the following:\nPRI_AUDFILE=/var/.audit/file1\nSEC_AUDFILE=/var/.audit/file2\n\n# egrep \u201cPRI_AUDFILE|SEC_AUDFILE\u201d /etc/rc.config.d/auditing\n\nFor each audit log directory/file, check the group ownership.\n# ls -lLd <audit directory>\n# ls -lLa <audit file>\n\nIf any audit log directory/file is not group-owned by root, bin, sys, or other, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22298','SV-26319r2_rule','default','low','"The system must limit users to 10 simultaneous system logins; or a site-defined number; in accordance with operational requirements."','"Limiting simultaneous user logins can insulate the system from Denial of Service problems caused by excessive logins. Automated login processes operating improperly or maliciously may result in an exceptional number of simultaneous login sessions.If the defined value of 10 logins does not meet operational requirements; the site may define the permitted number of simultaneous login sessions based on operational requirements.This limit is for the number of simultaneous login sessions for EACH user account. This is NOT a limit on the total number of simultaneous login sessions on the system."','F-31517r2_fix','"For Trusted Mode:Use the SAM/SMH interface (/etc/default/security file) to update attribute. See the below example:NUMBER_OF_LOGINS_ALLOWED=10For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update attribute. See the below example:NUMBER_OF_LOGINS_ALLOWED=10Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor. "','HP-UX SMSE',' III - Administrative Sensitive ','GEN000450','C-36260r2_chk','For Trusted Mode:\nCheck the attribute setting.\n# grep NUMBER_OF_LOGINS_ALLOWED /etc/default/security\n\nIf NUMBER_OF_LOGINS_ALLOWED is set to greater than 10, this is a finding.\n\nFor SMSE:\nCheck the attribute setting.\n# grep NUMBER_OF_LOGINS_ALLOWED /etc/default/security /var/adm/userdb/" \n\nIf NUMBER_OF_LOGINS_ALLOWED is set to greater than 10, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40452','SV-52439r1_rule','default','medium','The /var/adm/userdb/USERDB.DISABLED file must be group-owned by sys.','"Unless the userdb is required; the /var/adm/userdb/USERDB.DISABLED file must be created to disable the use of per-user security attributes in the user database. Attributes in the user database override the system-wide settings configured in /etc/default/security. If the system-wide configuration is overridden maliciously; users may gain unauthorized system access. "','F-45401r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file group ownership. chgrp sys /var/adm/userdb/USERDB.DISABLED"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0290','C-47012r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nIf the userdb is required, this check is not applicable.\n\nVerify the file is group-owned by sys.\n# ls -lL /var/adm/userdb/USERDB.DISABLED\n\nIf the file is not group-owned by sys, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-4290','SV-38429r2_rule','default','medium','The HP-UX AUDOMON_ARGS attribute must be explicitly initialized.','The minimal set of auditing requirements necessary to collect useful forensics data and provide user help when violations are detected must be configured.','F-31485r2_fix','"Edit the /etc/rc.config.d/auditing file and insert the following line:AUDOMON_ARGS=“-p 20; -t 1; -w 90”Restart auditing: /sbin/init.d/auditing stop /sbin/init.d/auditing start"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0040','C-36226r2_chk','Check the /etc/rc.config.d/auditing file AUDOMON_ARGS settings: \n\n# cat /etc/rc.config.d/auditing | tr \u201c\\011\u201d \u201c \u201c | tr -s \u201c \u201c | sed -e "s/^[ \\t]"//" grep -v \u201c#\u201d\n\nThe above command should return a single line with the following information: \n\nAUDOMON_ARGS=\u201c-p 20, -t 1, -w 90\u201d\n\nIf \u201cp\u201d, \u201ct\u201d, or \u201cw\u201d flags are not set to \u201c20\u201d, \u201c1\u201d, and \u201c90\u201d, respectively, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40447','SV-52434r1_rule','default','medium','The /var/adm/userdb directory must be owned by root.','"The /var/adm/userdb directory is the system user database repository used for storing per-user security configuration information. If the configuration is modified maliciously; individual users may gain unauthorized system access. "','F-45396r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file ownership. chown root /var/adm/userdb"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0240','C-47007r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the directory is owned by root.\n# ls -lL /var/adm/userdb\n\nIf the directory is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-762','SV-38443r2_rule','default','medium','All accounts must be assigned unique User Identification Numbers (UIDs).','"Accounts sharing a UID have full access to each others files. This has the same effect as sharing a login. There is no way to assure identification; authentication; and accountability because the system sees them as the same user. If the duplicate UID is 0; this gives potential intruders another privileged account to attack."','F-31503r2_fix','"Determine if the duplicate UIDs are associated with the same or a different account name. cat /etc/passwd | grep <non-uniqueUID>or; for multiple non-unique UIDs: cat /etc/passwd | egrep “<non-uniqueUID1>|<non-uniqueUID2>|;non-uniqueUIDn>“If the account names are unique; the UIDs must also be modified to be unique. If the account names are the same; disable/remove one of the two (or more) password file entries via the SAM/SMH interface..   "','HP-UX SMSE',' III - Administrative Sensitive ','GEN000320','C-36246r2_chk','Verify the consistency of the assigned home directories in the authentication database.\nFor Trusted Mode:\n# authck -av\n\nFor SMSE:\n# pwck\n\nIf a non-unique UID is found in the password file, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40445','SV-52432r1_rule','default','medium','The system must impose the same restrictions on root logins that are already applied to non-root users.','"Best practices standard operating procedures for computing systems includes account management. If the root account is allowed to be configured without a password; or not configured to lock if there have been no logins to the root account for an organization defined time interval; the entire system can be compromised."','F-45394r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Edit the /etc/default/security file and add/modify the following attribute(s) and attribute values:PASSWORD_POLICY_STRICT=1Save the file before exiting the editor. "','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0220','C-47005r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nFor Standard Mode with Security Extensions (SMSE):\nCheck the /etc/default/security file for the following attribute(s) and attribute values:\nLOGIN_POLICY_STRICT=1\n# grep \u201cLOGIN_POLICY_STRICT\u201d /etc/default/security\n\nIf LOGIN_POLICY_STRICT=0, then the root user is not subject to the same login restrictions as non-root users, and this is a finding.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22347','SV-38323r2_rule','default','medium','The /etc/passwd file must not contain password hashes.','"If password hashes are readable by non-administrators; the passwords are subject to attack through lookup tables or cryptographic weaknesses in the hashes."','F-31694r2_fix','"Migrate /etc/passwd password hashes. For Trusted Mode:Use the System Administration Manager (SAM) or the System Management Homepage (SMH) to migrate from a non-SMSE Standard Mode to Trusted Mode.For SMSE Mode:Use the following command to create the shadow file. The command will then copy all encrypted passwords into the shadow file and replace the passwd file password entries with an “x”. pwconv"','HP-UX SMSE',' III - Administrative Sensitive ','GEN001470','C-36358r2_chk','Verify no password hashes are present in /etc/passwd.\n# cat /etc/passwd | cut -f 2,2 -d \u201c:\u201d \n\nIf any password hashes are returned, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-4298','SV-27148r2_rule','default','medium','Remote consoles must be disabled or protected from unauthorized access.','"The remote console feature provides an additional means of access to the system which could allow unauthorized access if not disabled or properly secured.  With virtualization technologies; remote console access is essential as there is no physical console for virtual machines.  Remote console access must be protected in the same manner as any other remote privileged access method."','F-24422r2_fix','"If the /etc/securetty file does not exist; create the file containing only the word console and ensure correct file properties. echo “console” > /etc/securetty chown root /etc/securetty chgrp root /etc/securetty chmod 0640 /etc/securetty chacl -z /etc/securetty"','HP-UX SMSE',' III - Administrative Sensitive ','GEN001000','C-28074r1_chk','Check /etc/securetty\n# more /etc/securetty\nIf the /etc/securetty file does not exist, or contains other than "console" or "/dev/null" this is a finding.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11947','SV-27111r2_rule','default','medium','The system must require that passwords contain a minimum of 14 characters.','The use of longer passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques by increasing the password search space.','F-24374r4_fix','"For Trusted Mode:Use the SAM/SMH interface to set the system password length attribute “MIN_PASSWORD_LENGTH” to 14 or greater.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Install the additional LongPassword11i3 and PHI11i3 product bundles where/as required. Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute(s). See the below example(s):CRYPT_ALGORITHMS_DEPRECATE=__unix__CRYPT_DEFAULT=6LONG_PASSWORD=1MIN_PASSWORD_LENGTH=14Note: The MIN_PASSWORD_LENGTH attribute must be set greater than or equal to 14.If the ""vi"" editor was used to update the /etc/default/security file; save the file before exiting the editor. "','HP-UX SMSE',' III - Administrative Sensitive ','GEN000580','C-28027r4_chk','For Trusted Mode:\nCheck the system password length setting. For Trusted systems, the range of supported values for N is 6 to 80.\n# grep MIN_PASSWORD_LENGTH /etc/default/security\n\nIf the MIN_PASSWORD_LENGTH attribute is not set to N=14 or greater, this is a finding.\n\nFor SMSE:\nCheck the system password length setting. For Standard (non-SMSE enabled) systems, the maximum supported length is  N=8. Once the /etc/shadow file is created and long passwords are enabled (may require additional software product installations), check the system password length setting. The LONG_PASSWORD attribute is valid only when the LongPassword11i3 product is installed and the password hash algorithm is different from the traditional DES-based hash algorithm.\n# egrep "CRYPT_ALGORITHMS_DEPRECATE|CRYPT_DEFAULT|LONG_PASSWORD|MIN_PASSWORD_LENGTH" /etc/default/security /var/adm/userdb/"\n\nThe following is an example output from the above command:\nCRYPT_ALGORITHMS_DEPRECATE=__unix__\nCRYPT_DEFAULT=6\nLONG_PASSWORD=1\nMIN_PASSWORD_LENGTH=14\n\nNote: The MIN_PASSWORD_LENGTH attribute may exceed 14 characters.\n\nIf the attributes CRYPT_ALGORITHMS_DEPRECATE, CRYPT_DEFAULT, LONG_PASSWORD, and MIN_PASSWORD_LENGTH are not set per the above example output, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40448','SV-52435r1_rule','default','medium','The /var/adm/userdb directory must be group-owned by sys.','"The /var/adm/userdb directory is the system user database repository used for storing per-user security configuration information. If the configuration is modified maliciously; individual users may gain unauthorized system access. "','F-45397r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file group ownership. chgrp sys /var/adm/userdb"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0250','C-47008r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the directory is group-owned by sys.\n# ls -lL /var/adm/userdb\n\nIf the directory is not group-owned by sys, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40449','SV-52436r1_rule','default','medium','The /var/adm/userdb directory must have mode 0700 or less permissive.','"The /var/adm/userdb directory is the system user database repository used for storing per-user security configuration information. If the configuration is modified maliciously; individual users may gain unauthorized system access. "','F-45398r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file mode to 0700 or less permissive. chmod 0700 /var/adm/userdb	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0260','C-47009r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the directory mode.\n# ls -lL /var/adm/userdb\n\nIf the directory mode is more permissive than 0700, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40482','SV-52471r1_rule','default','medium','The /etc/pam.conf file must not have an extended ACL.','"The /etc/pam.conf file is the system configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. "','F-45431r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Remove the optional ACL from the file. chacl -z /etc/pam.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0390','C-47022r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file has no extended ACL.\n# ls -lL /etc/pam.conf\n\nIf the permissions include a \u201c+\u201d, the file has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40483','SV-52472r1_rule','default','medium','The per user PAM configuration file (/etc/pam_user.conf) must not be used to override the system-wide PAM configuration file (/etc/pam.conf) unless it is required.','"The per user PAM configuration file (/etc/pam_user.conf) allows individual users to be assigned options that differ from those of the general computing community. This file is optional and should only be used if PAM applications are required to operate differently for specific users; i.e.; to isolate the administrative user accounts."','F-45432r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:If the SA cannot provide a reasonable explanation for user entries in the /etc/pam_user.conf file; take one or more of the following actions: remove the file; remove/comment all user entries; remove/comment individual user entries. Document all changes."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0400','C-47023r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nFor SMSE:\nCheck the system for the existence of the /etc/pam_user.conf file.\n# ls -lL /etc/pam_user.conf\n\nIf the file does not exist, this is a finding.\n\nIf the file exists, examine the file.\n# cat /etc/pam_user.conf\n\nAttempt to determine the reason (ask the SA for an explanation) for options being passed to the PAM service modules for the listed users.\n\nIf the SA cannot provide an explanation for the listed users and PAM module options, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40468','SV-52456r1_rule','default','medium','The /etc/security.dsc file must have mode 0444 or less permissive.','"The /etc/security.dsc file is the system description file that contains all attributes and default values that are configurable on a per user basis in /var/adm/userdb. If the description file is modified maliciously; users may gain unauthorized system access. "','F-45418r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file mode to 0444 or less permissive. chmod 0444 /etc/security.dsc"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0340','C-47017r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file mode.\n# ls -lL /etc/security.dsc\n\nIf the file mode is more permissive than 0444, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-768','SV-38446r2_rule','default','medium','The delay between login prompts following a failed login attempt must be at least 4 seconds.','Enforcing a delay between consecutive failed login attempts increases protection against automated password guessing attacks.','F-31507r2_fix','"For Trusted Mode:Use the SAM/SMH interface to ensure that the t_logdelay setting is 4.For SMSE:There is no fix; however; there are attack mitigations to minimize risk (see mitigations)."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000480','C-36250r2_chk','For Trusted Mode:\nCheck the t_logdelay setting.\n# more /tcb/files/auth/system/default\n\nVerify the value of the t_logdelay variable. If the value is less than 4, this is a finding.\n\nFor SMSE:\nBy default, PAM executes a built-in, 3 second standard delay if user authentication fails. This delay cannot be extended. The \u201cnodelay\u201d parameter disables the built-in delay. Ensure that the \u201cnodelay\u201d parameter is not found in the /etc/pam.conf file.\n\nThe HP-SMSE environment does not meet the failed authentication 4 second minimum delay requirement. This check will always result in a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40484','SV-52473r1_rule','default','medium','The /etc/pam_user.conf file must be owned by root.','"The /etc/pam_user.conf file is the per user configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. The /etc/pam_user.conf file must not be configured unless it is required."','F-45433r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file ownership. chown root /etc/pam_user.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0410','C-47024r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is owned by root.\n# ls -lL /etc/pam_user.conf\n\nIf the file is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-1032','SV-38199r2_rule','default','medium','Users must not be able to change passwords more than once every 24 hours.','The ability to change passwords frequently facilitates users reusing the same password. This can result in users effectively never changing their passwords. This would be accomplished by users changing their passwords when required and then immediately changing it to the original value.','F-31512r2_fix','"For both Trusted Mode and SMSE:Use the SAM/SMH interface to ensure that password changes are restricted to no less than once every 24 hours.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to ensure that password changes are restricted to no less than once every 24 hours. See the below example:PASSWORD_MINDAYS=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000540','C-36255r3_chk','For Trusted Mode:\nCheck the \u201cu_minchg\u201d attribute in the users TS database entry.\nIndividual user:\n# export PATH=$PATH:/usr/lbin\n# getprpw -r -m mintm <USER>\n \nAll users:\n# logins -o -x | awk -F: "{print $1\u201d \u201c$10}"\n\nIf the value is less than 1 for any user, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MINDAYS attribute.\n# grep PASSWORD_MINDAYS /etc/default/security /var/adm/userdb/"\n\nIf the attribute PASSWORD_MINDAYS is less than 1, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40486','SV-52475r1_rule','default','medium','The /etc/pam_user.conf file must have mode 0444 or less permissive.','"The /etc/pam_user.conf file is the per user configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. The /etc/pam_user.conf file must not be configured unless it is required."','F-45435r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file mode to 0444 or less permissive. chmod 0444 /etc/pam_user.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0430','C-47026r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file mode.\n# ls -lL /etc/pam_user.conf\n\nIf the file mode is more permissive than 0444, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22369','SV-38355r2_rule','default','medium','All system audit files must not have extended ACLs.','"If a user can write to the audit logs; then audit trails can be modified or destroyed and system intrusion may not be detected."','F-31775r2_fix','"As root; remove the ACL. chacl -z  <audit directory> chacl -z  <audit file>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002710','C-36436r3_chk','Inspect the auditing configuration file, /etc/rc.config.d/auditing, to determine the filename and path of the audit logs. The entries should appear similar to the following:\nPRI_AUDFILE=/var/.audit/file1\nSEC_AUDFILE=/var/.audit/file2\n\n# egrep \u201cPRI_AUDFILE|SEC_AUDFILE\u201d /etc/rc.config.d/auditing\n\nFor each audit log directory/file, check the permissions.\n# ls -lLd <audit directory>\n# ls -lLa <audit file>\n\nIf any audit log directory/file permissions include a \u201c+\u201d, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-766','SV-38445r2_rule','default','medium','The system must disable accounts after three consecutive unsuccessful login attempts.','Disabling accounts after a limited number of unsuccessful login attempts improves protection against password guessing attacks.','F-31506r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /tcb/files/auth/system/default file and update the u_maxtries attribute. See the below example::u_maxtries3:If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute. See the below example:AUTH_MAXTRIES=2Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000460','C-36249r2_chk','For Trusted Mode:\nThe u_maxtries attribute in the /tcb/files/auth/system/default file controls whether an account is locked after too many consecutive authentication failures. An account is locked after \u201cN\u201d consecutive authentication failures. Check the global setting for u_maxtries is set to N=3.\n# grep u_maxtries /tcb/files/auth/system/default \n\nIf the u_maxtries attribute is not set to 3, this is a finding.\n\nFor SMSE:\nThe AUTH_MAXTRIES attribute in the /etc/default/security configuration file controls whether an account is locked after too many consecutive authentication failures. An account is locked after N+1 consecutive authentication failures. Check the setting for AUTH_MAXTRIES is set to N=2.\n# grep AUTH_MAXTRIES /etc/default/security /var/adm/userdb/"\n\nIf the attribute AUTH_MAXTRIES is not set to 2, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-813','SV-38478r2_rule','default','medium','System audit logs must have mode 0640 or less permissive.','"If a user can write to the audit logs; audit trails can be modified or destroyed and system intrusion may not be detected.  System audit logs are those files generated from the audit system and do not include activity; error; or other log files created by application software."','F-31764r2_fix','"As root; change the permissions. chmod 0750  <audit directory> chmod 0640  <audit file>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002700','C-36425r2_chk','Inspect the auditing configuration file, /etc/rc.config.d/auditing, to determine the filename and path of the audit logs. The entries should appear similar to the following:\nPRI_AUDFILE=/var/.audit/file1\nSEC_AUDFILE=/var/.audit/file2\n\n# egrep \u201cPRI_AUDFILE|SEC_AUDFILE\u201d /etc/rc.config.d/auditing\n\nFor each audit log directory/file, check the permissions.\n# ls -lLd <audit directory>\n# ls -lLa <audit file>\n\nIf any audit log file has permissions greater than 0640 (0750 for directories), this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-812','SV-38477r2_rule','default','medium','System audit logs must be owned by root.','Failure to give ownership of system audit log files to root provides the designated owner and unauthorized users with the potential to access sensitive information.','F-31763r2_fix','"As root; change the ownership. chown root  <audit directory> chown root  <audit file>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002680','C-36424r2_chk','Inspect the auditing configuration file, /etc/rc.config.d/auditing, to determine the filename and path of the audit logs. The entries should appear similar to the following:\nPRI_AUDFILE=/var/.audit/file1\nSEC_AUDFILE=/var/.audit/file2\n\n# egrep \u201cPRI_AUDFILE|SEC_AUDFILE\u201d /etc/rc.config.d/auditing\n\nFor each audit log directory/file, check the ownership.\n# ls -lLd <audit directory>\n# ls -lLa <audit file>\n\nIf any audit log directory/file is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40487','SV-52476r1_rule','default','medium','/etc/pam_user.conf file must not have an extended ACL.','"The /etc/pam_user.conf file is the per user configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. The /etc/pam_user.conf file must not be configured unless it is required."','F-45436r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Remove the optional ACL from the file. chacl -z /etc/pam_user.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0440','C-47027r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file has no extended ACL.\n# ls -lL /etc/pam_user.conf\n\nIf the permissions include a \u201c+\u201d, the file has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11979','SV-38212r2_rule','default','medium','The root account must not be used for direct logins.','"Direct login with the root account prevents individual user accountability. Acceptable non-routine uses of the root account for direct login are limited to emergency maintenance; the use of single-user mode for maintenance; and situations where individual administrator accounts are not available."','F-31547r2_fix','"Enforce policies requiring all root account access is attained by first logging into a user account and then becoming root (using “su”; for example). Note:GEN000980 limits direct login by root to the console (requires physical access). GEN001120 prohibits direct root logins via SSH. GEN003850 disallows telnet access. GEN003830 prohibits rlogin access. GEN002100 prohibits .rhost PAM support. GEN002040 prohibits .rhosts; .shosts; hosts.equiv; or shosts.equiv system files.Ensure that root logging is enabled.For Trusted Mode: modprpw -l -m audflg=1 rootFor SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute. See the below example:AUDIT_FLAG=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN001020','C-36290r4_chk','For Trusted Mode:\nCheck the /tcb database to determine if root account auditing is enabled and the last login log for direct root logins. Note that for the /tcb audit flag entry that numeric values are specified as positive numbers, 0, or -1. A value of -1 indicates that the field has not been assigned a value in the database. A value of 0 indicates that auditing is not enabled. \n# getprpw -m audflg root  and  and  last root | grep -v reboot\n\nIf any direct login records for root are listed, this is a finding.\n\nFor SMSE:\nCheck the root AUDIT_FLAG attribute setting. Note that for the /etc/default/security file audit flag entry that numeric values are specified as 0, or 11. A value of 1 indicates that auditing is enabled. A value of 0 indicates that auditing is not enabled.\n# grep AUDIT_FLAG /etc/default/security /var/adm/userdb/"  and  and  last root | grep -v reboot\n\nIf any direct login records for root are listed, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11973','SV-38246r2_rule','default','medium','The system must require passwords contain at least one special character.','"To enforce the use of complex passwords; minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use."','F-31543r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /etc/default/security file and update the PASSWORD_MIN_SPECIAL_CHARS attribute. See the below example:PASSWORD_MIN_SPECIAL_CHARS=1If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_MIN_SPECIAL_CHARS attribute. See the below example:PASSWORD_MIN_SPECIAL_CHARS=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000640','C-36286r2_chk','For Trusted Mode:\nCheck the PASSWORD_MIN_SPECIAL_CHARS setting.\n# cat /etc/default/security | grep PASSWORD_MIN_SPECIAL_CHARS \n\nIf PASSWORD_MIN_SPECIAL_CHARS is not set to 1 or greater this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MIN_SPECIAL_CHARS setting.\n# grep PASSWORD_MIN_SPECIAL_CHARS /etc/default/security /var/adm/userdb/"\n\nIf PASSWORD_MIN_SPECIAL_CHARS is not set to 1 or greater, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-778','SV-38453r2_rule','default','medium','The system must prevent the root account from directly logging in except from the system console.','Limiting the root account direct logins to only system consoles protects the root account from direct unauthorized access from a non-console device.','F-31533r2_fix','"If the /etc/securetty file does not exist; create the file containing only the word console and ensure correct file properties. echo “console” > /etc/securetty chown root /etc/securetty chgrp root /etc/securetty chmod 0640 /etc/securetty chacl -z /etc/securetty"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000980','C-36276r2_chk','Check the /etc/securetty file contents.\n# more /etc/securetty\nIf /etc/securetty does not exist, or has contents other than console or /dev/null, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-797','SV-38468r2_rule','default','medium','The /etc/shadow (or equivalent) file must be owned by root.','The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  Failure to give ownership of sensitive files or utilities to root or bin provides the designated owner and unauthorized users with the potential to access sensitive information or change the system configuration which could weaken the systems security posture.','F-31585r2_fix','"For Trusted Mode: chown root /tcb chown root /tcb/files /tcb/files/auth chown root  /tcb/files/auth/[a-z]/* For SMSE: chown root /etc/shadow    "','HP-UX SMSE',' III - Administrative Sensitive ','GEN001400','C-36330r3_chk','Check the ownership of the /etc/shadow file.\n# ls -lL /etc/shadow\n\nIf the /etc/shadow file exists and is not owned by root, this is a finding. NOTE: /etc/shadow should not exist if the system is in Trusted Mode.\n\nCheck the ownership of the TCB auth files and directories.\n# ls -lLd /tcb /tcb/files /tcb/files/auth \n# ls -lL /tcb/files/auth/[a-z,A-Z]/"\n\nIf the owner of any of the /tcb files and directories is not root, this is a finding.\n\nFor SMSE:\nCheck the /etc/shadow file.\n# ls -lL /etc/shadow\n\nIf the /etc/shadow file exists and is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22303','SV-52489r1_rule','default','medium','The system must use a FIPS 140-2 approved cryptographic hashing algorithm for generating account password hashes.','Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors.  The use of unapproved algorithms may result in weak password hashes that are more vulnerable to compromise.','F-45448r1_fix','"For Trusted Mode:NOTE: There is no fix for Trusted Mode/Systems (TS). MD5 is currently used; and per vendor documentation; this algorithm will not be updated; due to TS being deprecated/replaced by SMSE.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) to update the attribute. See the below example:CRYPT_ALGORITHMS_DEPRECATE=__unix__CRYPT_DEFAULT=6Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000590','C-47035r2_chk','For Trusted Mode:\nMD5 is currently the only available hashing function. Per vendor documentation, this algorithm will not be updated, due to TS being deprecated/replaced by SMSE.\n\nFor SMSE:\nCheck the system password for use of cryptographic hashes using the SHA-2 family of algorithms or FIPS 140-2 approved successors. \n# egrep \u201cCRYPT_ALGORITHMS_DEPRECATE|CRYPT_DEFAULT\u201d /etc/default/security\n\nThe following is an example output from the above command:\nCRYPT_ALGORITHMS_DEPRECATE=__unix__\nCRYPT_DEFAULT=6\n\nIf the attributes CRYPT_ALGORITHMS_DEPRECATE, and CRYPT_DEFAULT are not set per the above example output, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22302','SV-52487r1_rule','default','medium','The system must enforce the correctness of the entire password during authentication.','"Some common password hashing schemes only process the first eight characters of a users password; which reduces the effective strength of the password."','F-45446r1_fix','"For Trusted Mode:NOTE: There is no fix for Trusted Mode/Systems (TS). MD5 is currently used; and per vendor documentation; this algorithm will not be updated; due to TS being deprecated for HP-UX 11i-v3 (11.31). For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) to update the attribute. See the below example:CRYPT_ALGORITHMS_DEPRECATE=__unix__CRYPT_DEFAULT=6Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000585','C-47033r1_chk','Note that in certain instances, the password field of any given password database may present as \u201c"\u201d or \u201c!!\u201d, indicating that the account is locked or disabled.\n\nFor Trusted Mode:\nVerify that password hashes in /tcb do not begin with a character other than a dollar sign ($).\n# cd /tcb/files/auth  and  and  cat "/" | egrep \u201c:u_name=|:u_pwd=\u201c\n\nIf user account password hashes begins with any character other than a dollar sign ($), this is a finding.\n\nFor SMSE:\nVerify that password hashes in /etc/shadow do not begin with a character other than a dollar sign ($).\n# cat /etc/shadow | cut -f 2,2 -d \u201c:\u201d | egrep -v \u201c^\\\\$|\\\\"|\\\\!\\\\!\u201d\n\nIf any password hash without a leading dollar sign is returned by the above command, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22305','SV-38304r2_rule','default','medium','The system must require passwords contain at least one lowercase alphabetic character.','"To enforce the use of complex passwords; minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use."','F-31549r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /etc/default/security file and update the PASSWORD_MIN_LOWER_CASE_CHARS attribute. See the below example:PASSWORD_MIN_LOWER_CASE_CHARS=1If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_MIN_LOWER_CASE_CHARS attribute. See the below example:PASSWORD_MIN_LOWER_CASE_CHARS=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000610','C-36292r2_chk','For Trusted Mode:\nCheck the PASSWORD_MIN_LOWER_CASE_CHARS setting.\n# cat /etc/default/security | grep PASSWORD_MIN_LOWER_CASE_CHARS \n\nIf PASSWORD_MIN_LOWER_CASE_CHARS is not set to 1 or greater, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MIN_LOWER_CASE_CHARS setting.\n# grep PASSWORD_MIN_LOWER_CASE_CHARS /etc/default/security /var/adm/userdb/"\n\nIf PASSWORD_MIN_LOWER_CASE_CHARS is not set to 1 or greater, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22304','SV-52491r1_rule','default','medium','The password hashes stored on the system must have been generated using a FIPS 140-2 approved cryptographic hashing algorithm.','Systems must employ cryptographic hashes for passwords using the SHA-2 family of algorithms or FIPS 140-2 approved successors.  The use of unapproved algorithms may result in weak password hashes that are more vulnerable to compromise.','F-45450r1_fix','"For Trusted Mode:NOTE: There is no fix for Trusted Mode/Systems (TS). MD5 is currently used; and per vendor documentation; this algorithm will not be updated; due to TS being deprecated/replaced by SMSE. This will always result in a finding.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) to update the attribute. See the below example:CRYPT_ALGORITHMS_DEPRECATE=__unix__CRYPT_DEFAULT=6Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000595','C-47037r1_chk','Note that in certain instances, the password field of any given password database may present as \u201c"\u201d or \u201c!!\u201d, indicating that the account is locked or disabled.\n\nFor Trusted Mode:\nVerify that the first 3 characters in the /tcb password hashes begin with the characters \u201c$6$\u201d (note that double quotes are for emphasis only).\n# cd /tcb/files/auth  and  and  cat "/" | egrep \u201c:u_name=|:u_pwd=\u201c\n\nIf user account password hashes begins with any characters other than \u201c$6$\u201d, this is a finding.\n\nFor SMSE:\nVerify that password hashes in /etc/shadow begin with the characters \u201c$6$\u201d (note that double quotes are for emphasis only).\n# cat /etc/shadow | cut -f 2,2 -d \u201c:\u201d | egrep -v \u201c^\\\\"|\\\\!\\\\!\u201d\n\nIf user account password hashes begins with any characters other than \u201c$6$\u201d, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-899','SV-38488r2_rule','default','low','All interactive users must be assigned a home directory in the /etc/passwd file.','"If users do not have a valid home directory; there is no place for the storage and control of files they own."','F-31588r2_fix','"For Trusted Mode:Determine why the user is not assigned a home directory. Possible actions include: account deletion or disablement. If the account is determined to be valid; manually create the home directory if required (mkdir directoryname; copy the skeleton files into the directory; chown account name for the new directory and the skeleton files) and assign to the user in the /etc/passwd file or take corrective action via the HP SMH/SAM utility. For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Determine why the user is not assigned a home directory. Possible actions include: account deletion or disablement. If the account is determined to be valid; manually create the home directory if required (mkdir directoryname; copy the skeleton files into the directory; chown account name for the new directory and the skeleton files) and assign to the user in the /etc/passwd file or take corrective action via the HP SMH/SAM utility. Additionally; use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the ABORT_LOGIN_ON_MISSING_HOMEDIR attribute. See the below example:ABORT_LOGIN_ON_MISSING_HOMEDIR=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN001440','C-36333r2_chk','Verify the consistency of the assigned home directories in the authentication database.\nFor Trusted Mode:\n# authck -av\n\nFor SMSE:\n# pwck\n\nIf any user is not assigned a home directory, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11980','SV-38248r2_rule','default','medium','The system must log successful and unsuccessful access to the root account.','"If successful and unsuccessful logins and logouts are not monitored or recorded; access attempts cannot be tracked.  Without this logging; it may be impossible to track unauthorized access to the system."','F-31548r2_fix','"For Trusted Mode:Ensure that all users are being audited. List users from the passwd file and check the user entries in the /tcb database. See the example below. Note that the “getprpw” command must be executed individually for all users. Users associated with “audflg” set to zero (disabled) must be corrected. cat /etc/passwd | cut -f 1;1 -d “:” getprpw -m audflg <user> modprpw -l -m audflg=1 <user>Use the SAM/SMH interface (/etc/default/security file) to update the SU_ROOT_GROUP attribute. See the below example:SU_ROOT_GROUP=root;<user1>;<user2>For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the AUDIT_FLAG and SU_ROOT_GROUP attributes. See the below example:AUDIT_FLAG=1SU_ROOT_GROUP=root;<user1>;<user2>Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN001060','C-36291r2_chk','Check the following log files to determine if access attempts to the root account are being logged. Try su - and enter an incorrect password.\n# more /var/adm/sulog /var/adm/syslog\n\nIf root account access login attempts are not being logged, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11972','SV-38245r2_rule','default','medium','The system must require passwords contain at least one numeric character.','"To enforce the use of complex passwords; minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use."','F-31542r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /etc/default/security file and update the PASSWORD_MIN_DIGIT_CHARS attribute. See the below example:PASSWORD_MIN_DIGIT_CHARS=1If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_MIN_DIGIT_CHARS attribute. See the below example:PASSWORD_MIN_DIGIT_CHARS=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000620','C-36285r2_chk','For Trusted Mode:\nCheck the PASSWORD_MIN_DIGIT_CHARS setting.\n# cat /etc/default/security | grep PASSWORD_MIN_DIGIT_CHARS \n\nIf PASSWORD_MIN_DIGIT_CHARS is not set to 1 or greater this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MIN_DIGIT_CHARS setting.\n# grep PASSWORD_MIN_DIGIT_CHARS /etc/default/security /var/adm/userdb/"\n\nIf PASSWORD_MIN_DIGIT_CHARS is not set to 1 or greater, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-800','SV-38470r2_rule','default','medium','The /etc/shadow (or equivalent) file must have mode 0400.','The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  The file also contains password hashes which must not be accessible to users other than root. The Trusted Mode /tcb tree requires modes more permissive than the shadow file.','F-31587r2_fix','"For Trusted Mode: chmod 0555 /tcb chmod 0771 /tcb/files /tcb/files/auth chmod 0664  /tcb/files/auth/[a-z]/* For SMSE: chmod 00400 /etc/shadow "','HP-UX SMSE',' III - Administrative Sensitive ','GEN001420','C-36332r2_chk','For Trusted Mode:\nCheck the TCB auth files and directories.\n# ls -lLd /tcb /tcb/files /tcp/files/auth \n# ls -lL /tcb/files/auth/[a-z,A-Z]/"\n\nIf the mode of /tcb directory is more permissive than 0555, this is a finding.\nIf the mode of /tcb/files or /tcb/files/auth directories is more permissive than 0771, this is a finding.\nIf the mode of any of the /tcb/files/auth/[a-z]/" is more permissive than 0664, this is a finding.\n\nFor SMSE:\nCheck the /etc/shadow file.\n# ls -lL /etc/shadow\n\nIf the /etc/shadow file has a mode more permissive than 0400, this is a finding. NOTE: The /etc/shadow file will not exist if the system is in Trusted Mode.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11976','SV-38247r3_rule','default','medium','User passwords must be changed at least every 60 days.','Limiting the lifespan of authenticators limits the period of time an unauthorized user has access to the system while using compromised credentials and reduces the period of time available for password guessing attacks to run against a single password.','F-31545r2_fix','"For Trusted Mode:Set the password maximum days field to 60 for all user accounts. passwd -x 60 <user>For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_MAXDAYS attribute. See the below example:PASSWORD_MAXDAYS=60PASSWORD_WARNDAYS=7Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000700','C-36288r3_chk','For Trusted Mode:\nCheck the exptm field for each user, or for all accounts:\n# getprpw -r -m exptm <USER>\n# logins -o -x | awk -F: "{print $1\u201d \u201c$11}" \n\nIf the exptm attribute is set equal to -1, 0, or greater than 60 for any user, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MAXDAYS setting. The command and an example output is seen directly below:\n# egrep \u201cPASSWORD_MAXDAYS|PASSWORD_WARNDAYS\u201d /etc/default/security /var/adm/userdb/"\n\nExample output from the above command, with the correctly assigned attribute values. Note that PASSWORD_MAXDAYS may deviate from 60. Illegal values include 0 (no warning).  PASSWORD_MAXDAYS attribute exceptions that must not be used are 1-7 (values less than or equal to the required PASSWORD_WARNDAYS attribute setting):\nPASSWORD_MAXDAYS=60\nPASSWORD_WARNDAYS=7\n\nIf the above attributes are either missing or not set per the above attribute values (exceptions noted above), this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40476','SV-52464r1_rule','default','medium','The /etc/pam.conf file must be group-owned by sys.','"The /etc/pam.conf file is the system configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. "','F-45426r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file group ownership. chgrp sys /etc/pam.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0370','C-47020r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is group-owned by sys.\n# ls -lL /etc/pam.conf\n\nIf the file is not group-owned by sys, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40355','SV-52335r1_rule','default','medium','The system must disable accounts after three consecutive unsuccessful SSH login attempts.','Disabling accounts after a limited number of unsuccessful SSH login attempts improves protection against password guessing attacks.','F-45323r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE only:Edit the /opt/ssh/etc/sshd_config file and add/uncomment/update the “UsePAM” attribute. See the below example:UsePAM yesSave any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0210','C-46984r1_chk','If the system is operating in Trusted Mode, this check is not applicable.\n\nFor SMSE:\nThe \u201cUsePAM\u201d attribute in the /opt/ssh/etc/sshd_config configuration file controls whether an account is locked after too many consecutive SSH authentication failures. The default \u201cUsePAM\u201d attribute setting is \u201cno\u201d. Verify the global setting for \u201cUsePAM\u201d is set to \u201cyes\u201d.\n# cat /opt/ssh/etc/sshd_config | sed -e "s/^[ \\t]"//" grep -v \u201c#\u201d | grep \u201c^UsePAM\u201d\n\nIf the /opt/ssh/etc/sshd_config configuration file attribute \u201cUsePAM\u201d is not set to \u201cyes\u201d, this is a finding.','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40492','SV-52481r1_rule','default','medium','"During a password change; the system must determine if password aging attributes are inherited from the /etc/default/security file attributes when no password aging is specified in the shadow file for local users."','"Password aging attributes are stored in /etc/default/security and /etc/shadow. Anytime a password aging policy is changed; policy requirements are updated in /etc/default/security. If the system is allowed to override or ignore updates made to /etc/default/security; deprecated password aging policies will remain intact and never enforce newer requirements."','F-45441r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) to update the OVERRIDE_SYSDEF_PWAGE attribute. See the below example:OVERRIDE_SYSDEF_PWAGE=0Note: If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0450','C-47028r1_chk','For Trusted Mode:\nIf the system is operating in Trusted Mode, this check is not applicable.\n\nFor SMSE:\nCheck the OVERRIDE_SYSDEF_PWAGE attribute setting.\n# grep OVERRIDE_SYSDEF_PWAGE /etc/default/security\n\nIf the OVERRIDE_SYSDEF_PWAGE attribute is missing or not set to 0, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-918','SV-38500r2_rule','default','medium','Accounts must be locked upon 35 days of inactivity.','"Inactive user accounts pose a risk to systems and applications. Owners of Inactive accounts will not notice if unauthorized access to their account has been obtained. There is a risk that inactive accounts can potentially be exploited to obtain and maintain undetected access to a system and/or application. The operating system must track periods of user account inactivity and disable all inactive accounts. Non-interactive accounts on the system; such as application accounts; may be documented exceptions.Non-interactive accounts on the system; such as application accounts; may be documented exceptions.Non-interactive accounts on the system; such as application accounts; may be documented exceptions."','F-31527r3_fix','"For Trusted Mode:Use the SAM/SMH interface to update the “u_llogin” (user last login) /tcb database attribute. See the /tcb database entry example below::u_llogin3024000:For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the INACTIVITY_MAXDAYS attribute. See the below example:INACTIVITY_MAXDAYS=35Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000760','C-36270r3_chk','For Trusted Mode:\nVerify that user accounts are locked after 35 days of inactivity.\nNote: The \u201cu_llogin\u201d attribute is stored in seconds: 86400 seconds/day " 35 days = 3024000 seconds.\n# cd /tcb/files/auth  and  and  cat "/" | egrep \u201c:u_name=|:u_llogin=\u201c\n\nIf user account is not set to lock after 35 days of inactivity, this is a finding.\n\nFor SMSE:\nCheck the INACTIVITY_MAXDAYS setting.\n# grep  INACTIVITY_MAXDAYS /etc/default/security /var/adm/userdb/"\n\nIf INACTIVITY_MAXDAYS is set to 0 or greater than 35 for any user, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-11948','SV-38244r2_rule','default','medium','The system must require passwords contain at least one uppercase alphabetic character.','"To enforce the use of complex passwords; minimum numbers of characters of different classes are mandated. The use of complex passwords reduces the ability of attackers to successfully obtain valid passwords using guessing or exhaustive search techniques. Complexity requirements increase the password search space by requiring users to construct passwords from a larger character set than they may otherwise use."','F-31541r2_fix','"For Trusted Mode:Use the SAM/SMH interface or edit the /etc/default/security file and update the PASSWORD_MIN_UPPER_CASE_CHARS attribute. See the below example:PASSWORD_MIN_UPPER_CASE_CHARS=1If manually editing the file; save any change(s) before exiting the editor.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the PASSWORD_MIN_UPPER_CASE_CHARS attribute. See the below example:PASSWORD_MIN_UPPER_CASE_CHARS=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000600','C-36284r2_chk','For Trusted Mode:\nCheck the PASSWORD_MIN_UPPER_CASE_CHARS setting.\n# cat /etc/default/security | grep PASSWORD_MIN_UPPER_CASE_CHARS \n\nIf PASSWORD_MIN_UPPER_CASE_CHARS is not set to 1 or greater, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MIN_UPPER_CASE_CHARS setting.\n# grep PASSWORD_MIN_UPPER_CASE_CHARS /etc/default/security /var/adm/userdb/"\n\nIf PASSWORD_MIN_UPPER_CASE_CHARS is not set to 1 or more, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-756','SV-38318r2_rule','default','medium','The system must require authentication upon booting into single-user and maintenance modes.','"Single user mode access must be strictly limited to privileged users. The ability to boot to single user mode allows a malicious user the opportunity to modify; compromise; or otherwise damage the system."','F-31487r2_fix','"For Trusted Mode:If single user boot authentication is disabled; use the System Administration Manager (SAM) or the System Management Homepage (SMH) to enable single user boot (for root only) authentication.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute. See the below example:BOOT_AUTH=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.""";C-36228r2_chk;"Check the /tcb/files/auth/system/default entry. grep “:d_boot_authenticate” /tcb/files/auth/system/defaultIf the returned entry looks like “:d_boot_authenticate@:”, single user boot authentication is disabled, and this is a finding.For SMSE:Check the setting for BOOT_AUTH is set to N=1. grep BOOT_AUTH /etc/default/security /var/adm/userdb/*If BOOT_AUTH=0, then single user boot authentication is disabled, and this is a finding."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000020','C-36228r2_chk','Check the /tcb/files/auth/system/default entry.\n# grep \u201c:d_boot_authenticate\u201d /tcb/files/auth/system/default\n\nIf the returned entry looks like \u201c:d_boot_authenticate@:\u201d, single user boot authentication is disabled, and this is a finding.\n\nFor SMSE:\nCheck the setting for BOOT_AUTH is set to N=1.\n# grep BOOT_AUTH /etc/default/security /var/adm/userdb/"\n\nIf BOOT_AUTH=0, then single user boot authentication is disabled, and this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40467','SV-52455r1_rule','default','medium','The /etc/security.dsc file must be group-owned by sys.','"The /etc/security.dsc file is the system description file that contains all attributes and default values that are configurable on a per user basis in /var/adm/userdb. If the description file is modified maliciously; users may gain unauthorized system access. 	"','F-45417r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file group ownership. chgrp sys /etc/security.dsc"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0330','C-47016r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is group-owned by sys.\n# ls -lL /etc/security.dsc\n\nIf the file is not group-owned by sys, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40494','SV-52483r1_rule','default','medium','The system and user default umask must be 0077 for all sessions initiated via PAM.','The umask controls the default access mode assigned to newly created files. An umask of 0077 limits new files to mode 0700 or less permissive. The leading zero digit represents an unsigned octal integer. This requirement applies to the globally configured system and user account defaults for all sessions initiated via PAM.','F-45443r1_fix','"For Trusted Mode:Use the SAM/SMH interface (/etc/default/security file) to update attribute. See the below example:UMASK=0077For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update attribute. See the below example:UMASK=0077Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0470','C-47030r1_chk','For Trusted Mode:\nCheck the attribute setting.\n# grep UMASK /etc/default/security\n\nIf UMASK is not set to 0077, this is a finding.\n\nFor SMSE:\nCheck the attribute setting.\n# grep UMASK /etc/default/security /var/adm/userdb/" \n\nIf UMASK is not set to 0077, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-761','SV-38442r2_rule','default','medium','All accounts on the system must have unique user or account names.','"A unique user name is the first part of the identification and authentication process. If user names are not unique; there can be no accountability on the system for auditing purposes. Multiple accounts sharing the same name could result in the Denial of Service to one or both of the accounts or unauthorized access to files or privileges."','F-31502r2_fix','"Determine if the duplicate accounts have the same or different UIDs. cat /etc/passwd | cut -f 1;1 -d “:” | sort | uniq -dIf the UIDs are different; the account name must be changed. If the UIDs are the same; disable/remove one of the two (or more) password file entries via the SAM/SMH interface."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000300','C-36245r2_chk','Verify the consistency of the assigned home directories in the authentication database.\nFor Trusted Mode:\n# authck -av\n\nFor SMSE:\n# pwck\n\nIf a non-unique username is found in the password file, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-900','SV-38489r2_rule','default','low','All interactive user home directories defined in the /etc/passwd file must exist.','"If a user has a home directory defined that does not exist; the user may be given the / directory; by default; as the current working directory upon logon. This could create a Denial of Service because the user would not be able to perform useful tasks in this location."','F-31589r2_fix','"Determine why the user home directory does not exist. Possible actions include: account deletion or disablement. If the account is determined to be valid; create the home directory either manually (mkdir directoryname; copy the skeleton files into the directory; chown account name for the new directory and the skeleton files) or via the HP SMH/SAM utility. "','HP-UX SMSE',' III - Administrative Sensitive ','GEN001460','C-36334r2_chk','Verify the consistency of the assigned home directories in the authentication database.\nFor Trusted Mode:\n# authck -av\n\nFor SMSE:\n# pwck\n\nIf any assigned home directory does not exist, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40466','SV-52454r1_rule','default','medium','The /etc/security.dsc file must be owned by root.','"The /etc/security.dsc file is the system description file that contains all attributes and default values that are configurable on a per user basis in /var/adm/userdb. If the description file is modified maliciously; users may gain unauthorized system access. "','F-45416r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file ownership. chown root /etc/security.dsc"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0320','C-47015r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is owned by root.\n# ls -lL /etc/security.dsc\n\nIf the file is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40485','SV-52474r1_rule','default','medium','The /etc/pam_user.conf file must be group-owned by sys.','"The /etc/pam_user.conf file is the per user configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. The /etc/pam_user.conf file must not be configured unless it is required."','F-45434r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file group ownership. chgrp sys /etc/pam_user.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0420','C-47025r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is group-owned by sys.\n# ls -lL /etc/pam_user.conf\n\nIf the file is not group-owned by sys, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22340','SV-26441r2_rule','default','medium','The /etc/shadow file must not have an extended ACL.','The /etc/shadow file contains the list of local system accounts.  It is vital to system security and must be protected from unauthorized modification.  The file also contains password hashes which must not be accessible to users other than root.','F-31693r3_fix','"For Trusted Mode: chacl -z /tcb chacl -z /tcb/files /tcb/files/auth chacl -z  /tcb/files/auth/[a-z]/* For SMSE: chacl -z /etc/shadow "','HP-UX SMSE',' III - Administrative Sensitive ','GEN001430','C-36357r4_chk','For Trusted Mode:\nCheck the TCB auth files and directories.\n# ls -lLd /tcb /tcb/files /tcp/files/auth \n# ls -lL /tcb/files/auth/[a-z,A-Z]/"\n\nIf the permissions of any of the /tcb files and directories include a \u201c+\u201d, this is a finding.\n\nFor SMSE:\nCheck the /etc/shadow file.\n# ls -lL /etc/shadow\n\nIf the /etc/shadow file permissions include a \u201c+\u201d, the file has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22370','SV-26506r2_rule','default','low','System audit tool executables must be owned by root.','"To prevent unauthorized access or manipulation of system audit logs; the tools for manipulating those logs must be protected."','F-31776r2_fix','"As root; change the file ownership. chown root  <audit_tool_filename>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002715','C-36437r2_chk','Verify the audit tools are owned by root or bin (bin is the default owner). The list of files should minimally include the following: \naudevent - Change/display event/system call status.\naudfilter - Load/clear/display the audit filtering policy.\nauditdp - Selectively read/write and convert/format the audit data.\naudisp - Display audit records.\naudomon - Audit file monitoring and size parameter setpoints.\naudsys - Start/stop auditing; set/display the audit file or directory information.\nuserdbset - Select user to be audited.\n# ls -lL /usr/sbin/aud" /usr/sbin/userdb"\n\nIf any system audit tool is not owned by root or bin, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22371','SV-26509r2_rule','default','low','"System audit tool executables must be group-owned by root; bin; sys; or other."','"To prevent unauthorized access or manipulation of system audit logs; the tools for manipulating those logs must be protected."','F-31777r2_fix','"As root; change the file group ownership. chgrp root  <audit_tool_filename>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002716','C-36438r2_chk','Verify the audit tools are group-owned by root, bin, sys, or other. The list of files should minimally include the following: \naudevent - Change/display event/system call status.\naudfilter - Load/clear/display the audit filtering policy.\nauditdp - Selectively read/write and convert/format the audit data.\naudisp - Display audit records.\naudomon - Audit file monitoring and size parameter setpoints.\naudsys - Start/stop auditing; set/display the audit file or directory information.\nuserdbset - Select user to be audited.\n# ls -lL /usr/sbin/aud" /usr/sbin/userdb"\n\nIf any system audit tool is not group-owned by root, bin, sys, or other, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22372','SV-26512r2_rule','default','low','System audit tool executables must have mode 0750 or less permissive.','"To prevent unauthorized access or manipulation of system audit logs; the tools for manipulating those logs must be protected."','F-31778r2_fix','"As root; change the file permissions. chmod 0750 <audit tool executable> "','HP-UX SMSE',' III - Administrative Sensitive ','GEN002717','C-36439r2_chk','Verify the audit tools file permissions. The list of files should minimally include the following: \naudevent - Change/display event/system call status.\naudfilter - Load/clear/display the audit filtering policy.\nauditdp - Selectively read/write and convert/format the audit data.\naudisp - Display audit records.\naudomon - Audit file monitoring and size parameter setpoints.\naudsys - Start/stop auditing; set/display the audit file or directory information.\nuserdbset - Select user to be audited.\n# ls -lL /usr/sbin/aud" /usr/sbin/userdb"\n\nIf any system audit tool has a file permissions greater than 0750, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-22373','SV-26516r2_rule','default','low','System audit tool executables must not have extended ACLs.','"To prevent unauthorized access or manipulation of system audit logs; the tools for manipulating those logs must be protected."','F-31779r2_fix','"As root; change the file permissions. chacl -z <audit_tool_filename>"','HP-UX SMSE',' III - Administrative Sensitive ','GEN002718','C-36440r3_chk','Verify the audit tools file permissions. The list of files should minimally include the following: \naudevent - Change/display event/system call status.\naudfilter - Load/clear/display the audit filtering policy.\nauditdp - Selectively read/write and convert/format the audit data.\naudisp - Display audit records.\naudomon - Audit file monitoring and size parameter setpoints.\naudsys - Start/stop auditing; set/display the audit file or directory information.\nuserdbset - Select user to be audited.\n# ls -lL /usr/sbin/aud" /usr/sbin/userdb"\n\nIf any audit tool file permissions include a \u201c+\u201d, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40493','SV-52482r1_rule','default','medium','The system must display the date and time of the last successful account login upon login by means other than SSH.','Providing users with feedback on when account accesses last occurred facilitates user recognition and reporting of unauthorized account use.','F-45442r1_fix','"For Trusted Mode:Use the SAM/SMH interface to ensure the attributes are added to all user /tcb profiles.For SMSE:Note: There may be additional package/bundle updates that must be installed to support attributes in the /etc/default/security file.Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update attribute. See the below example:DISPLAY_LAST_LOGIN=1Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor.	"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0460','C-47029r1_chk','For Trusted Mode:\nProtected password database files are maintained in the /tcb/files/auth hierarchy. This directory contains other directories each named with a single letter from the alphabet. User profiles are stored in these directories based on the first letter of the user account name. Check the user attributes for the time and source of the last (successful and unsuccessful) login. This information is presented during login. All attributes are generated by the system in an integer format (system time). See the example command and sample output below:\n# egrep \u201cu_unsucchg:#|u_succhg:#|u_unsuclog:#|u_unsuclog:#\u201d /tcb/files/auth/[a-z,A-Z]/"\n:u_succhg#1374687660:\\\n:u_unsucchg#1374687126:\\\n:u_suclog#1374691278:\\\n:u_unsuclog#1374687890:\\\n\nIf any users are missing the above attributes or attribute integer data, this is a finding.\n\nFor SMSE:\nCheck for the following attribute and attribute value:\nDISPLAY_LAST_LOGIN=1\n# grep \u201cDISPLAY_LAST_LOGIN\u201d /etc/default/security /var/adm/userdb/"\n\nIf the DISPLAY_LAST_LOGIN attribute is set to 0, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40478','SV-52466r1_rule','default','medium','The /etc/pam.conf file must have mode 0444 or less permissive.','"The /etc/pam.conf file is the system configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. "','F-45428r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file mode to 0444 or less permissive. chmod 0444 /etc/pam.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0380','C-47021r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file mode.\n# ls -lL /etc/pam.conf\n\nIf the file mode is more permissive than 0444, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40451','SV-52438r1_rule','default','medium','The /var/adm/userdb/USERDB.DISABLED file must be owned by root.','"Unless the userdb is required; the /var/adm/userdb/USERDB.DISABLED file must be created to disable the use of per-user security attributes in the user database. Attributes in the user database override the system-wide settings configured in /etc/default/security. If the system-wide configuration is overridden maliciously; users may gain unauthorized system access. "','F-45400r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file ownership. chown root /var/adm/userdb/USERDB.DISABLED"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0280','C-47011r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nIf the userdb is required, this check is not applicable.\n\nVerify the file is owned by root.\n# ls -lL /var/adm/userdb/USERDB.DISABLED\n\nIf the file is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40450','SV-52437r1_rule','default','medium','The /var/adm/userdb directory must not have an extended ACL.','"The /var/adm/userdb directory is the system user database repository used for storing per-user security configuration information. If the configuration is modified maliciously; individual users may gain unauthorized system access. "','F-45399r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Remove the optional ACL from the file. chacl -z /var/adm/userdb"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0270','C-47010r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the directory has no extended ACL.\n# ls -lL /var/adm/userdb\n\nIf the permissions include a \u201c+\u201d, the directory has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40453','SV-52440r1_rule','default','medium','The /var/adm/userdb/USERDB.DISABLED file must have mode 0444 or less permissive.','"Unless the userdb is required; the /var/adm/userdb/USERDB.DISABLED file must be created to disable the use of per-user security attributes in the user database. Attributes in the user database override the system-wide settings configured in /etc/default/security. If the system-wide configuration is overridden maliciously; users may gain unauthorized system access. "','F-45402r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file mode to 0444 or less permissive. chmod 0444 /var/adm/userdb/USERDB.DISABLED"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0300','C-47013r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nIf the userdb is required, this check is not applicable.\n\nVerify the file mode.\n# ls -lL /var/adm/userdb/USERDB.DISABLED\n\nIf the file mode is more permissive than 0444, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-810','SV-27264r2_rule','default','medium','Default system accounts must be disabled or removed.','Vendor accounts and software may contain backdoors that will allow unauthorized access to the system.  These backdoors are common knowledge and present a threat to system security if the account is not disabled.','F-31746r2_fix','"For Trusted Mode and SMSE:Use the System Administration Manager (SAM) or the System Management Homepage (SMH) to lock/disable or remove any enabled default system accounts."','HP-UX SMSE',' III - Administrative Sensitive ','GEN002640','C-36408r2_chk','Account/password locking is typically accomplished with the asterisk ("). System logins that never had a password use a double exclamation mark (!!) and accounts that have been locked have the valid password entry invalidated by a single exclamation mark (!) prefix.\n\nFor Trusted Mode:\nProtected password database files are maintained in the /tcb/files/auth hierarchy. This directory contains other directories each named with a single letter from the alphabet. User authentication profiles are stored in these directories based on the first letter of the user account name. Next check if default system accounts (such as those for sys, bin, uucp, nuucp, daemon, smtp) have been disabled. \n# grep \u201cu_pwd=\u201c /tcb/files/auth/[a-z,A-Z]/"\n\nIf any default system accounts (such as those for sys, bin, uucp, nuucp, daemon, smtp) have not been disabled, this is a finding.\n\nFor SMSE:\nCheck if default system accounts (such as those for sys, bin, uucp, nuucp, daemon, smtp) have been disabled. \n# cat /etc/shadow\n\nIf any default system accounts (such as those for sys, bin, uucp, nuucp, daemon, smtp) have not been disabled, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40473','SV-52461r1_rule','default','medium','The /etc/pam.conf file must be owned by root.','"/etc/pam.conf file is the system configuration file for the Pluggable Authentication Module (PAM) architecture. It supports per user authentication; account; session; and password management. If the configuration is modified maliciously; users may gain unauthorized system access. "','F-45423r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:As root; change the file ownership. chown root /etc/pam.conf"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0360','C-47019r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file is owned by root.\n# ls -lL /etc/pam.conf\n\nIf the file is not owned by root, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40454','SV-52441r1_rule','default','medium','The /var/adm/userdb/USERDB.DISABLED file must not have an extended ACL.','"Unless the userdb is required; the /var/adm/userdb/USERDB.DISABLED file must be created to disable the use of per-user security attributes in the user database. Attributes in the user database override the system-wide settings configured in /etc/default/security. If the system-wide configuration is overridden maliciously; users may gain unauthorized system access. "','F-45405r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Remove the optional ACL from the file. chacl -z /var/adm/userdb/USERDB.DISABLED"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0310','C-47014r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nIf the userdb is required, this check is not applicable.\n\nVerify the file has no extended ACL.\n# ls -lL /var/adm/userdb/USERDB.DISABLED\n\nIf the permissions include a \u201c+\u201d, the file has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-770','SV-38448r2_rule','default','high','The system must not have accounts configured with blank or null passwords.','"If an account is configured for password authentication but does not have an assigned password; it may be possible to log into the account without authentication. If the root user is configured without a password; the entire system may be compromised. For user accounts not using password authentication; the account must be configured with a password lock value instead of a blank or null value. "','F-31509r2_fix','"For Trusted Mode:Use the System Administration Manager (SAM) or the System Management Homepage (SMH) to disable null passwords and immediately expire the password for any account with a null password; forcing the user to create a password on the very next login. Alternatively; the account may also be disabled.Protected password database files are maintained in the /tcb/files/auth hierarchy. This directory contains other directories each named with a single letter from the alphabet. User authentication profiles are stored in these directories based on the first letter of the user account name. Verify that SAM/SMH has now disabled null passwords for all accounts. grep “:u_nullpw@:” /tcb/files/auth/[a-z;A-Z]For SMSE:Use the SAM/SMH interface (/etc/default/security file) and/or the userdbset command (/var/adm/userdb/* files) to update the attribute(s). See the below example:LOGIN_POLICY_STRICT=1ALLOW_NULL_PASSWORD=0Note: Never use a text editor to modify any /var/adm/userdb database file. The database contains checksums and other binary data; and editors (vi included) do not follow the file locking conventions that are used to control access to the database.If manually editing the /etc/default/security file; save any change(s) before exiting the editor. Use the System Administration Manager (SAM) or the System Management Homepage (SMH) to immediately expire the password for any account with a null password; forcing the user to create a password on the very next login. Alternatively; the account may also be disabled."','HP-UX SMSE',' III - Administrative Sensitive ','GEN000560','C-36252r2_chk','For Trusted Mode:\nVerify that user accounts do not have blank passwords.\n# cd /tcb/files/auth  and  and  grep \u201cu_pwd=::\u201d "/"\n\nIf any user account with a blank password is found, this is a finding.\n\nFor SMSE:\nInspect the password (2nd) field in the /etc/shadow file.\n# cat /etc/shadow\n\nIf any user account in the /etc/shadow file contains a null password field, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','V-40470','SV-52458r1_rule','default','medium','The /etc/security.dsc file must not have an extended ACL.','"The /etc/security.dsc file is the system description file that contains all attributes and default values that are configurable on a per user basis in /var/adm/userdb. If the description file is modified maliciously; users may gain unauthorized system access. "','F-45420r1_fix','"If the system is operating in Trusted Mode; no fix is required.For SMSE:Remove the optional ACL from the file. chacl -z /etc/security.dsc"','HP-UX SMSE',' III - Administrative Sensitive ','GEN000000-HPUX0350','C-47018r1_chk','If the system is configured for Trusted Mode, this check is not applicable.\n\nVerify the file has no extended ACL.\n# ls -lL /etc/security.dsc\n\nIf the permissions include a \u201c+\u201d, the file has an extended ACL, this is a finding.\n','Imported data from UCF - DISA') from dual;
select add_rule_data ('default','','','default','','','','','','HP-UX SMSE',' III - Administrative Sensitive ','GEN000540','C-36255r3_chk','For Trusted Mode:\nCheck the \u201cu_minchg\u201d attribute in the users TS database entry.\nIndividual user:\n# export PATH=$PATH:/usr/lbin\n# getprpw -r -m mintm <USER>\n \nAll users:\n# logins -o -x | awk -F: "{print $1\u201d \u201c$10}"\n\nIf the value is less than 1 for any user, this is a finding.\n\nFor SMSE:\nCheck the PASSWORD_MINDAYS attribute.\n# grep PASSWORD_MINDAYS /etc/default/security /var/adm/userdb/"\n\nIf the attribute PASSWORD_MINDAYS is less than 1, this is a finding.\n','Imported data from UCF - DISA') from dual;
